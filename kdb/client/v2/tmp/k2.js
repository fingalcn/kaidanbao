(function(t){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],t)}else if(typeof exports==="object"&&typeof require==="function"){t(require("jquery"))}else{t(jQuery)}})(function(t){"use strict";var e=function(){return{escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},createNode:function(t){var e=document.createElement("div");e.className=t;e.style.position="absolute";e.style.display="none";return e}}}(),n={ESC:27,TAB:9,RETURN:13,LEFT:37,UP:38,RIGHT:39,DOWN:40};var i=0,a={};function s(e,n){var c=function(){},o=this,l={ajaxSettings:{},autoSelectFirst:false,appendTo:document.body,serviceUrl:null,lookup:null,onSelect:null,width:"auto",minChars:1,maxHeight:"37%",deferRequestBy:0,params:{},formatResult:s.formatResult,delimiter:null,zIndex:9999,type:"GET",noCache:false,onSearchStart:function(){a={};i=0},onSearchComplete:c,onSearchError:c,preserveInput:false,containerClass:"autocomplete-suggestions",tabDisabled:false,dataType:"text",currentRequest:null,triggerSelectOnValidInput:true,preventBadQueries:true,lookupFilter:function(t,e,n,s){if(i>50)return false;if(s&&t.data.type!==s)return false;var c=n.split(" ");for(var o in c){if(c[o]&&t.value.toLowerCase().indexOf(c[o])===-1)return false}if(a["i"+t.data.id])return false;else a["i"+t.data.id]=1;i++;return true},paramName:"query",transformResult:function(e){return typeof e==="string"?t.parseJSON(e):e},showNoSuggestionNotice:true,noSuggestionNotice:"<没有结果>",orientation:"bottom",forceFixPosition:false};o.element=e;o.el=t(e);o.suggestions=[];o.badQueries=[];o.selectedIndex=-1;o.currentValue=o.element.value;o.intervalId=0;o.cachedResponse={};o.onChangeInterval=null;o.onChange=null;o.isLocal=false;o.suggestionsContainer=null;o.noSuggestionsContainer=null;o.options=t.extend({},l,n);o.classes={selected:"autocomplete-selected",suggestion:"autocomplete-suggestion"};o.hint=null;o.hintValue="";o.selection=null;o.initialize();o.setOptions(n)}s.utils=e;t.Autocomplete=s;s.formatResult=function(t,n){var i=n.split(" "),a,s=t.value;for(var c in i){if(i[c]){a="("+e.escapeRegExChars(i[c])+")";s=s.replace(new RegExp(a,"gi"),"<b>$1</b>")}}return s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/&lt;(\/?b)&gt;/g,"<$1>")};s.prototype={killerFn:null,initialize:function(){var e=this,n="."+e.classes.suggestion,i=e.classes.selected,a=e.options,c;e.element.setAttribute("autocomplete","off");e.killerFn=function(n){if(t(n.target).closest("."+e.options.containerClass).length===0){e.killSuggestions();e.disableKillerFn()}};e.noSuggestionsContainer=t('<div class="autocomplete-no-suggestion"></div>').html(this.options.noSuggestionNotice).get(0);e.suggestionsContainer=s.utils.createNode(a.containerClass);c=t(e.suggestionsContainer);c.appendTo(a.appendTo);if(a.width!=="auto"){c.width(a.width)}c.on("mouseover.autocomplete",n,function(){e.activate(t(this).data("index"))});c.on("mouseout.autocomplete",function(){e.selectedIndex=-1;c.children("."+i).removeClass(i)});c.on("click.autocomplete",n,function(){e.select(t(this).data("index"))});e.fixPositionCapture=function(){if(e.visible){e.fixPosition()}};t(window).on("resize.autocomplete",e.fixPositionCapture);e.el.on("keydown.autocomplete",function(t){e.onKeyPress(t)});e.el.on("keyup.autocomplete",function(t){e.onKeyUp(t)});e.el.on("blur.autocomplete",function(){e.onBlur()});e.el.on("focus.autocomplete",function(){e.onFocus()});e.el.on("change.autocomplete",function(t){e.onKeyUp(t)});e.el.on("input.autocomplete",function(t){e.onKeyUp(t)})},onFocus:function(){var t=this;t.fixPosition();if(t.options.minChars===0&&t.el.val().length===0){t.onValueChange()}},onBlur:function(){this.enableKillerFn()},abortAjax:function(){var t=this;if(t.currentRequest){t.currentRequest.abort();t.currentRequest=null}},setOptions:function(e){var n=this,i=n.options;t.extend(i,e);n.isLocal=t.isArray(i.lookup);if(n.isLocal){i.lookup=n.verifySuggestionsFormat(i.lookup)}i.orientation=n.validateOrientation(i.orientation,"bottom");t(n.suggestionsContainer).css({"max-height":i.maxHeight,width:i.width,"z-index":i.zIndex})},clearCache:function(){this.cachedResponse={};this.badQueries=[]},clear:function(){this.clearCache();this.currentValue="";this.suggestions=[]},disable:function(){var t=this;t.disabled=true;clearInterval(t.onChangeInterval);t.abortAjax()},enable:function(){this.disabled=false},fixPosition:function(){var e=this,n=t(e.suggestionsContainer),i=n.parent().get(0);if(i!==document.body&&!e.options.forceFixPosition){return}var a=e.options.orientation,s=n.outerHeight(),c=e.el.outerHeight(),o=e.el.offset(),l={top:o.top,left:o.left};if(a==="auto"){var r=t(window).height(),u=t(window).scrollTop(),d=-u+o.top-s,p=u+r-(o.top+c+s);a=Math.max(d,p)===d?"top":"bottom"}if(a==="top"){l.top+=-s}else{l.top+=c}if(i!==document.body){var f=n.css("opacity"),h;if(!e.visible){n.css("opacity",0).show()}h=n.offsetParent().offset();l.top-=h.top;l.left-=h.left;if(!e.visible){n.css("opacity",f).hide()}}if(e.options.width==="auto"){l.width=e.el.outerWidth()-2+"px"}n.css(l)},enableKillerFn:function(){var e=this;t(document).on("mouseup.autocomplete",e.killerFn)},disableKillerFn:function(){var e=this;t(document).off("mouseup.autocomplete",e.killerFn)},killSuggestions:function(){var t=this;t.stopKillSuggestions();t.intervalId=window.setInterval(function(){if(t.visible){t.el.val(t.currentValue);t.hide()}t.stopKillSuggestions()},50)},stopKillSuggestions:function(){window.clearInterval(this.intervalId)},isCursorAtEnd:function(){var t=this,e=t.el.val().length,n=t.element.selectionStart,i;if(typeof n==="number"){return n===e}if(document.selection){i=document.selection.createRange();i.moveStart("character",-e);return e===i.text.length}return true},onKeyPress:function(t){var e=this;if(!e.disabled&&!e.visible&&t.which===n.DOWN&&e.currentValue){e.suggest();return}if(e.disabled||!e.visible){return}switch(t.which){case n.ESC:e.el.val(e.currentValue);e.hide();break;case n.RIGHT:if(e.hint&&e.options.onHint&&e.isCursorAtEnd()){e.selectHint();break}return;case n.TAB:e.hide();if(e.options.tabDisabled===false){return}break;case n.RETURN:if(e.selectedIndex===-1){e.hide();return}e.select(e.selectedIndex);break;case n.UP:e.moveUp();break;case n.DOWN:e.moveDown();break;default:return}t.stopImmediatePropagation();t.preventDefault()},onKeyUp:function(t){var e=this;if(e.disabled){return}switch(t.which){case n.UP:case n.DOWN:return}clearInterval(e.onChangeInterval);if(e.currentValue!==e.el.val()){e.findBestHint();if(e.options.deferRequestBy>0){e.onChangeInterval=setInterval(function(){e.onValueChange()},e.options.deferRequestBy)}else{e.onValueChange()}}},onValueChange:function(){var e=this,n=e.options,i=e.el.val(),a=e.getQuery(i);if(e.selection&&e.currentValue!==a){e.selection=null;(n.onInvalidateSelection||t.noop).call(e.element)}clearInterval(e.onChangeInterval);e.currentValue=i;e.selectedIndex=-1;if(n.triggerSelectOnValidInput&&e.isExactMatch(a)){e.select(0);return}if(a.length<n.minChars){e.hide()}else{e.getSuggestions(a)}},isExactMatch:function(t){var e=this.suggestions;return e.length===1&&e[0].value.toLowerCase()===t.toLowerCase()},getQuery:function(e){var n=this.options.delimiter,i;if(!n){return e}i=e.split(n);return t.trim(i[i.length-1])},getSuggestionsLocal:function(e){var n=this,i=n.options,a=e.toLowerCase(),s=i.lookupFilter,c=parseInt(i.lookupLimit,10),o;o={suggestions:t.grep(i.lookup,function(t){return s(t,e,a,i.ptype)})};if(c&&o.suggestions.length>c){o.suggestions=o.suggestions.slice(0,c)}return o},getSuggestions:function(e){var n,i=this,a=i.options,s=a.serviceUrl,c,o,l;a.params[a.paramName]=e;c=a.ignoreParams?null:a.params;if(a.onSearchStart.call(i.element,a.params)===false){return}if(t.isFunction(a.lookup)){a.lookup(e,function(t){i.suggestions=t.suggestions;i.suggest();a.onSearchComplete.call(i.element,e,t.suggestions)});return}if(i.isLocal){n=i.getSuggestionsLocal(e)}else{if(t.isFunction(s)){s=s.call(i.element,e)}o=s+"?"+t.param(c||{});n=i.cachedResponse[o]}if(n&&t.isArray(n.suggestions)){i.suggestions=n.suggestions;i.suggest();a.onSearchComplete.call(i.element,e,n.suggestions)}else if(!i.isBadQuery(e)){i.abortAjax();l={url:s,data:c,type:a.type,dataType:a.dataType};t.extend(l,a.ajaxSettings);i.currentRequest=t.ajax(l).done(function(t){var n;i.currentRequest=null;n=a.transformResult(t,e);i.processResponse(n,e,o);a.onSearchComplete.call(i.element,e,n.suggestions)}).fail(function(t,n,s){a.onSearchError.call(i.element,e,t,n,s)})}else{a.onSearchComplete.call(i.element,e,[])}},isBadQuery:function(t){if(!this.options.preventBadQueries){return false}var e=this.badQueries,n=e.length;while(n--){if(t.indexOf(e[n])===0){return true}}return false},hide:function(){var e=this,n=t(e.suggestionsContainer);if(t.isFunction(e.options.onHide)&&e.visible){e.options.onHide.call(e.element,n)}e.visible=false;e.selectedIndex=-1;clearInterval(e.onChangeInterval);t(e.suggestionsContainer).hide();e.signalHint(null)},suggest:function(){if(this.suggestions.length===0){if(this.options.showNoSuggestionNotice){this.noSuggestions()}else{this.hide()}return}var e=this,n=e.options,i=n.groupBy,a=n.formatResult,s=e.getQuery(e.currentValue),c=e.classes.suggestion,o=e.classes.selected,l=t(e.suggestionsContainer),r=t(e.noSuggestionsContainer),u=n.beforeRender,d="",p,f=function(t,e){var n=t.data[i];if(p===n){return""}p=n;return'<div class="autocomplete-group"><strong>'+p+"</strong></div>"};if(n.triggerSelectOnValidInput&&e.isExactMatch(s)){e.select(0);return}t.each(e.suggestions,function(t,e){if(i){d+=f(e,s,t)}d+='<div class="'+c+" "+(e.data.c?e.data.c:"")+'" data-index="'+t+'"><div class="l">'+a(e,s)+'</div><div class="r">'+(e.data.r?e.data.r:"")+"</div></div>"});if(n.newButton)d+=n.newButton;this.adjustContainerWidth();r.detach();l.html(d);if(t.isFunction(u)){u.call(e.element,l)}e.fixPosition();l.show();if(n.autoSelectFirst){e.selectedIndex=0;l.scrollTop(0);l.children("."+c).first().addClass(o)}e.visible=true;e.findBestHint()},noSuggestions:function(){var e=this,n=t(e.suggestionsContainer),i=t(e.noSuggestionsContainer);this.adjustContainerWidth();i.detach();n.empty();n.append(i);if(e.options.newButton)n.append(e.options.newButton);e.fixPosition();n.show();e.visible=true},adjustContainerWidth:function(){var e=this,n=e.options,i,a=t(e.suggestionsContainer);if(n.width==="auto"){i=e.el.outerWidth()-2;a.width(i>0?i:300)}},findBestHint:function(){var e=this,n=e.el.val().toLowerCase(),i=null;if(!n){return}t.each(e.suggestions,function(t,e){var a=e.value.toLowerCase().indexOf(n)===0;if(a){i=e}return!a});e.signalHint(i)},signalHint:function(e){var n="",i=this;if(e){n=i.currentValue+e.value.substr(i.currentValue.length)}if(i.hintValue!==n){i.hintValue=n;i.hint=e;(this.options.onHint||t.noop)(n)}},verifySuggestionsFormat:function(e){if(e.length&&typeof e[0]==="string"){return t.map(e,function(t){return{value:t,data:null}})}return e},validateOrientation:function(e,n){e=t.trim(e||"").toLowerCase();if(t.inArray(e,["auto","bottom","top"])===-1){e=n}return e},processResponse:function(t,e,n){var i=this,a=i.options;t.suggestions=i.verifySuggestionsFormat(t.suggestions);if(!a.noCache){i.cachedResponse[n]=t;if(a.preventBadQueries&&t.suggestions.length===0){i.badQueries.push(e)}}if(e!==i.getQuery(i.currentValue)){return}i.suggestions=t.suggestions;i.suggest()},activate:function(e){var n=this,i,a=n.classes.selected,s=t(n.suggestionsContainer),c=s.find("."+n.classes.suggestion);s.find("."+a).removeClass(a);n.selectedIndex=e;if(n.selectedIndex!==-1&&c.length>n.selectedIndex){i=c.get(n.selectedIndex);t(i).addClass(a);return i}return null},selectHint:function(){var e=this,n=t.inArray(e.hint,e.suggestions);e.select(n)},select:function(t){var e=this;e.hide();e.onSelect(t)},moveUp:function(){var e=this;if(e.selectedIndex===-1){return}if(e.selectedIndex===0){t(e.suggestionsContainer).children().first().removeClass(e.classes.selected);e.selectedIndex=-1;e.el.val(e.currentValue);e.findBestHint();return}e.adjustScroll(e.selectedIndex-1)},moveDown:function(){var t=this;if(t.selectedIndex===t.suggestions.length-1){return}t.adjustScroll(t.selectedIndex+1)},adjustScroll:function(e){var n=this,i=n.activate(e);if(!i){return}var a,s,c,o=t(i).outerHeight();a=i.offsetTop;s=t(n.suggestionsContainer).scrollTop();c=s+n.options.maxHeight-o;if(a<s){t(n.suggestionsContainer).scrollTop(a)}else if(a>c){t(n.suggestionsContainer).scrollTop(a-n.options.maxHeight+o)}if(!n.options.preserveInput){n.el.val(n.getValue(n.suggestions[e].value))}n.signalHint(null)},onSelect:function(e){var n=this,i=n.options.onSelect,a=n.suggestions[e];n.currentValue=n.getValue(a.value);if(n.currentValue!==n.el.val()&&!n.options.preserveInput){n.el.val(n.currentValue)}n.signalHint(null);n.suggestions=[];n.selection=a;if(t.isFunction(i)){i.call(n.element,a)}},getValue:function(t){var e=this,n=e.options.delimiter,i,a;if(!n){return t}i=e.currentValue;a=i.split(n);if(a.length===1){return t}return i.substr(0,i.length-a[a.length-1].length)+t},dispose:function(){var e=this;e.el.off(".autocomplete").removeData("autocomplete");e.disableKillerFn();t(window).off("resize.autocomplete",e.fixPositionCapture);t(e.suggestionsContainer).remove()}};t.fn.autocomplete=t.fn.devbridgeAutocomplete=function(e,n){var i="autocomplete";if(arguments.length===0){return this.first().data(i)}return this.each(function(){var a=t(this),c=a.data(i);if(typeof e==="string"){if(c&&typeof c[e]==="function"){c[e](n)}}else{if(c&&c.dispose){c.dispose()}c=new s(this,e);a.data(i,c)}})}});(function(t){t.facebox=function(e,n){t.facebox.loading(e.settings||[]);if(n)t("#facebox .content").addClass(n);t("#facebox .content").empty().append(e);t("#facebox .popup").children().fadeIn("normal");var i=t(window).width()/2-t("#facebox .popup").outerWidth()/2;t("#facebox").css("left",i>0?i:0)};t.extend(t.facebox,{settings:{opacity:.5,overlay:true,title:"信息",loadingImage:"/facebox/loading.gif",closeImage:"/facebox/closelabel.png",imageTypes:["png","jpg","jpeg","gif"],faceboxHtml:'    <div id="facebox" style="display:none;">       <div class="popup">     \t<div class="title"></div>         <div class="content"></div> \t    <div class="footer"></div>         <span class="close"></span>       </div>     </div>'},loading:function(){e();if(t("#facebox .loading").length==1)return true;s();t("#facebox .content").empty().append('<div class="loading"></div>');t("#facebox").show().css({top:n()[1]+i()/16,left:t(window).width()/2-t("#facebox .popup").outerWidth()/2})},close:function(){t("#facebox").fadeOut(function(){t("#facebox .content").removeClass().addClass("content");t("#facebox .loading").remove();t(document).trigger("afterClose.facebox")});c();t("#facebox .footer").html("");return false}});function e(e){if(t.facebox.settings.inited)return true;else t.facebox.settings.inited=true;if(e)t.extend(t.facebox.settings,e);t("body").append(t.facebox.settings.faceboxHtml);t("#facebox .title").html(t.facebox.settings.title);t("#facebox .close").click(t.facebox.close).append('<svg aria-hidden="true" class="octicon octicon-x" height="29" width="29" role="img" version="1.1" viewBox="0 0 12 16"><path d="M7.48 8l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75-1.48-1.48 3.75-3.75L0.77 4.25l1.48-1.48 3.75 3.75 3.75-3.75 1.48 1.48-3.75 3.75z"></path></svg>')}function n(){var t,e;if(self.pageYOffset){e=self.pageYOffset;t=self.pageXOffset}else if(document.documentElement&&document.documentElement.scrollTop){e=document.documentElement.scrollTop;t=document.documentElement.scrollLeft}else if(document.body){e=document.body.scrollTop;t=document.body.scrollLeft}return new Array(t,e)}function i(){var t;if(self.innerHeight){t=self.innerHeight}else if(document.documentElement&&document.documentElement.clientHeight){t=document.documentElement.clientHeight}else if(document.body){t=document.body.clientHeight}return t}function a(){return t.facebox.settings.overlay==false||t.facebox.settings.opacity===null}function s(){if(a())return;if(t("#facebox_overlay").length==0)t("body").append('<div id="facebox_overlay" class="facebox_hide"></div>');t("#facebox_overlay").addClass("facebox_overlayBG").css("opacity",t.facebox.settings.opacity);return false}function c(){if(a())return;t("#facebox_overlay").remove();return false}})(jQuery);(function(t,e){t.kaidanbao={};window.addEventListener("DOMContentLoaded",function(){e(t.kaidanbao);document.addEventListener("visibilitychange",function(){});window.addEventListener("orientationchange",function(){})})})(window,function(t){t.frame.init();window.addEventListener("hashchange",t.frame.hashchangeHandle);window.applicationCache.ondownloading=function(){if(window.localStorage["k"])t.aspect.noty.progress("更新中。。。")};window.applicationCache.oncached=function(){if(window.localStorage["k"])window.location.href="./"};window.applicationCache.onupdateready=function(){if(window.localStorage["k"])window.location.href="./"};window.addEventListener("storage",function(e){if(t.cache.sign.loaded){window.location.href="/"}})});(function(t){var e=false;t.utils={valid_loginname:function(e){if(/^[0-9a-zA-Z]{2,16}$/.test(e)){return true}else t.aspect.noty.message("用户名由字母和数字组成")},valid_mobile:function(e){if(/^1[3-8][0-9]{9}$/.test(e)){return true}else t.aspect.noty.message("手机号码不对")},valid_password:function(e){if(e.length<5){t.aspect.noty.message("密码太短！")}else return true},valid_hanname:function(e){if(/^[^\s]{2,8}$/.test(e)){return true}else t.aspect.noty.message("名称由2到8个文字组成！")},is_float:function(t){var e=/^(-?\d+)(\.\d+)?$/;if(e.test(t))return true;else false},file:function(){var t={excel:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body>{table}</body></html>'};var e=",";var n="\r\n";var i=function(t,e){return t.replace(new RegExp("{(\\w+)}","g"),function(t,n){return e[n]})};var a=function(t,e){var n=t.type;var i="application/octet-stream";if(n&&n!=i){var a=t.slice||t.webkitSlice||t.mozSlice;t=a.call(t,0,t.size,i)}var s=URL.createObjectURL(t);var c=document.createElementNS("http://www.w3.org/1999/xhtml","a");c.href=s;c.download=e;var o=document.createEvent("MouseEvents");o.initMouseEvent("click",true,false,window,0,0,0,0,0,false,false,false,false,0,null);c.dispatchEvent(o);URL.revokeObjectURL(s)};var s=function(t,e){var n=new FileReader;n.readAsText(t);n.onload=function(){e(this.result)}};return{tableToExcel:function(e,n){var s=i(t.excel,{worksheet:n,table:e});a(new Blob([s],{type:"text/plain;charset=utf-8"}),n+".xls")},excelToTable:function(t,e){if(t){s(t,function(t){e(t.substring(t.indexOf("<table"),t.indexOf("</table")+8))})}else e()}}}(),DX:function(t){var e="";var n="仟佰拾亿仟佰拾万仟佰拾元角分";t+="00";var i=t.indexOf(".");if(i>=0)t=t.substring(0,i)+t.substr(i+1,2);n=n.substr(n.length-t.length);for(var a=0;a<t.length;a++)e+="零壹贰叁肆伍陆柒捌玖".substr(t.substr(a,1),1)+n.substr(a,1);return e.replace(/零角零分$/,"整").replace(/零[仟佰拾]/g,"零").replace(/零{2,}/g,"零").replace(/零([亿|万])/g,"$1").replace(/零+元/,"元").replace(/亿零{0,3}万/,"亿").replace(/^元/,"零元")},date:{picker:function(e,n){n=t.utils.extend(n,{format:"yyyy-mm-dd",weekStart:0,todayBtn:"linked",clearBtn:true,language:"zh-CN",todayHighlight:true,autoclose:true});$(e).datepicker(n)},getDayTimestamp:function(t){return new Date(t.replace(/-/g,"/")).getTime()},getNow:function(){return(new Date).getTime()},getDay:function(e,n){var i=n?new Date(n).getTime():(new Date).getTime();if(e)return t.utils.date.getTimeFormat(i+e*864e5,"d");else return t.utils.date.getTimeFormat(0,"d")},getTimeFormat:function(t,e){var n=t?new Date(t):new Date;var i=n.getFullYear(),a=n.getMonth()+1,s=n.getDate(),c=n.getHours(),o=n.getMinutes(),l=n.getSeconds();if(e==="d"){a=a>9?a:"0"+a;s=s>9?s:"0"+s;return i+"-"+a+"-"+s}else if(e==="t"){c=c>9?c:"0"+c;o=o>9?o:"0"+o;l=l>9?l:"0"+l;return c+":"+o+":"+l}else{a=a>9?a:"0"+a;s=s>9?s:"0"+s;c=c>9?c:"0"+c;o=o>9?o:"0"+o;l=l>9?l:"0"+l;return i+"-"+a+"-"+s+" "+c+":"+o+":"+l}},get_before_yms:function(e){var n=(new Date).getDate();var i=[];i.push(t.utils.date.getDay().substr(0,7));for(var a=0;a<e-1;a++){i.push(t.utils.date.getDay(-1-n-31*a).substr(0,7))}return i}},pinyin:{dict:{},yinbiao:{"ā":"a1","á":"a2","ǎ":"a3","à":"a4","ē":"e1","é":"e2","ě":"e3","è":"e4","ō":"o1","ó":"o2","ǒ":"o3","ò":"o4","ī":"i1","í":"i2","ǐ":"i3","ì":"i4","ū":"u1","ú":"u2","ǔ":"u3","ù":"u4","ü":"v0","ǘ":"v2","ǚ":"v3","ǜ":"v4","ń":"n2","ň":"n3","":"m2"},init:function(){if(e===false){e=true;var n={"èr":"二贰","shí":"十时实蚀","yǐ":"乙已以蚁倚","yī":"一衣医依伊揖壹","chǎng,ān,hàn":"厂","dīng,zhēng":"丁","qī":"七戚欺漆柒凄嘁","bǔ,bo":"卜","rén":"人仁","rù":"入褥","jiǔ":"九久酒玖灸韭","ér":"儿而","bā":"八巴疤叭芭捌笆","jǐ,jī":"几","le,liǎo":"了","lì":"力历厉立励利例栗粒吏枥沥荔俐莉砾雳痢","dāo":"刀","nǎi":"乃奶","sān":"三叁","yòu":"又右幼诱佑","yú":"于余鱼娱渔榆愚隅逾舆","shì":"士示世市式势事侍饰试视柿是适室逝释誓拭恃嗜","gān,gàn":"干","gōng":"工弓公功攻宫恭躬","kuī":"亏盔窥","tǔ":"土","cùn":"寸","dà,dài,tài":"大","cái":"才材财裁","xià":"下夏","zhàng":"丈仗帐胀障杖账","yǔ,yù,yú":"与","shàng,shǎng":"上","wàn,mò":"万","kǒu":"口","xiǎo":"小晓","jīn":"巾斤今金津筋襟","shān":"山删衫珊","qiān":"千迁牵谦签","qǐ":"乞企启起","chuān":"川穿","gè,gě":"个各","sháo":"勺芍","yì":"亿义艺忆议亦异役译易疫益谊意毅翼屹抑邑绎奕逸肄溢","jí":"及吉级极即急疾集籍棘辑嫉","fán":"凡烦矾樊","xī":"夕西吸希析牺息悉惜稀锡溪熄膝昔晰犀熙嬉蟋","wán":"丸完玩顽","me,mó,ma,yāo":"么","guǎng,ān":"广","wáng,wú":"亡","mén":"门们","shī":"尸失师诗狮施湿虱","zhī":"之支汁芝肢脂蜘","jǐ":"己挤脊","zǐ":"子紫姊籽滓","wèi":"卫未位味畏胃喂慰谓猬蔚魏","yě":"也冶野","nǚ,rǔ":"女","rèn":"刃认韧纫","fēi":"飞非啡","xí":"习席袭媳","mǎ":"马码玛","chā,chá,chǎ":"叉","fēng":"丰封疯峰锋蜂枫","xiāng":"乡香箱厢湘镶","jǐng":"井警阱","wáng,wàng":"王","kāi":"开揩","tiān":"天添","wú":"无吴芜梧蜈","fū,fú":"夫","zhuān":"专砖","yuán":"元园原圆援缘源袁猿辕","yún":"云匀耘","zhā,zā,zhá":"扎","mù":"木目牧墓幕暮慕沐募睦穆","wǔ":"五午伍武侮舞捂鹉","tīng":"厅听","bù,fǒu":"不","qū,ōu":"区","quǎn":"犬","tài":"太态泰汰","yǒu":"友","chē,jū":"车","pǐ":"匹","yóu":"尤由邮犹油游","jù":"巨拒具俱剧距惧锯聚炬","yá":"牙芽崖蚜涯衙","bǐ":"比彼笔鄙匕秕","jiē":"皆阶接街秸","hù":"互户护沪","qiè,qiē":"切","wǎ,wà":"瓦","zhǐ":"止旨址纸指趾","tún,zhūn":"屯","shǎo,shào":"少","rì":"日","zhōng,zhòng":"中","gāng":"冈刚纲缸肛","nèi,nà":"内","bèi":"贝备倍辈狈惫焙","shuǐ":"水","jiàn,xiàn":"见","niú":"牛","shǒu":"手守首","máo":"毛矛茅锚","qì":"气弃汽器迄泣","shēng":"升生声牲笙甥","cháng,zhǎng":"长","shén,shí":"什","piàn,piān":"片","pú,pū":"仆","huà,huā":"化","bì":"币必毕闭毙碧蔽弊避壁庇蓖痹璧","chóu,qiú":"仇","zhuǎ,zhǎo":"爪","jǐn,jìn":"仅","réng":"仍","fù,fǔ":"父","cóng,zòng":"从","fǎn":"反返","jiè":"介戒届界借诫","xiōng":"凶兄胸匈汹","fēn,fèn":"分","fá":"乏伐罚阀筏","cāng":"仓苍舱沧","yuè":"月阅悦跃越岳粤","shì,zhī":"氏","wù":"勿务物误悟雾坞晤","qiàn":"欠歉","fēng,fěng":"风","dān":"丹耽","wū":"乌污呜屋巫诬","fèng":"凤奉","gōu,gòu":"勾","wén":"文闻蚊","liù,lù":"六","huǒ":"火伙","fāng":"方芳","dǒu,dòu":"斗","wèi,wéi":"为","dìng":"订定锭","jì":"计记技忌际季剂迹既继寄绩妓荠寂鲫冀","xīn":"心辛欣新薪锌","chǐ,chě":"尺","yǐn":"引饮蚓瘾","chǒu":"丑","kǒng":"孔恐","duì":"队对","bàn":"办半扮伴瓣绊","yǔ,yú":"予","yǔn":"允陨","quàn":"劝","shū":"书叔殊梳舒疏输蔬抒枢淑","shuāng":"双霜","yù":"玉育狱浴预域欲遇御裕愈誉芋郁喻寓豫","huàn":"幻换唤患宦涣焕痪","kān":"刊堪勘","mò":"末沫漠墨默茉陌寞","jī":"击饥圾机肌鸡积基激讥叽唧畸箕","dǎ,dá":"打","qiǎo":"巧","zhèng,zhēng":"正症挣","pū":"扑","bā,pá":"扒","gān":"甘肝竿柑","qù":"去","rēng":"扔","gǔ":"古谷股鼓","běn":"本","jié,jiē":"节结","shù,shú,zhú":"术","bǐng":"丙柄饼秉禀","kě,kè":"可","zuǒ":"左","bù":"布步怖部埠","shí,dàn":"石","lóng":"龙聋隆咙胧窿","yà":"轧亚讶","miè":"灭蔑","píng":"平评凭瓶萍坪","dōng":"东冬","kǎ,qiǎ":"卡","běi,bèi":"北","yè":"业页夜液谒腋","jiù":"旧救就舅臼疚","shuài":"帅蟀","guī":"归规闺硅瑰","zhàn,zhān":"占","dàn":"旦但诞淡蛋氮","qiě,jū":"且","yè,xié":"叶","jiǎ":"甲钾","dīng":"叮盯","shēn":"申伸身深呻绅","hào,háo":"号","diàn":"电店垫殿玷淀惦奠","tián":"田甜恬","shǐ":"史使始驶矢屎","zhī,zhǐ":"只","yāng":"央殃秧鸯","diāo":"叼雕刁碉","jiào":"叫轿较窖酵","lìng":"另","dāo,tāo":"叨","sì":"四寺饲肆","tàn":"叹炭探碳","qiū":"丘秋蚯","hé":"禾河荷盒","fù":"付负妇附咐赴复傅富腹覆赋缚","dài":"代带贷怠袋逮戴","xiān":"仙先掀锨","yí":"仪宜姨移遗夷胰","bái":"白","zǎi,zǐ,zī":"仔","chì":"斥赤翅","tā":"他它塌","guā":"瓜刮","hū":"乎呼忽","cóng":"丛","lìng,líng,lǐng":"令","yòng":"用","shuǎi":"甩","yìn":"印","lè,yuè":"乐","jù,gōu":"句","cōng":"匆葱聪囱","fàn":"犯饭泛范贩","cè":"册厕测策","wài":"外","chù,chǔ":"处","niǎo":"鸟","bāo":"包胞苞褒","zhǔ":"主煮嘱拄","shǎn":"闪陕","lán":"兰拦栏蓝篮澜","tóu,tou":"头","huì":"汇绘贿惠慧讳诲晦秽","hàn":"汉旱捍悍焊撼翰憾","tǎo":"讨","xué":"穴学","xiě":"写","níng,nìng,zhù":"宁","ràng":"让","lǐ":"礼李里理鲤","xùn":"训讯迅汛驯逊殉","yǒng":"永咏泳勇蛹踊","mín":"民","chū":"出初","ní":"尼","sī":"司丝私斯撕嘶","liáo":"辽疗僚聊寥嘹缭","jiā":"加佳嘉枷","nú":"奴","zhào,shào":"召","biān":"边编鞭蝙","pí":"皮疲脾啤","yùn":"孕运韵酝蕴","fā,fà":"发","shèng":"圣胜剩","tái,tāi":"台苔","jiū":"纠究揪鸠","mǔ":"母亩牡拇姆","káng,gāng":"扛","xíng":"刑形型邢","dòng":"动冻栋洞","kǎo":"考烤拷","kòu":"扣寇","tuō":"托拖脱","lǎo":"老","gǒng":"巩汞拱","zhí":"执直侄值职植","kuò":"扩阔廓","yáng":"扬阳杨洋","dì,de":"地","sǎo,sào":"扫","chǎng,cháng":"场","ěr":"耳尔饵","máng":"芒忙盲茫","xiǔ":"朽","pǔ,pò,pō,piáo":"朴","quán":"权全泉拳痊","guò,guo,guō":"过","chén":"臣尘辰沉陈晨忱","zài":"再在","xié":"协胁斜携鞋谐","yā,yà":"压","yàn":"厌艳宴验雁焰砚唁谚堰","yǒu,yòu":"有","cún":"存","bǎi":"百摆","kuā,kuà":"夸","jiàng":"匠酱","duó":"夺踱","huī":"灰挥恢辉徽","dá":"达","sǐ":"死","liè":"列劣烈猎","guǐ":"轨鬼诡","xié,yá,yé,yú,xú":"邪","jiá,jiā,gā,xiá":"夹","chéng":"成呈诚承城程惩橙","mài":"迈麦卖","huà,huá":"划","zhì":"至志帜制质治致秩智置挚掷窒滞稚","cǐ":"此","zhēn":"贞针侦珍真斟榛","jiān":"尖奸歼坚肩艰兼煎","guāng":"光","dāng,dàng":"当","zǎo":"早枣澡蚤藻","tù,tǔ":"吐","xià,hè":"吓","chóng":"虫崇","tuán":"团","tóng,tòng":"同","qū,qǔ":"曲","diào":"吊钓掉","yīn":"因阴音姻茵","chī":"吃嗤痴","ma,má,mǎ":"吗","yǔ":"屿宇羽","fān":"帆翻","huí":"回茴蛔","qǐ,kǎi":"岂","zé":"则责","suì":"岁碎穗祟遂隧","ròu":"肉","zhū,shú":"朱","wǎng":"网往枉","nián":"年","diū":"丢","shé":"舌","zhú":"竹逐烛","qiáo":"乔侨桥瞧荞憔","wěi":"伟伪苇纬萎","chuán,zhuàn":"传","pāng":"乓","pīng":"乒","xiū,xǔ":"休","fú":"伏扶俘浮符幅福凫芙袱辐蝠","yōu":"优忧悠幽","yán":"延严言岩炎沿盐颜阎蜒檐","jiàn":"件建荐贱剑健舰践鉴键箭涧","rèn,rén":"任","huá,huà,huā":"华","jià,jiè,jie":"价","shāng":"伤商","fèn,bīn":"份","fǎng":"仿访纺","yǎng,áng":"仰","zì":"自字","xiě,xuè":"血","xiàng":"向项象像橡","sì,shì":"似","hòu":"后厚候","zhōu":"舟州周洲","háng,xíng":"行","huì,kuài":"会","shā":"杀纱杉砂","hé,gě":"合","zhào":"兆赵照罩","zhòng":"众仲","yé":"爷","sǎn":"伞","chuàng,chuāng":"创","duǒ":"朵躲","wēi":"危威微偎薇巍","xún":"旬寻巡询循","zá":"杂砸","míng":"名明鸣铭螟","duō":"多哆","zhēng":"争征睁筝蒸怔狰","sè":"色涩瑟","zhuàng":"壮状撞","chōng,chòng":"冲","bīng":"冰兵","zhuāng":"庄装妆桩","qìng":"庆","liú":"刘留流榴琉硫瘤","qí,jì,zī,zhāi":"齐","cì":"次赐","jiāo":"交郊浇娇骄胶椒焦蕉礁","chǎn":"产铲阐","wàng":"妄忘旺望","chōng":"充","wèn":"问","chuǎng":"闯","yáng,xiáng":"羊","bìng,bīng":"并","dēng":"灯登蹬","mǐ":"米","guān":"关官棺","hàn,hán":"汗","jué":"决绝掘诀爵","jiāng":"江姜僵缰","tāng,shāng":"汤","chí":"池驰迟持弛","xīng,xìng":"兴","zhái":"宅","ān":"安氨庵鞍","jiǎng":"讲奖桨蒋","jūn":"军均君钧","xǔ,hǔ":"许","fěng":"讽","lùn,lún":"论","nóng":"农浓脓","shè":"设社舍涉赦","nà,nǎ,nèi,nā":"那","jìn,jǐn":"尽","dǎo":"导岛蹈捣祷","sūn,xùn":"孙","zhèn":"朕圳阵振震镇","shōu":"收","fáng":"防妨房肪","rú":"如儒蠕","mā":"妈","xì,hū":"戏","hǎo,hào":"好","tā,jiě":"她","guān,guàn":"观冠","huān":"欢","hóng,gōng":"红","mǎi":"买","xiān,qiàn":"纤","jì,jǐ":"纪济","yuē,yāo":"约","shòu":"寿受授售兽瘦","nòng,lòng":"弄","jìn":"进近晋浸","wéi":"违围唯维桅","yuǎn,yuàn":"远","tūn":"吞","tán":"坛谈痰昙谭潭檀","fǔ":"抚斧府俯辅腐甫脯","huài,pēi,pī,péi":"坏","rǎo":"扰","pī":"批披坯霹","zhǎo":"找沼","chě":"扯","zǒu":"走","chāo":"抄钞超","bà":"坝爸霸","gòng":"贡","zhé,shé,zhē":"折","qiǎng,qiāng,chēng":"抢","zhuā":"抓","xiào":"孝笑效哮啸","pāo":"抛","tóu":"投","kàng":"抗炕","fén":"坟焚","kēng":"坑","dǒu":"抖陡蚪","ké,qiào":"壳","fāng,fáng":"坊","niǔ":"扭纽钮","kuài":"块快筷","bǎ,bà":"把","bào":"报抱爆豹","jié":"劫杰洁捷截竭","què":"却确鹊","huā":"花","fēn":"芬吩纷氛","qín":"芹琴禽勤秦擒","láo":"劳牢","lú":"芦炉卢庐颅","gān,gǎn":"杆","kè":"克刻客课","sū,sù":"苏","dù":"杜渡妒镀","gàng,gāng":"杠","cūn":"村","qiú":"求球囚","xìng":"杏幸性姓","gèng,gēng":"更","liǎng":"两","lì,lí":"丽","shù":"束述树竖恕庶墅漱","dòu":"豆逗痘","hái,huán":"还","fǒu,pǐ":"否","lái":"来莱","lián":"连怜帘莲联廉镰","xiàn,xuán":"县","zhù,chú":"助","dāi":"呆","kuàng":"旷况矿框眶","ya,yā":"呀","zú":"足族","dūn":"吨蹲墩","kùn":"困","nán":"男","chǎo,chāo":"吵","yuán,yún,yùn":"员","chuàn":"串","chuī":"吹炊","ba,bā":"吧","hǒu":"吼","gǎng":"岗","bié,biè":"别","dīng,dìng":"钉","gào":"告","wǒ":"我","luàn":"乱","tū":"秃突凸","xiù":"秀袖绣锈嗅","gū,gù":"估","měi":"每美","hé,hē,hè":"何","tǐ,tī,bèn":"体","bó,bǎi,bà":"伯","zuò":"作坐座做","líng":"伶灵铃陵零龄玲凌菱蛉翎","dī":"低堤滴","yòng,yōng":"佣","nǐ":"你拟","zhù":"住注驻柱祝铸贮蛀","zào":"皂灶造燥躁噪","fó,fú,bì,bó":"佛","chè":"彻撤澈","tuǒ":"妥椭","lín":"邻林临琳磷鳞","hán":"含寒函涵韩","chà":"岔衩","cháng":"肠尝常偿","dù,dǔ":"肚","guī,jūn,qiū":"龟","miǎn":"免勉娩冕缅","jiǎo,jué":"角","kuáng":"狂","tiáo,tiāo":"条","luǎn":"卵","yíng":"迎盈营蝇赢荧莹萤","xì,jì":"系","chuáng":"床","kù":"库裤酷","yìng,yīng":"应","lěng":"冷","zhè,zhèi":"这","xù":"序叙绪续絮蓄旭恤酗婿","xián":"闲贤弦咸衔嫌涎舷","jiān,jiàn":"间监","pàn":"判盼叛畔","mēn,mèn":"闷","wāng":"汪","dì,tì,tuí":"弟","shā,shà":"沙","shà,shā":"煞","càn":"灿璨","wò":"沃卧握","méi,mò":"没","gōu":"沟钩","shěn,chén":"沈","huái":"怀槐徊淮","sòng":"宋送诵颂讼","hóng":"弘泓宏虹洪鸿","qióng":"穷琼","zāi":"灾栽","liáng":"良梁粮粱","zhèng":"证郑政","bǔ":"补捕哺","sù":"诉肃素速塑粟溯","shí,zhì":"识","cí":"词辞慈磁祠瓷雌","zhěn":"诊枕疹","niào,suī":"尿","céng":"层","jú":"局菊橘","wěi,yǐ":"尾","zhāng":"张章彰樟","gǎi":"改","lù":"陆录鹿路赂","ē,ā":"阿","zǔ":"阻组祖诅","miào":"妙庙","yāo":"妖腰邀夭吆","nǔ":"努","jìn,jìng":"劲","rěn":"忍","qū":"驱屈岖蛆躯","chún":"纯唇醇","nà":"纳钠捺","bó":"驳脖博搏膊舶渤","zòng,zǒng":"纵","wén,wèn":"纹","lǘ":"驴","huán":"环","qīng":"青轻倾清蜻氢卿","xiàn":"现限线宪陷馅羡献腺","biǎo":"表","mǒ,mò,mā":"抹","lǒng":"拢垄","dān,dàn,dǎn":"担","bá":"拔跋","jiǎn":"拣茧俭捡检减剪简柬碱","tǎn":"坦毯袒","chōu":"抽","yā":"押鸦鸭","guǎi":"拐","pāi":"拍","zhě":"者","dǐng":"顶鼎","yōng":"拥庸","chāi,cā":"拆","dǐ":"抵","jū,gōu":"拘","lā":"垃","lā,lá":"拉","bàn,pàn":"拌","zhāo":"招昭","pō":"坡泼颇","bō":"拨波玻菠播","zé,zhái":"择","tái":"抬","qí,jī":"其奇","qǔ":"取娶","kǔ":"苦","mào":"茂贸帽貌","ruò,rě":"若","miáo":"苗描瞄","píng,pēng":"苹","yīng":"英樱鹰莺婴缨鹦","qié":"茄","jīng":"茎京经惊晶睛精荆兢鲸","zhī,qí":"枝","bēi":"杯悲碑卑","guì,jǔ":"柜","bǎn":"板版","sōng":"松","qiāng":"枪腔","gòu":"构购够垢","sàng,sāng":"丧","huà":"画话桦","huò":"或货获祸惑霍","cì,cī":"刺","yǔ,yù":"雨语","bēn,bèn":"奔","fèn":"奋粪愤忿","hōng":"轰烘","qī,qì":"妻","ōu":"欧殴鸥","qǐng":"顷请","zhuǎn,zhuàn,zhuǎi":"转","zhǎn":"斩盏展","ruǎn":"软","lún":"轮仑伦沦","dào":"到盗悼道稻","chǐ":"齿耻侈","kěn":"肯垦恳啃","hǔ":"虎","xiē,suò":"些","lǔ":"虏鲁卤","shèn":"肾渗慎","shàng":"尚","guǒ":"果裹","kūn":"昆坤","guó":"国","chāng":"昌猖","chàng":"畅唱","diǎn":"典点碘","gù":"固故顾雇","áng":"昂","zhōng":"忠终钟盅衷","ne,ní":"呢","àn":"岸按案暗","tiě,tiē,tiè,":"帖","luó":"罗萝锣箩骡螺逻","kǎi":"凯慨","lǐng,líng":"岭","bài":"败拜","tú":"图徒途涂屠","chuí":"垂锤捶","zhī,zhì":"知织","guāi":"乖","gǎn":"秆赶敢感橄","hé,hè,huó,huò,hú":"和","gòng,gōng":"供共","wěi,wēi":"委","cè,zè,zhāi":"侧","pèi":"佩配沛","pò,pǎi":"迫","de,dì,dí":"的","pá":"爬","suǒ":"所索锁琐","jìng":"径竞竟敬静境镜靖","mìng":"命","cǎi,cài":"采","niàn":"念","tān":"贪摊滩瘫","rǔ":"乳辱","pín":"贫","fū":"肤麸孵敷","fèi":"肺废沸费吠","zhǒng":"肿","péng":"朋棚蓬膨硼鹏澎篷","fú,fù":"服","féi":"肥","hūn":"昏婚荤","tù":"兔","hú":"狐胡壶湖蝴弧葫","gǒu":"狗苟","bǎo":"饱宝保","xiǎng":"享响想","biàn":"变遍辨辩辫","dǐ,de":"底","jìng,chēng":"净","fàng":"放","nào":"闹","zhá":"闸铡","juàn,juǎn":"卷","quàn,xuàn":"券","dān,shàn,chán":"单","chǎo":"炒","qiǎn,jiān":"浅","fǎ":"法","xiè,yì":"泄","lèi":"泪类","zhān":"沾粘毡瞻","pō,bó":"泊","pào,pāo":"泡","xiè":"泻卸屑械谢懈蟹","ní,nì":"泥","zé,shì":"泽","pà":"怕帕","guài":"怪","zōng":"宗棕踪","shěn":"审婶","zhòu":"宙昼皱骤咒","kōng,kòng,kǒng":"空","láng,làng":"郎","chèn":"衬趁","gāi":"该","xiáng,yáng":"详","lì,dài":"隶","jū":"居鞠驹","shuā,shuà":"刷","mèng":"孟梦","gū":"孤姑辜咕沽菇箍","jiàng,xiáng":"降","mèi":"妹昧媚","jiě":"姐","jià":"驾架嫁稼","cān,shēn,cēn,sān":"参","liàn":"练炼恋链","xì":"细隙","shào":"绍哨","tuó":"驼驮鸵","guàn":"贯惯灌罐","zòu":"奏揍","chūn":"春椿","bāng":"帮邦梆","dú,dài":"毒","guà":"挂卦褂","kuǎ":"垮","kuà,kū":"挎","náo":"挠","dǎng,dàng":"挡","shuān":"拴栓","tǐng":"挺艇","kuò,guā":"括","shí,shè":"拾","tiāo,tiǎo":"挑","wā":"挖蛙洼","pīn":"拼","shèn,shén":"甚","mǒu":"某","nuó":"挪","gé":"革阁格隔","xiàng,hàng":"巷","cǎo":"草","chá":"茶察茬","dàng":"荡档","huāng":"荒慌","róng":"荣绒容熔融茸蓉溶榕","nán,nā":"南","biāo":"标彪膘","yào":"药耀","kū":"枯哭窟","xiāng,xiàng":"相","chá,zhā":"查","liǔ":"柳","bǎi,bó,bò":"柏","yào,yāo":"要","wāi":"歪","yán,yàn":"研","lí":"厘狸离犁梨璃黎漓篱","qì,qiè":"砌","miàn":"面","kǎn":"砍坎","shuǎ":"耍","nài":"耐奈","cán":"残蚕惭","zhàn":"战站栈绽蘸","bèi,bēi":"背","lǎn":"览懒揽缆榄","shěng,xǐng":"省","xiāo,xuē":"削","zhǎ":"眨","hǒng,hōng,hòng":"哄","xiǎn":"显险","mào,mò":"冒","yǎ,yā":"哑","yìng":"映硬","zuó":"昨","xīng":"星腥猩","pā":"趴","guì":"贵桂跪刽","sī,sāi":"思","xiā":"虾瞎","mǎ,mā,mà":"蚂","suī":"虽","pǐn":"品","mà":"骂","huá,huā":"哗","yè,yàn,yān":"咽","zán,zǎ":"咱","hā,hǎ,hà":"哈","yǎo":"咬舀","nǎ,něi,na,né":"哪","hāi,ké":"咳","xiá":"峡狭霞匣侠暇辖","gǔ,gū":"骨","gāng,gàng":"钢","tiē":"贴","yào,yuè":"钥","kàn,kān":"看","jǔ":"矩举","zěn":"怎","xuǎn":"选癣","zhòng,zhǒng,chóng":"种","miǎo":"秒渺藐","kē":"科棵颗磕蝌",
"biàn,pián":"便","zhòng,chóng":"重","liǎ":"俩","duàn":"段断缎锻","cù":"促醋簇","shùn":"顺瞬","xiū":"修羞","sú":"俗","qīn":"侵钦","xìn,shēn":"信","huáng":"皇黄煌凰惶蝗蟥","zhuī,duī":"追","jùn":"俊峻骏竣","dài,dāi":"待","xū":"须虚需","hěn":"很狠","dùn":"盾顿钝","lǜ":"律虑滤氯","pén":"盆","shí,sì,yì":"食","dǎn":"胆","táo":"逃桃陶萄淘","pàng":"胖","mài,mò":"脉","dú":"独牍","jiǎo":"狡饺绞脚搅","yuàn":"怨院愿","ráo":"饶","wān":"弯湾豌","āi":"哀哎埃","jiāng,jiàng":"将浆","tíng":"亭庭停蜓廷","liàng":"亮谅辆晾","dù,duó":"度","chuāng":"疮窗","qīn,qìng":"亲","zī":"姿资滋咨","dì":"帝递第蒂缔","chà,chā,chāi,cī":"差","yǎng":"养氧痒","qián":"前钱钳潜黔","mí":"迷谜靡","nì":"逆昵匿腻","zhà,zhá":"炸","zǒng":"总","làn":"烂滥","pào,páo,bāo":"炮","tì":"剃惕替屉涕","sǎ,xǐ":"洒","zhuó":"浊啄灼茁卓酌","xǐ,xiǎn":"洗","qià":"洽恰","pài":"派湃","huó":"活","rǎn":"染","héng":"恒衡","hún":"浑魂","nǎo":"恼脑","jué,jiào":"觉","hèn":"恨","xuān":"宣轩喧","qiè":"窃怯","biǎn,piān":"扁","ǎo":"袄","shén":"神","shuō,shuì,yuè":"说","tuì":"退蜕","chú":"除厨锄雏橱","méi":"眉梅煤霉玫枚媒楣","hái":"孩","wá":"娃","lǎo,mǔ":"姥","nù":"怒","hè":"贺赫褐鹤","róu":"柔揉蹂","bǎng":"绑膀","lěi":"垒蕾儡","rào":"绕","gěi,jǐ":"给","luò":"骆洛","luò,lào":"络","tǒng":"统桶筒捅","gēng":"耕羹","hào":"耗浩","bān":"班般斑搬扳颁","zhū":"珠株诸猪蛛","lāo":"捞","fěi":"匪诽","zǎi,zài":"载","mái,mán":"埋","shāo,shào":"捎稍","zhuō":"捉桌拙","niē":"捏","kǔn":"捆","dū,dōu":"都","sǔn":"损笋","juān":"捐鹃","zhé":"哲辙","rè":"热","wǎn":"挽晚碗惋婉","ái,āi":"挨","mò,mù":"莫","è,wù,ě,wū":"恶","tóng":"桐铜童彤瞳","xiào,jiào":"校","hé,hú":"核","yàng":"样漾","gēn":"根跟","gē":"哥鸽割歌戈","chǔ":"础储楚","pò":"破魄","tào":"套","chái":"柴豺","dǎng":"党","mián":"眠绵棉","shài":"晒","jǐn":"紧锦谨","yūn,yùn":"晕","huàng,huǎng":"晃","shǎng":"晌赏","ēn":"恩","ài,āi":"唉","ā,á,ǎ,à,a":"啊","bà,ba,pí":"罢","zéi":"贼","tiě":"铁","zuàn,zuān":"钻","qiān,yán":"铅","quē":"缺","tè":"特","chéng,shèng":"乘","dí":"迪敌笛涤嘀嫡","zū":"租","chèng":"秤","mì,bì":"秘泌","chēng,chèn,chèng":"称","tòu":"透","zhài":"债寨","dào,dǎo":"倒","tǎng,cháng":"倘","chàng,chāng":"倡","juàn":"倦绢眷","chòu,xiù":"臭","shè,yè,yì":"射","xú":"徐","háng":"航杭","ná":"拿","wēng":"翁嗡","diē":"爹跌","ài":"爱碍艾隘","gē,gé":"胳搁","cuì":"脆翠悴粹","zàng":"脏葬","láng":"狼廊琅榔","féng":"逢","è":"饿扼遏愕噩鳄","shuāi,cuī":"衰","gāo":"高糕羔篙","zhǔn":"准","bìng":"病","téng":"疼腾誊藤","liáng,liàng":"凉量","táng":"唐堂塘膛糖棠搪","pōu":"剖","chù,xù":"畜","páng,bàng":"旁磅","lǚ":"旅屡吕侣铝缕履","fěn":"粉","liào":"料镣","shāo":"烧","yān":"烟淹","tāo":"涛掏滔","lào":"涝酪","zhè":"浙蔗","xiāo":"消宵销萧硝箫嚣","hǎi":"海","zhǎng,zhàng":"涨","làng":"浪","rùn":"润闰","tàng":"烫","yǒng,chōng":"涌","huǐ":"悔毁","qiāo,qiǎo":"悄","hài":"害亥骇","jiā,jia,jie":"家","kuān":"宽","bīn":"宾滨彬缤濒","zhǎi":"窄","lǎng":"朗","dú,dòu":"读","zǎi":"宰","shàn,shān":"扇","shān,shàn":"苫","wà":"袜","xiáng":"祥翔","shuí":"谁","páo":"袍咆","bèi,pī":"被","tiáo,diào,zhōu":"调","yuān":"冤鸳渊","bō,bāo":"剥","ruò":"弱","péi":"陪培赔","niáng":"娘","tōng":"通","néng,nài":"能","nán,nàn,nuó":"难","sāng":"桑","pěng":"捧","dǔ":"堵赌睹","yǎn":"掩眼演衍","duī":"堆","pái,pǎi":"排","tuī":"推","jiào,jiāo":"教","lüè":"掠略","jù,jū":"据","kòng":"控","zhù,zhuó,zhe":"著","jūn,jùn":"菌","lè,lēi":"勒","méng":"萌盟檬朦","cài":"菜","tī":"梯踢剔","shāo,sào":"梢","fù,pì":"副","piào,piāo":"票","shuǎng":"爽","shèng,chéng":"盛","què,qiāo,qiǎo":"雀","xuě":"雪","chí,shi":"匙","xuán":"悬玄漩","mī,mí":"眯","la,lā":"啦","shé,yí":"蛇","lèi,léi,lěi":"累","zhǎn,chán":"崭","quān,juàn,juān":"圈","yín":"银吟淫","bèn":"笨","lóng,lǒng":"笼","mǐn":"敏皿闽悯","nín":"您","ǒu":"偶藕","tōu":"偷","piān":"偏篇翩","dé,děi,de":"得","jiǎ,jià":"假","pán":"盘","chuán":"船","cǎi":"彩睬踩","lǐng":"领","liǎn":"脸敛","māo,máo":"猫","měng":"猛锰","cāi":"猜","háo":"毫豪壕嚎","má":"麻","guǎn":"莞馆管","còu":"凑","hén":"痕","kāng":"康糠慷","xuán,xuàn":"旋","zhe,zhuó,zháo,zhāo":"着","lǜ,shuài":"率","gài,gě,hé":"盖","cū":"粗","lín,lìn":"淋","qú,jù":"渠","jiàn,jiān":"渐溅","hùn,hún":"混","pó":"婆","qíng":"情晴擎","cǎn":"惨","sù,xiǔ,xiù":"宿","yáo":"窑谣摇遥肴姚","móu":"谋","mì":"密蜜觅","huǎng":"谎恍幌","tán,dàn":"弹","suí":"随","yǐn,yìn":"隐","jǐng,gěng":"颈","shéng":"绳","qí":"骑棋旗歧祈脐畦崎鳍","chóu":"绸酬筹稠愁畴","lǜ,lù":"绿","dā":"搭","kuǎn":"款","tǎ":"塔","qū,cù":"趋","tí,dī,dǐ":"提","jiē,qì":"揭","xǐ":"喜徙","sōu":"搜艘","chā":"插","lǒu,lōu":"搂","qī,jī":"期","rě":"惹","sàn,sǎn":"散","dǒng":"董懂","gě,gé":"葛","pú":"葡菩蒲","zhāo,cháo":"朝","luò,là,lào":"落","kuí":"葵魁","bàng":"棒傍谤","yǐ,yī":"椅","sēn":"森","gùn,hùn":"棍","bī":"逼","zhí,shi":"殖","xià,shà":"厦","liè,liě":"裂","xióng":"雄熊","zàn":"暂赞","yǎ":"雅","chǎng":"敞","zhǎng":"掌","shǔ":"暑鼠薯黍蜀署曙","zuì":"最罪醉","hǎn":"喊罕","jǐng,yǐng":"景","lǎ":"喇","pēn,pèn":"喷","pǎo,páo":"跑","chuǎn":"喘","hē,hè,yè":"喝","hóu":"喉猴","pù,pū":"铺","hēi":"黑","guō":"锅郭","ruì":"锐瑞","duǎn":"短","é":"鹅额讹俄","děng":"等","kuāng":"匡筐","shuì":"税睡","zhù,zhú":"筑","shāi":"筛","dá,dā":"答","ào":"傲澳懊","pái":"牌徘","bǎo,bǔ,pù":"堡","ào,yù":"奥","fān,pān":"番","là,xī":"腊","huá":"猾滑","rán":"然燃","chán":"馋缠蝉","mán":"蛮馒","tòng":"痛","shàn":"善擅膳赡","zūn":"尊遵","pǔ":"普谱圃浦","gǎng,jiǎng":"港","céng,zēng":"曾","wēn":"温瘟","kě":"渴","zhā":"渣","duò":"惰舵跺","gài":"溉概丐钙","kuì":"愧","yú,tōu":"愉","wō":"窝蜗","cuàn":"窜篡","qún":"裙群","qiáng,qiǎng,jiàng":"强","shǔ,zhǔ":"属","zhōu,yù":"粥","sǎo":"嫂","huǎn":"缓","piàn":"骗","mō":"摸","shè,niè":"摄","tián,zhèn":"填","gǎo":"搞稿镐","suàn":"蒜算","méng,mēng,měng":"蒙","jìn,jīn":"禁","lóu":"楼娄","lài":"赖癞","lù,liù":"碌","pèng":"碰","léi":"雷","báo":"雹","dū":"督","nuǎn":"暖","xiē":"歇楔蝎","kuà":"跨胯","tiào,táo":"跳","é,yǐ":"蛾","sǎng":"嗓","qiǎn":"遣谴","cuò":"错挫措锉","ǎi":"矮蔼","shǎ":"傻","cuī":"催摧崔","tuǐ":"腿","chù":"触矗","jiě,jiè,xiè":"解","shù,shǔ,shuò":"数","mǎn":"满","liū,liù":"溜","gǔn":"滚","sāi,sài,sè":"塞","pì,bì":"辟","dié":"叠蝶谍碟","fèng,féng":"缝","qiáng":"墙","piě,piē":"撇","zhāi":"摘斋","shuāi":"摔","mó,mú":"模","bǎng,bàng":"榜","zhà":"榨乍诈","niàng":"酿","zāo":"遭糟","suān":"酸","shang,cháng":"裳","sòu":"嗽","là":"蜡辣","qiāo":"锹敲跷","zhuàn":"赚撰","wěn":"稳吻紊","bí":"鼻荸","mó":"膜魔馍摹蘑","xiān,xiǎn":"鲜","yí,nǐ":"疑","gāo,gào":"膏","zhē":"遮","duān":"端","màn":"漫慢曼幔","piāo,piào,piǎo":"漂","lòu":"漏陋","sài":"赛","nèn":"嫩","dèng":"凳邓瞪","suō,sù":"缩","qù,cù":"趣","sā,sǎ":"撒","tàng,tāng":"趟","chēng":"撑","zēng":"增憎","cáo":"槽曹","héng,hèng":"横","piāo":"飘","mán,mén":"瞒","tí":"题蹄啼","yǐng":"影颖","bào,pù":"暴","tà":"踏蹋","kào":"靠铐","pì":"僻屁譬","tǎng":"躺","dé":"德","mó,mā":"摩","shú":"熟秫赎","hú,hū,hù":"糊","pī,pǐ":"劈","cháo":"潮巢","cāo":"操糙","yàn,yān":"燕","diān":"颠掂","báo,bó,bò":"薄","cān":"餐","xǐng":"醒","zhěng":"整拯","zuǐ":"嘴","zèng":"赠","mó,mò":"磨","níng":"凝狞柠","jiǎo,zhuó":"缴","cā":"擦","cáng,zàng":"藏","fán,pó":"繁","bì,bei":"臂","bèng":"蹦泵","pān":"攀潘","chàn,zhàn":"颤","jiāng,qiáng":"疆","rǎng":"壤攘","jiáo,jué,jiào":"嚼","rǎng,rāng":"嚷","chǔn":"蠢","lù,lòu":"露","náng,nāng":"囊","dǎi":"歹","rǒng":"冗","hāng,bèn":"夯","āo,wā":"凹","féng,píng":"冯","yū":"迂淤","xū,yù":"吁","lèi,lē":"肋","kōu":"抠","lūn,lún":"抡","jiè,gài":"芥","xīn,xìn":"芯","chā,chà":"杈","xiāo,xiào":"肖","zhī,zī":"吱","ǒu,ōu,òu":"呕","nà,nè":"呐","qiàng,qiāng":"呛","tún,dùn":"囤","kēng,háng":"吭","shǔn":"吮","diàn,tián":"佃","sì,cì":"伺","zhǒu":"肘帚","diàn,tián,shèng":"甸","páo,bào":"刨","lìn":"吝赁躏","duì,ruì,yuè":"兑","zhuì":"坠缀赘","kē,kě":"坷","tuò,tà,zhí":"拓","fú,bì":"拂","nǐng,níng,nìng":"拧","ào,ǎo,niù":"拗","kē,hē":"苛","yān,yǎn":"奄","hē,a,kē":"呵","gā,kā":"咖","biǎn":"贬匾","jiǎo,yáo":"侥","chà,shā":"刹","āng":"肮","wèng":"瓮","nüè,yào":"疟","páng":"庞螃","máng,méng":"氓","gē,yì":"疙","jǔ,jù":"沮","zú,cù":"卒","nìng":"泞","chǒng":"宠","wǎn,yuān":"宛","mí,mǐ":"弥","qì,qiè,xiè":"契","xié,jiā":"挟","duò,duǒ":"垛","jiá":"荚颊","zhà,shān,shi,cè":"栅","bó,bèi":"勃","zhóu,zhòu":"轴","nüè":"虐","liē,liě,lié,lie":"咧","dǔn":"盹","xūn":"勋","yo,yō":"哟","mī":"咪","qiào,xiào":"俏","hóu,hòu":"侯","pēi":"胚","tāi":"胎","luán":"峦","sà":"飒萨","shuò":"烁","xuàn":"炫","píng,bǐng":"屏","nà,nuó":"娜","pá,bà":"耙","gěng":"埂耿梗","niè":"聂镊孽","mǎng":"莽","qī,xī":"栖","jiǎ,gǔ":"贾","chěng":"逞","pēng":"砰烹","láo,lào":"唠","bàng,bèng":"蚌","gōng,zhōng":"蚣","li,lǐ,lī":"哩","suō":"唆梭嗦","hēng":"哼","zāng":"赃","qiào":"峭窍撬","mǎo":"铆","ǎn":"俺","sǒng":"耸","juè,jué":"倔","yīn,yān,yǐn":"殷","guàng":"逛","něi":"馁","wō,guō":"涡","lào,luò":"烙","nuò":"诺懦糯","zhūn":"谆","niǎn,niē":"捻","qiā":"掐","yè,yē":"掖","chān,xiān,càn,shǎn":"掺","dǎn,shàn":"掸","fēi,fěi":"菲","qián,gān":"乾","shē":"奢赊","shuò,shí":"硕","luō,luó,luo":"啰","shá":"啥","hǔ,xià":"唬","tuò":"唾","bēng":"崩","dāng,chēng":"铛","xiǎn,xǐ":"铣","jiǎo,jiáo":"矫","tiáo":"笤","kuǐ,guī":"傀","xìn":"衅","dōu":"兜","jì,zhài":"祭","xiáo":"淆","tǎng,chǎng":"淌","chún,zhūn":"淳","shuàn":"涮","dāng":"裆","wèi,yù":"尉","duò,huī":"堕","chuò,chāo":"绰","bēng,běng,bèng":"绷","zōng,zèng":"综","zhuó,zuó":"琢","chuǎi,chuài,chuāi,tuán,zhuī":"揣","péng,bāng":"彭","chān":"搀","cuō":"搓","sāo":"搔","yē":"椰","zhuī,chuí":"椎","léng,lēng,líng":"棱","hān":"酣憨","sū":"酥","záo":"凿","qiào,qiáo":"翘","zhā,chā":"喳","bǒ":"跛","há,gé":"蛤","qiàn,kàn":"嵌","bāi":"掰","yān,ā":"腌","wàn":"腕","dūn,duì":"敦","kuì,huì":"溃","jiǒng":"窘","sāo,sǎo":"骚","pìn":"聘","bǎ":"靶","xuē":"靴薛","hāo":"蒿","léng":"楞","kǎi,jiē":"楷","pín,bīn":"频","zhuī":"锥","tuí":"颓","sāi":"腮","liú,liù":"馏","nì,niào":"溺","qǐn":"寝","luǒ":"裸","miù":"谬","jiǎo,chāo":"剿","áo,āo":"熬","niān":"蔫","màn,wàn":"蔓","chá,chā":"碴","xūn,xùn":"熏","tiǎn":"舔","sēng":"僧","da,dá":"瘩","guǎ":"寡","tuì,tùn":"褪","niǎn":"撵碾","liáo,liāo":"撩","cuō,zuǒ":"撮","ruǐ":"蕊","cháo,zhāo":"嘲","biē":"憋鳖","hēi,mò":"嘿","zhuàng,chuáng":"幢","jī,qǐ":"稽","lǒu":"篓","lǐn":"凛檩","biě,biē":"瘪","liáo,lào,lǎo":"潦","chéng,dèng":"澄","lèi,léi":"擂","piáo":"瓢","shà":"霎","mò,má":"蟆","qué":"瘸","liáo,liǎo":"燎","liào,liǎo":"瞭","sào,sāo":"臊","mí,méi":"糜","ái":"癌","tún":"臀","huò,huō,huá":"豁","pù,bào":"瀑","chuō":"戳","zǎn,cuán":"攒","cèng":"蹭","bò,bǒ":"簸","bó,bù":"簿","bìn":"鬓","suǐ":"髓","ráng":"瓤"};var i,a,s=0;for(var a in n){i=n[a];for(s=0;s<i.length;s++){t.utils.pinyin.dict[i[s]]=a}}}},getSZM:function(e){t.utils.pinyin.init();var n="",i,a,s;for(var c=0;c<e.length;c++){if(e[c].match(/^\w+$/i)){n+=e[c]}else if(i=t.utils.pinyin.dict[e[c]]){a=t.utils.pinyin.yinbiao[i[0]];n+=a?a[0]:i[0]}else{n+="?"}}return n}},extend:function(t,e,n){t=t||{};if(e){for(var i in e){if(n||!t[i]){t[i]=e[i]}}}return t}}})(window.kaidanbao);(function(t){var e=function(){var t=function(t,e){return t<<e|t>>>32-e};var e=function(t,e){var n,i,a,s,c;a=t&2147483648;s=e&2147483648;n=t&1073741824;i=e&1073741824;c=(t&1073741823)+(e&1073741823);if(n&i)return c^2147483648^a^s;if(n|i){if(c&1073741824)return c^3221225472^a^s;else return c^1073741824^a^s}else{return c^a^s}};var n=function(t,e,n){return t&e|~t&n};var i=function(t,e,n){return t&n|e&~n};var a=function(t,e,n){return t^e^n};var s=function(t,e,n){return e^(t|~n)};var c=function(i,a,s,c,o,l,r){i=e(i,e(e(n(a,s,c),o),r));return e(t(i,l),a)};var o=function(n,a,s,c,o,l,r){n=e(n,e(e(i(a,s,c),o),r));return e(t(n,l),a)};var l=function(n,i,s,c,o,l,r){n=e(n,e(e(a(i,s,c),o),r));return e(t(n,l),i)};var r=function(n,i,a,c,o,l,r){n=e(n,e(e(s(i,a,c),o),r));return e(t(n,l),i)};var u=function(t){var e;var n=t.length;var i=n+8;var a=(i-i%64)/64;var s=(a+1)*16;var c=Array(s-1);var o=0;var l=0;while(l<n){e=(l-l%4)/4;o=l%4*8;c[e]=c[e]|t.charCodeAt(l)<<o;l++}e=(l-l%4)/4;o=l%4*8;c[e]=c[e]|128<<o;c[s-2]=n<<3;c[s-1]=n>>>29;return c};var d=function(t){var e="",n="",i,a;for(a=0;a<=3;a++){i=t>>>a*8&255;n="0"+i.toString(16);e=e+n.substr(n.length-2,2)}return e};var p=function(t){t=t.replace(/\x0d\x0a/g,"\n");var e="";for(var n=0;n<t.length;n++){var i=t.charCodeAt(n);if(i<128){e+=String.fromCharCode(i)}else if(i>127&&i<2048){e+=String.fromCharCode(i>>6|192);e+=String.fromCharCode(i&63|128)}else{e+=String.fromCharCode(i>>12|224);e+=String.fromCharCode(i>>6&63|128);e+=String.fromCharCode(i&63|128)}}return e};return function(t){var n=Array();var i,a,s,f,h,g,m,b,v;var y=7,x=12,_=17,$=22;var k=5,w=9,z=14,q=20;var j=4,C=11,S=16,F=23;var I=6,T=10,O=15,E=21;t=p(t);n=u(t);g=1732584193;m=4023233417;b=2562383102;v=271733878;for(i=0;i<n.length;i+=16){a=g;s=m;f=b;h=v;g=c(g,m,b,v,n[i+0],y,3614090360);v=c(v,g,m,b,n[i+1],x,3905402710);b=c(b,v,g,m,n[i+2],_,606105819);m=c(m,b,v,g,n[i+3],$,3250441966);g=c(g,m,b,v,n[i+4],y,4118548399);v=c(v,g,m,b,n[i+5],x,1200080426);b=c(b,v,g,m,n[i+6],_,2821735955);m=c(m,b,v,g,n[i+7],$,4249261313);g=c(g,m,b,v,n[i+8],y,1770035416);v=c(v,g,m,b,n[i+9],x,2336552879);b=c(b,v,g,m,n[i+10],_,4294925233);m=c(m,b,v,g,n[i+11],$,2304563134);g=c(g,m,b,v,n[i+12],y,1804603682);v=c(v,g,m,b,n[i+13],x,4254626195);b=c(b,v,g,m,n[i+14],_,2792965006);m=c(m,b,v,g,n[i+15],$,1236535329);g=o(g,m,b,v,n[i+1],k,4129170786);v=o(v,g,m,b,n[i+6],w,3225465664);b=o(b,v,g,m,n[i+11],z,643717713);m=o(m,b,v,g,n[i+0],q,3921069994);g=o(g,m,b,v,n[i+5],k,3593408605);v=o(v,g,m,b,n[i+10],w,38016083);b=o(b,v,g,m,n[i+15],z,3634488961);m=o(m,b,v,g,n[i+4],q,3889429448);g=o(g,m,b,v,n[i+9],k,568446438);v=o(v,g,m,b,n[i+14],w,3275163606);b=o(b,v,g,m,n[i+3],z,4107603335);m=o(m,b,v,g,n[i+8],q,1163531501);g=o(g,m,b,v,n[i+13],k,2850285829);v=o(v,g,m,b,n[i+2],w,4243563512);b=o(b,v,g,m,n[i+7],z,1735328473);m=o(m,b,v,g,n[i+12],q,2368359562);g=l(g,m,b,v,n[i+5],j,4294588738);v=l(v,g,m,b,n[i+8],C,2272392833);b=l(b,v,g,m,n[i+11],S,1839030562);m=l(m,b,v,g,n[i+14],F,4259657740);g=l(g,m,b,v,n[i+1],j,2763975236);v=l(v,g,m,b,n[i+4],C,1272893353);b=l(b,v,g,m,n[i+7],S,4139469664);m=l(m,b,v,g,n[i+10],F,3200236656);g=l(g,m,b,v,n[i+13],j,681279174);v=l(v,g,m,b,n[i+0],C,3936430074);b=l(b,v,g,m,n[i+3],S,3572445317);m=l(m,b,v,g,n[i+6],F,76029189);g=l(g,m,b,v,n[i+9],j,3654602809);v=l(v,g,m,b,n[i+12],C,3873151461);b=l(b,v,g,m,n[i+15],S,530742520);m=l(m,b,v,g,n[i+2],F,3299628645);g=r(g,m,b,v,n[i+0],I,4096336452);v=r(v,g,m,b,n[i+7],T,1126891415);b=r(b,v,g,m,n[i+14],O,2878612391);m=r(m,b,v,g,n[i+5],E,4237533241);g=r(g,m,b,v,n[i+12],I,1700485571);v=r(v,g,m,b,n[i+3],T,2399980690);b=r(b,v,g,m,n[i+10],O,4293915773);m=r(m,b,v,g,n[i+1],E,2240044497);g=r(g,m,b,v,n[i+8],I,1873313359);v=r(v,g,m,b,n[i+15],T,4264355552);b=r(b,v,g,m,n[i+6],O,2734768916);m=r(m,b,v,g,n[i+13],E,1309151649);g=r(g,m,b,v,n[i+4],I,4149444226);v=r(v,g,m,b,n[i+11],T,3174756917);b=r(b,v,g,m,n[i+2],O,718787259);m=r(m,b,v,g,n[i+9],E,3951481745);g=e(g,a);m=e(m,s);b=e(b,f);v=e(v,h)}var R=d(g)+d(m)+d(b)+d(v);return R.toLowerCase()}}();t.safe={local_pwd:function(t){return e(e(t)+t)},up_pwd:function(t,n){return e(t+n)}}})(window.kaidanbao);(function(t){t.conf={appName:"kaidanbao"};t.conf.shuzi_quan=["〇","①","②","③","④","⑤","⑥","⑦","⑧","⑨","⑩"];t.conf.shuzi_roma=["〇","Ⅰ","Ⅱ","Ⅲ","Ⅳ","Ⅴ","Ⅵ","Ⅶ","Ⅷ","Ⅸ","Ⅹ"]})(window.kaidanbao);(function(t){var e=t.utils;var n={},i,a={setup:[],clerk:[],customer:[],supplier:[],account:[],product:[]},s={customer:{},product:"",supplier:{},clerk:{},account:{},repository:{}},c={customer:[],supplier:[],account:[],product:[],clerk:[]},o={},l={},r={},u={m_t:[],m_t_map:{},mt:[],mt_map:{},mi:[(new Date).getMonth()],mts:[],mts_max:2548944e6},d={};t.cache={fixed:n,name_cache:s,dynamic:o,fixed_page:c,sign:r,dates:u,sys:d,local:function(t){if(t){i=t;localStorage.setItem("k",JSON.stringify(t))}else{if(localStorage["k"]){if(t==="")localStorage.removeItem("k");if(!i)i=JSON.parse(localStorage["k"])}return i||{}}},setup:function(t){return n["i"+l[t]]||""},get:function(t){return n["i"+t]||""},put:function(t,i){if(t.tp==="f"){if(i)e.extend(n["i"+t._id],t,true);else n["i"+t._id]=t;if(s[t.tn]&&t.name)s[t.tn][t.name]=t._id;if(a[t.tn])a[t.tn].unshift(t._id);if(c[t.tn])c[t.tn].unshift(t._id)}if(i)i()},fixed_by_table:a,init:function(e){u.m_t=t.utils.date.get_before_yms(15);for(var i in u.m_t){i=parseInt(i);u.mt.push(u.m_t[i].substr(2).replace("-",""));u.m_t_map[u.m_t[i]]=i;u.mt_map[u.mt[i]]=i;if(u.mi[i]==0)u.mi[i+1]=11;else u.mi[i+1]=u.mi[i]-1;u.mts.push(new Date(u.m_t[i].replace("-","/")+"/1").getTime())}r.month_length=Math.ceil(((new Date).getTime()-r.user.ct)/26298e5);t.dao.queryAllFixed(function(i,o){if(o){n["i"+o._id]=o;if(a[o.tn])a[o.tn].push(o._id);if(c[o.tn])c[o.tn].push(o._id);if(s[o.tn]&&o.name)s[o.tn][o.name]=o._id}else{var r,u;for(u in a["setup"]){r=n["i"+a["setup"][u]];l[r.type]=r._id}if(!l.roll){t.dao.addOne(t.conf.preinsert.roll,function(t,e){l.roll=e._id})}if(!l.classify){t.dao.addOne(t.conf.preinsert.classify,function(t,e){l.classify=e._id})}if(!l.setting){t.dao.addOne(t.conf.preinsert.setting,function(t,e){l.setting=e._id})}if(a.account.length==0){t.dao.addOne(t.conf.preinsert.xianjin)}e()}})}}})(window.kaidanbao);(function(t){var e=t.utils;var n,i;var a=function(t,e,a,s){var c=s?i:n;c.doTransaction(t,function(t){t.get(e).onsuccess=function(t){if(a){a(t.target.result)}}})};var s=function(t,e,a){var s=a?i:n;s.doTransaction(t,function(t){t.count().onsuccess=function(t){if(e){e(t.target.result)}}})};var c=function(t,e,a,s){var c=s?i:n;c.doTransaction(t,function(t){t["delete"](e).onsuccess=function(t){if(a)a(t.target.result)}})};var o=function(t,e,a,s){var c=s?i:n;c.doTransaction(t,function(t){t.add(e).onsuccess=function(t){if(a){a(t.target.result)}}})};var l=function(t,e,a,s){var c=s?i:n;c.doTransaction(t,function(t){t.put(e).onsuccess=function(t){if(a){a(t.target.result)}}})};var r=function(t,a,s,c,r){var u=r?i:n;u.doTransaction(t,function(n){n.get(a._id).onsuccess=function(n){var i=n.target.result;if(i){e.extend(i,a,true);l(t,i,function(){if(s){s(i)}},r)}else if(c){o(t,a,function(){if(s){s(a)}},r)}else{if(s){s()}}}})};if(t.cache.sign.need_create_db){indexedDB.deleteDatabase(t.conf.db.name+t.cache.sign.user_id)}var u=function(e){var a=indexedDB.open(t.conf.db.name+t.cache.sign.user_id,1);a.onupgradeneeded=function(t){n=t.target.result;n.createObjectStore("fixed_table",{keyPath:"_id"}).createIndex("lm","lm");n.createObjectStore("salebill",{keyPath:"_id"}).createIndex("ct","ct");n.createObjectStore("bringbill",{keyPath:"_id"}).createIndex("ct","ct");n.createObjectStore("checkbill",{keyPath:"_id"}).createIndex("ct","ct");n.createObjectStore("productbill",{keyPath:"_id"}).createIndex("ct","ct");n.createObjectStore("moneyflow",{keyPath:"_id"}).createIndex("ct","ct");n.createObjectStore("manuals",{keyPath:"_id"}).createIndex("ct","ct");n.createObjectStore("log",{keyPath:"_id"}).createIndex("ct","ct");n.createObjectStore("sys",{keyPath:"id"})};a.onsuccess=function(a){n=a.target.result;n.doTransaction=function(t,e){var i=n.transaction(t,"readwrite");i.onerror=function(){};e(i.objectStore(t))};var s=indexedDB.open(t.conf.db.name+"upd"+t.cache.sign.user_id,1);s.onupgradeneeded=function(t){i=t.target.result;i.createObjectStore("upd",{keyPath:"_id"})};s.onsuccess=function(t){i=t.target.result;i.doTransaction=function(t,e){var n=i.transaction(t,"readwrite");n.onerror=function(){};e(n.objectStore(t))};e()}}};var d=0,p=true;var f=function(e,n){var i=[],a;d+=e;for(a=0;a<e;a++){i.push(t.cache.sign.box_id*1e6+ ++t.cache.sys.index_id)}if(p){d+=7;p=false}if(d>7){l("sys",{id:"index_id",value:t.cache.sys.index_id+d},function(){d=0;n(i)})}else{n(i)}};t.dao={get:a,add:o,put:l,upd:r,count:s,delupddb:function(t){c("upd",t,null,1)},clearupddb:function(){i.doTransaction("upd",function(t){t.clear()})},addOne:function(n,i,a){t.cache.dynamic[n.tn]=null;n.ui=t.cache.sign.user_id;n.si=t.cache.sign.staff_id;n.ct=e.date.getNow();n.lm=n.ct;n.tp=t.conf.table[n.tn]._tp;f(1,function(e){n._id=e[0];if(a===1){t.cache.put(n);if(i)i(false,n)}else if(a===2){o(n.tp==="f"?"fixed_table":n.tn,n,function(e){if(e)t.cache.put(n);if(i){i(!e,n)}})}else if(a===3){o(n.tp==="f"?"fixed_table":n.tn,n,function(e){if(e){o("upd",n,function(a){if(a)t.cache.put(n);else c(n.tp==="f"?"fixed_table":n.tn,e);if(i)i(!a,n)},1)}else if(i)i(true,n)})}else{o(n.tp==="f"?"fixed_table":n.tn,n,function(e){if(e){t.cache.put(n);o("upd",n,null,1);t.net.api("/user/addOne",n,function(t){if(t){}else{c("upd",e,null,1)}})}if(i){i(!e,n)}})}})},updOne:function(n,i,a){if(n.tn)t.cache.dynamic[n.tn]=null;n.lm=e.date.getNow();n.tp=t.conf.table[n.tn]._tp;var s=n.tp==="f"?"fixed_table":n.tn;if(a===1){t.cache.put(n,function(t){if(i)i(false,t)})}else if(a===2){r(s,n,function(e){if(e)t.cache.put(e);if(i){i(!e,e)}})}else if(a===3){r(s,n,function(e){if(e){t.cache.put(e);r("upd",n,function(t){if(i)i(!t,e)},true,1)}else if(i){i(true,e)}})}else{r(s,n,function(e){if(e){t.cache.put(e);r("upd",n,function(n){t.net.api("/user/updOne",n,function(t){if(t){}else{c("upd",n._id,null,1)}});if(i){i(!n,e)}},true,1)}else if(i){i(true,e)}})}},queryAllFixed:function(t){n.doTransaction("fixed_table",function(e){var n;e.index("lm").openCursor(null,"prev").onsuccess=function(e){n=e.target.result;if(n){t(null,n.value);n["continue"]()}else{t(true,null)}}})},queryDynamicByMonth:function(e,i,a,s){var c=t.cache.dynamic[e];if(c&&c[i]){a(true)}else{t.cache.dynamic[e]={};var o=t.cache.dates.m_t_map[i],l=[];var r=t.cache.dates.mts[o],u=t.cache.dates.mts_max;if(o>0)u=t.cache.dates.mts[o-1];var d=IDBKeyRange.bound(r,u,true,false);n.doTransaction(e,function(n){n.index("ct").openCursor(d,s||"prev").onsuccess=function(n){var s=n.target.result;if(s){l.push(s.value);a(null,s.value);s["continue"]()}else{t.cache.dynamic[e][i]=l;a(true)}}})}},queryAll:function(t,e,a){var s=a?i:n;s.doTransaction(t,function(t){var n;t.openCursor().onsuccess=function(t){n=t.target.result;if(n){e(null,n.value);n["continue"]()}else{e(true,null)}}})},del:function(e,n,i){t.dao.updOne({_id:n,tn:e,st:"d"},i)},init:function(t){u(function(){t()})}}})(window.kaidanbao);(function(t){var e=t.utils;var n=function(e){var n=[];t.dao.queryAll("upd",function(i,a){if(i){if(n.length>0){t.net.api("/user/upl",n,function(n,i){if(n){}else{if(i.obj.all){t.dao.clearupddb()}else{for(var a in i.obj.ids){t.dao.delupddb(i.obj.ids[a])}}}if(e)e(n,i)})}else if(e)e(true)}else{n.push(a)}},1)};var i=function(e,n,i,a){t.net.api("/user/down",{ui:t.cache.sign.user_id,tp:e,before:i,after:n},function(n,i){if(n){a(n,null)}else{for(var s in i.obj){t.dao.put(e==="f"?"fixed_table":i.obj[s].tn,i.obj[s])}a(null,i)}})};t.syn={upl:n,down:i,init:function(a){if(t.cache.sign.need_create_db){if(t.cache.sign.user)t.dao.put("sys",{id:"user",value:t.cache.sign.user});t.cache.sys.index_id=0;t.cache.sys.syn_fixed_last_time=0;t.cache.sys.syn_dynamic_last_time=0;var s=e.date.getNow();i("f",0,0,function(n,c){if(n){}else{t.cache.sys.syn_fixed_last_time=s;t.dao.put("sys",{id:"syn_fixed_last_time",value:s});s=e.date.getNow();i("d",t.cache.dates.mts[2],0,function(e,n){if(e){}else{t.cache.sys.syn_dynamic_last_time=s;t.dao.put("sys",{id:"syn_dynamic_last_time",value:s});a()}})}})}else{t.dao.queryAll("sys",function(s,c){if(c){t.cache.sys[c.id]=c.value}else{if(t.cache.sign.user){t.dao.put("sys",{id:"user",value:t.cache.sign.user})}else t.cache.sign.user=t.cache.sys.user;t.cache.sys.index_id=t.cache.sys.index_id||0;t.cache.sys.syn_fixed_last_time=t.cache.sys.syn_fixed_last_time||0;t.cache.sys.syn_dynamic_last_time=t.cache.sys.syn_dynamic_last_time||0;if(t.cache.sign.session){n(function(){var n=e.date.getNow();i("f",t.cache.sys.syn_fixed_last_time,0,function(s,c){if(s){}else{t.cache.sys.syn_fixed_last_time=n;t.dao.put("sys",{id:"syn_fixed_last_time",value:n})}n=e.date.getNow();i("d",t.cache.sys.syn_dynamic_last_time,0,function(e,i){if(e){}else{t.cache.sys.syn_dynamic_last_time=n;t.dao.put("sys",{id:"syn_dynamic_last_time",value:n})}a()})})})}else a()}})}},sse:function(){var n=new EventSource("/event/sse?"+t.cache.sign.session.usb);n.onmessage=function(t){console.log("<li>"+t.data+"</li> - "+e.date.getTimeFormat(0,"dt"))};n.onerror=function(){console.log("sse err , close"+e.date.getTimeFormat(0,"dt"));n.close()}}}})(window.kaidanbao);(function(t){var e=t.utils;var n;t.aspect={noty:{message:function(t){if(n)clearTimeout(n);$(".noty.message").remove();$("body").append('<div class="noty message">'+t+"</div>");n=setTimeout(function(){$(".noty.message").remove()},2e3)},confirm:function(t,e,n,i,a){$("body").append(' \t\t\t\t\t\t<div id="confirm-mask"><progress style="width:100%;height:3%;"></progress></div> \t\t\t\t\t\t<div class="noty confirm"> \t\t\t\t\t\t  <div>'+(t||"请确认！")+'<br /><br /> \t\t\t\t\t\t\t  <button class="ensure">确定</button> \t\t\t\t\t\t\t  <button class="cancel" style="color:#f08;margin-left:5px;">取消</button> \t\t\t\t\t\t  </div> \t\t\t\t\t\t</div>');$("div.noty.confirm>div").css("width",a||"450px");var s;if(i){var c=i*25;$("#confirm-mask progress").attr("max",c).attr("value",c);s=setInterval(function(){$("#confirm-mask progress").attr("value",--c);if(c<1){clearInterval(s);$("div.noty.confirm button.cancel").click()}},40)}else $("#confirm-mask progress").remove();$("div.noty.confirm button.ensure").click(e);$("div.noty.confirm button.cancel").click(function(){if(s)clearInterval(s);$("div.noty.confirm").remove();$("#confirm-mask").remove()});if(n){$("div.noty.confirm button.cancel").attr("hidden","hidden")}},confirm_close:function(){$("div.noty.confirm button.cancel").click()},progress:function(t){$("body").append('<div class="noty progress">'+(t||"正在处理，请稍候...")+"<br /><br /><progress></progress></div>")},close_progress:function(){$("div.noty.progress").remove()}},pay:function(e,n){var i=(e.title||"微信扫码支付")+" - ￥"+(e.price||288);t.aspect.noty.confirm("<h1>"+i+'</h1><br /> \t\t\t\t\t<img src="/image/vx.jpg" style="width:301px;"><br /> \t\t\t\t\t<input placeholder="序列号 XXXX-XXXX-XXXX" spellcheck="false" class="cdkey" style="width:320px;" />',function(){var i=$("div.noty.confirm input.cdkey").val().trim();if(!/^[A-Z]{4}-[A-Z]{4}-[A-Z]{4}$/.test(i)){t.aspect.noty.message("序列号不对，请检查！");return}e.param.cdkey=i;t.aspect.noty.progress("操作中。。。");t.net.api(e.url,e.param,function(e,i){t.aspect.noty.close_progress();if(e)t.aspect.noty.message("操作失败！");else n(i)},e.no_session)},false,300)}}})(window.kaidanbao);(function(t){var e="#/sign/nothing",n="#/sign/login",i={"#/sign/login":1,"#/sign/register":1,"#/sign/forget":1,"#/sign/loading":1},a={"#/sign":"login"};t.frame={current_plugin:"",init:function(){if(!document.getElementById("print")){$("body").append('<div id="print"><div class="print"></div></div>')}if(!document.getElementById("export")){$("body").append('<div id="export"></div><input type="file" id="importfile" hidden accept="application/vnd.ms-excel" onchange="kaidanbao.plugin.store.import_check(this.files[0])">')}if(!document.getElementById("layout")){$("body").append('<div hidden id="layout"><div class="lay-main"></div></div>')}$("#layout").append('<div class="lay-top"><ul></ul></div>');if($("#layout  div.lay-main").length===0){$("#layout").append('<div class="lay-main"></div>')}var e=t.conf.frame;var n=e["p"],s,c,o,l,r,u,d;for(o=0;o<n.length;o++){if(n[o]["sol"].length===0)continue;u=n[o]["en"];d=n[o]["cn"];a["#/"+u]=n[o]["sol"][0]["plug"][0]["en"];$("#layout").append('<div hidden class="lay-left '+u+'"></div>');$("#layout div.lay-top ul").append('<li class="'+u+'"><a href="#/'+u+'">'+d+"</a></li>");s=n[o]["sol"];for(l=0;l<s.length;l++){$("#layout div."+u).append("<h2>"+s[l]["cn"]+'</h2><ul class="'+s[l]["en"]+'"></ul>');c=s[l]["plug"];for(r=0;r<c.length;r++){$("#layout div."+u+" ul."+s[l]["en"]).append('<li class="'+c[r]["en"]+'"><a href="#/'+u+"/"+c[r]["en"]+'">'+c[r]["cn"]+"</a></li>");i["#/"+u+"/"+c[r]["en"]]=1}}}t.frame.hashchangeHandle()},hashchangeHandle:function(){var s,c;var o=window.location.hash;if(e===o)return;if(o==="#/sign/loading"&&e!=="#/sign/login"){location.href="./";return}if(o){if(a[o]){location.replace(o+"/"+a[o]);return}if(i[o]){s=o.split("/");c=e.split("/");a["#/"+s[1]]=s[2];if(s[1]!=="sign"&&c[1]==="sign"&&c[2]!=="loading"){location.href="./";return}t.frame.current_plugin=s[2];t.plugin._change(c,s);t.frame._change(c,s);e=o}else{location.href="./"}}else{location.replace(n)}},_change:function(t,e){if(e[1]==="sign"&&t[1]==="sign"){if(e[2]==="loading"){$("#sign .sign-main").attr("hidden","hidden");$("#sign .sign-loading").removeAttr("hidden")}else{$("#sign .sign-input-wrapper,#sign .sign-button-wrapper,#sign .sign-a-wrapper div").attr("hidden","hidden");$("#sign .sign-input-password,#sign .sign-input-loginname").removeAttr("hidden");$("#sign .sign-a-wrapper div").css("float","left");if(e[2]==="login"){$("#sign .sign-button-login,#sign .sign-a-wrapper div.register,#sign .sign-a-wrapper div.forget").removeAttr("hidden");$("#sign .sign-a-wrapper div.forget").css("float","right")}else if(e[2]==="register"){$("#sign .sign-input-inc,#sign .sign-button-register,#sign .sign-a-wrapper div.login,#sign .sign-a-wrapper div.forget").removeAttr("hidden");$("#sign .sign-a-wrapper div.forget").css("float","right")}else if(e[2]==="forget"){$("#sign .sign-input-captcha,#sign .sign-button-forget,#sign .sign-a-wrapper div.login,#sign .sign-a-wrapper div.register").removeAttr("hidden");$("#sign .sign-a-wrapper div.register").css("float","right")}}}else{if(t[1]==="sign"){$("#sign").attr("hidden","hidden");$("#layout").removeAttr("hidden");$("#layout div."+e[1]).removeAttr("hidden");$("#layout div."+e[1]+" li."+e[2]).addClass("selected");$("#layout div.lay-top li."+e[1]).addClass("selected");$("#layout div.lay-main div."+e[2]).removeAttr("hidden")}else{if(t[1]===e[1]){$("#layout div."+t[1]+" li."+t[2]).removeClass("selected")}else{$("#layout div."+t[1]).attr("hidden","hidden");$("#layout div."+e[1]).removeAttr("hidden");$("#layout div.lay-top li."+t[1]).removeClass("selected");$("#layout div.lay-top li."+e[1]).addClass("selected")}$("#layout div."+e[1]+" li."+e[2]).addClass("selected");$("#layout div.lay-main div."+t[2]).attr("hidden","hidden");$("#layout div.lay-main div."+e[2]).removeAttr("hidden")}}}}})(window.kaidanbao);(function(t){t.plugin={_initedCache:{},_change:function(e,n){var i=e[2];if(t.plugin[i]&&t.plugin[i].release)t.plugin[i].release();var a=n[2];if(t.plugin._initedCache[a]){t.plugin._initedCache[a]+=1;if(t.plugin[a]&&t.plugin[a].reload)t.plugin[a].reload()}else{t.plugin._initedCache[a]=1;if(t.plugin[a]&&t.plugin[a].init)t.plugin[a].init()}}}})(window.kaidanbao);(function(t){var e=t.utils;var n=function(t,n,i){e.extend(t,{url:"/default/path",method:"POST",timeout:3e4});$.ajax({url:t.url+"?"+(new Date).getTime(),type:t.method,timeout:t.timeout,data:t.data?JSON.stringify(t.data):null,complete:function(t,e){if(t.status===200){n(null,JSON.parse(t.responseText))}else{n(t)}}})};t.net={api:function(e,i,a,s){if(s||t.cache.sign.session){n({url:e,data:{s:t.cache.sign.session||{},p:i}},function(e,n){if(e){a(e)}else if(n.code===200){a(null,n)}else{a(n);if(n.msg)t.aspect.noty.message(n.msg)}})}else a({msg:"no session"})}}})(window.kaidanbao);(function(t){t.conf.db={name:"kdb"};t.conf.table={setup:{_tp:"f",cn:"设置",cols:{type:"",value:""}},product:{_tp:"f",cn:"产品",nav:"sale",cols:{number:"编号",name:"名称",spec:"规格",unit:"单位",price:"售价",mold:"类型",classify:"类别",ct:"新建日期",lm:"更新日期"},sort:{spec:" ",price:" ",number:" ",name:" ",ct:" ",lm:"asc"}},customer:{_tp:"f",py:true,cn:"客户",nav:"sale",cols:{number:"编号",name:"名称",address:"地址",mold:"类型",classify:"类别",ct:"新建日期",lm:"更新日期"},sort:{number:" ",ct:" ",lm:"asc"}},supplier:{_tp:"f",py:true,cn:"供应商",nav:"sale",cols:{number:"编号",name:"名称",address:"地址",mold:"类型",classify:"类别",ct:"新建日期",lm:"更新日期"},sort:{number:" ",ct:" ",lm:"asc"}},clerk:{_tp:"f",py:true,cn:"职员",nav:"sale",cols:{number:"工号",name:"姓名",tel:"电话",mold:"类型",classify:"类别",ct:"新建日期",lm:"更新日期"},sort:{number:" ",ct:" ",lm:"asc"}},account:{_tp:"f",cn:"账户",nav:"fi",cols:{number:"编号",name:"名称",mold:"类型",classify:"类别",ct:"新建日期",lm:"更新日期"},sort:{ct:" ",lm:"asc"}},salebill:{_tp:"d",cn:"销售单",nav:"sale",cols:{ct:"单号",customer_id:"客户",saler_id:"销售员",amount:"金额",payamount:"定金",product:"商品",p_spec:"规格",count:"数量",price:"单价"},sort:{customer_id:" ",saler_id:" ",amount:" ",payamount:" ",ct:"asc"}},bringbill:{_tp:"d",cn:"采购单",nav:"sale",cols:{ct:"单号",supplier_id:"供应商",buyer_id:"采购员",amount:"金额",payamount:"首付",product:"商品",p_spec:"规格",count:"数量",price:"单价"},sort:{supplier_id:" ",buyer_id:" ",amount:" ",payamount:" ",ct:"asc"}},allotbill:{_tp:"d",cn:"调拨单",nav:"stock",cols:{number:"单号",alloter_id:"调拨员",callout:"调出仓库",callin:"调入仓库"}},pplanbill:{_tp:"d",cn:"生产单",nav:"stock",cols:{number:"单号",planer_id:"计划员",pmer:"负责人",repository:"仓库",progress:"生产进度"}},checkbill:{_tp:"d",cn:"盘点单",nav:"stock",cols:{number:"单号",customer_id:"客户",date:"日期",amount:"金额",saler_id:"销售员",cashier_id:"出纳员 ",order_id:"开单员"}},moneyflow:{_tp:"d",cn:"资金流水",nav:"fi",cols:{number:"流水号",aper:"付款方[账户]",arer:"收款方[账户]",cashier_id:"出纳员",amount:"金额",type:"类型"}},store:{cn:"库存",nav:"stock",cols:{product:"产品",spec:"规格",unit:"单位",t_cost:"平均成本",t_amount:"总金额",t_count:"总库存"}},statement:{cn:"客户对账",nav:"fi",cols:{name:"客户",count:"总签单",amount:"总欠款",lm:"更新日期",month:"月份",mcount:"签单数",mamount:"签单金额",mpreamount:"订金"},sort:{count:" ",amount:" ",lm:"asc"}},supplierstatement:{cn:"供应商对账",nav:"fi",cols:{name:"供应商",allcount:"总单数",total:"总欠款",lm:"更新日期",month:"月份",count:"签单数",amount:"签单金额",preamount:"订金"}}};t.conf.preinsert={xianjin:{tn:"account",number:"1001",name:"现金"},classify:{tn:"setup",type:"classify",moneyflow:{a0:{v:"销售收入",f:1},b0:{v:"采购支出",
f:1},c0:{v:"帐户互转",f:1}}},roll:{tn:"setup",type:"roll",value:1,r0:{name:"总经理",remark:"拥有系统所有权限",f:1}},setting:{tn:"setup",type:"setting"}};t.conf.frame={p:[{en:"home",cn:"开单宝",sol:[{en:"start",cn:"起始页",plug:[{en:"welcome",cn:"欢迎首页"},{en:"usercenter",cn:"用户中心"}]}]},{en:"sale",cn:"销售",sol:[{en:"order",cn:"销售订单",plug:[{en:"salebilling",cn:"销售开单"},{en:"salebill",cn:"销售单查询"}]},{en:"baseinfo1",cn:"资料管理",plug:[{en:"product",cn:"商品信息"},{en:"clerk",cn:"职员信息"},{en:"customer",cn:"客户信息"}]}]},{en:"stock",cn:"库存",sol:[{en:"stockmanage",cn:"仓储管理",plug:[{en:"store",cn:"库存查询"},{en:"supplier",cn:"供应商信息"}]},{en:"purchasemanage",cn:"采购管理",plug:[{en:"bringbilling",cn:"采购开单"},{en:"bringbill",cn:"采购单查询"}]}]},{en:"fi",cn:"财务",sol:[{en:"balance",cn:"对账出纳",plug:[{en:"statement",cn:"往来对账"},{en:"moneyflow",cn:"出纳流水"}]},{en:"baseinfo3",cn:"资料管理",plug:[{en:"account",cn:"账户管理"}]}]}],other:{right:[{en:"delete",cn:"删除订单",plug:[{en:"salebill",cn:"销售单"},{en:"bringbill",cn:"采购单"}]}]}}})(window.kaidanbao);(function(t){var e=t.utils;var n,i={},a=0,s;var c=function(e){var i=t.cache.get(e),s=0,c;if(!i||!i.quotation)return;n.reverse();for(var o in i.quotation){c=t.cache.fixed[o];if(c){s++;n.push({value:c.name+" ["+(c.number||"")+" ￥"+i.quotation[o][0]+"/"+(c.unit||"")+"]",data:{id:c._id,price:i.quotation[o][0],r:"-",spec:i.quotation[o][1],c:"blue"}})}}n.reverse();a=s};var o=function(){if(a===0)return;n.reverse();n.length-=a;n.reverse();a=0};t.aspect.atcp={product_auto:function(e,i){if(!n){n=[];var a=t.cache.fixed_by_table["product"],l;for(var r in a){l=t.cache.get(a[r]);if(l){n.push({value:l.name+" ["+(l.number||"")+" ￥"+l.price+"/"+(l.unit||"")+"]",data:{id:l._id,price:l.price,r:"-"}})}}}if(i){if(i!==s){o();c(i)}}else{if(i!==0)o()}if(i!==0)s=i;if(e){o();if(isNaN(e)){}else{var a=t.cache.get(e);if(a){n.unshift({value:a.name+" ["+(a.number||"")+" ￥"+a.price+"/"+(a.unit||"")+"]",data:{id:a._id,price:a.price,r:"-"}})}}c(s)}return n},auto:function(e,n){if(n==="customer"||n==="supplier"||n==="clerk"){if(!i[n]){i[n]=[];var a=t.cache.fixed_by_table[n],s;for(var c in a){s=t.cache.get(a[c]);if(s)i[n].push({value:s.name+" "+(s.name_py||""),data:{id:s._id}})}}if(e){if(isNaN(e)){}else{var a=t.cache.get(e);if(a){i[n].unshift({value:(a.name||"")+" "+(a.name_py||""),data:{id:a._id}})}}}return i[n]}}};t.aspect.auto_insert=function(n,i){var a,s,c,o={},l=n.length;if(l==0)i();else{for(s in n){a=n[s];c=t.cache.name_cache[a.tn][a.name];if(c){o[a.tn+a.name]=c;if(--l==0)i(o)}else if(!o[a.tn+a.name]){o[a.tn+a.name]=true;a.name_py=e.pinyin.getSZM(a.name);t.dao.addOne(a,function(e,n){if(e){}else{t.aspect.atcp.auto(n._id,n.tn);o[n.tn+n.name]=n._id;if(--l==0)i(o);setTimeout(function(){$("#layout div."+n.tn+" div.kc-manage-box button").click()},1)}},3)}}}};t.aspect.auto_insert_p=function(e,n){var i,a,s=[],c=e.length;for(a in e){i=e[a];i.tn="product";i.type="b";t.dao.addOne(i,function(e,i){if(e){}else{t.aspect.atcp.product_auto(i._id,0);s[i.tmp_td_id]=i._id;if(--c==0)n(s);setTimeout(function(){$("#layout div.product div.kc-manage-box button").click()},1)}},3)}}})(window.kaidanbao);(function(t){var e=t.utils,n=t.aspect,i;var a={};t.aspect.billing={init:function(){var e=t.frame.current_plugin,a="#layout div."+e;i=t.cache.sign.staff_id;$("#layout div.lay-main").append(' \t\t\t\t<div hidden class="'+e+'"> \t\t\t\t\t<div class="bill-top"></div> \t\t\t\t\t<table class="bill-table"></table> \t\t\t\t\t<div class="bill-bottom"></div>           \t\t\t<div class="bill-sub"></div> \t\t\t\t</div>');n.billing.bill_top();n.billing.bill_table();n.billing.bill_bottom();n.billing.bill_sub();$(a+" input.clerk").autocomplete({minChars:0,autoSelectFirst:true,lookup:t.aspect.atcp.auto(null,"clerk"),onSelect:function(e){$(this).val(t.cache.get(e.data.id).name).blur()}});$(a+" button.refresh").click()},bill_top:function(){var e=t.frame.current_plugin,n="#layout div."+e,i;if(e==="salebilling"){i='<div style="width:26%;">客户：<input class="customer" type="search" style="width:75%;" /></div> \t\t\t\t\t<div style="width:24%;">销售员：<input class="clerk saler" type="search" /></div> \t\t\t\t\t<div style="width:24%;">开单员：<input class="clerk order" type="search" /></div> \t\t\t\t\t<div style="width:26%;">单号：<input class="number" readonly="readonly" style="width:75%;" /></div>'}else if(e==="bringbilling"){i='<div style="width:26%;">供应商：<input class="supplier" type="search" style="width:70%;" /></div> \t\t\t\t\t<div style="width:24%;">采购员：<input class="clerk buyer" type="search" /></div> \t\t\t\t\t<div style="width:24%;">开单员：<input class="clerk order" type="search" /></div> \t\t\t\t\t<div style="width:26%;">单号：<input class="number" readonly="readonly" style="width:75%;" /></div>'}$(n+" .bill-top").html(i)},bill_table:function(){var n=t.frame.current_plugin,i="#layout div."+n,a;a='<tr> \t\t\t\t<th style="width:3%;"><svg hidden version="1.1" viewBox="0 -70 1034 1034"><path d="M933.79 349.75c-53.726 93.054-21.416 212.304 72.152 266.488l-100.626 174.292c-28.75-16.854-62.176-26.518-97.846-26.518-107.536 0-194.708 87.746-194.708 195.99h-201.258c0.266-33.41-8.074-67.282-25.958-98.252-53.724-93.056-173.156-124.702-266.862-70.758l-100.624-174.292c28.97-16.472 54.050-40.588 71.886-71.478 53.638-92.908 21.512-211.92-71.708-266.224l100.626-174.292c28.65 16.696 61.916 26.254 97.4 26.254 107.196 0 194.144-87.192 194.7-194.958h201.254c-0.086 33.074 8.272 66.57 25.966 97.218 53.636 92.906 172.776 124.594 266.414 71.012l100.626 174.29c-28.78 16.466-53.692 40.498-71.434 71.228zM512 240.668c-114.508 0-207.336 92.824-207.336 207.334 0 114.508 92.826 207.334 207.336 207.334 114.508 0 207.332-92.826 207.332-207.334-0.002-114.51-92.824-207.334-207.332-207.334z"></path></svg></th> \t\t\t\t<th style="width:29%;">商品名称</th> \t\t\t\t<th style="width:8%;">规格</th> \t\t\t\t<th style="width:6%;">单位</th> \t\t\t\t<th style="width:9%;">数量</th> \t\t\t\t<th style="width:9%;">单价 </th> \t\t\t\t<th style="width:11%;">金额</th> \t\t\t\t<th>备注</th></tr> \t\t\t\t<tr><td class="num">1</td><td class="p_name"><input        type="search" data-index="0" /></td><td class="p_spec"></td><td class="p_unit"></td><td data-index="0" class="count"></td><td data-index="0" class="p_price"></td><td class="amount"></td><td class="remark"></td></tr> \t\t\t\t<tr><td class="num">2</td><td class="p_name"><input hidden type="search" data-index="1" /></td><td class="p_spec"></td><td class="p_unit"></td><td data-index="1" class="count"></td><td data-index="1" class="p_price"></td><td class="amount"></td><td class="remark"></td></tr> \t\t\t\t<tr><td class="num">3</td><td class="p_name"><input hidden type="search" data-index="2" /></td><td class="p_spec"></td><td class="p_unit"></td><td data-index="2" class="count"></td><td data-index="2" class="p_price"></td><td class="amount"></td><td class="remark"></td></tr> \t\t\t\t<tr><td class="num">4</td><td class="p_name"><input hidden type="search" data-index="3" /></td><td class="p_spec"></td><td class="p_unit"></td><td data-index="3" class="count"></td><td data-index="3" class="p_price"></td><td class="amount"></td><td class="remark"></td></tr> \t\t\t\t<tr><td class="num">5</td><td class="p_name"><input hidden type="search" data-index="4" /></td><td class="p_spec"></td><td class="p_unit"></td><td data-index="4" class="count"></td><td data-index="4" class="p_price"></td><td class="amount"></td><td class="remark"></td></tr> \t\t\t\t<tr><td class="num">6</td><td class="p_name"><input hidden type="search" data-index="5" /></td><td class="p_spec"></td><td class="p_unit"></td><td data-index="5" class="count"></td><td data-index="5" class="p_price"></td><td class="amount"></td><td class="remark"></td></tr> \t\t\t\t<tr><td class="num">7</td><td class="p_name"><input hidden type="search" data-index="6" /></td><td class="p_spec"></td><td class="p_unit"></td><td data-index="6" class="count"></td><td data-index="6" class="p_price"></td><td class="amount"></td><td class="remark"></td></tr> \t\t\t\t<tr><td class="num">8</td><td class="p_name"><input hidden type="search" data-index="7" /></td><td class="p_spec"></td><td class="p_unit"></td><td data-index="7" class="count"></td><td data-index="7" class="p_price"></td><td class="amount"></td><td class="remark"></td></tr> \t\t\t\t<tr><td class="num">9</td><td class="p_name"><input hidden type="search" data-index="8" /></td><td class="p_spec"></td><td class="p_unit"></td><td data-index="8" class="count"></td><td data-index="8" class="p_price"></td><td class="amount"></td><td class="remark"></td></tr> \t\t\t\t<tr class="foot"><td class="num"></td><td class="dx" colspan="3">合计：</td><td class="count-sum">0</td><td></td><td class="amount-sum">0.00</td><td></td></tr>';$(i+" .bill-table").html(a);$(i+" td").attr("spellcheck","false");$(i+" td.p_spec").attr("contenteditable","true");$(i+" td.p_unit").attr("contenteditable","true");$(i+" td.count").attr("contenteditable","true");$(i+" td.p_price").attr("contenteditable","true");$(i+" td.remark").attr("contenteditable","true");var s=function(t){var n=$(i+" td.count").eq(t).html();var a=$(i+" td.p_price").eq(t).html();if(e.is_float(n)&&e.is_float(a)){n=parseFloat(n);a=parseFloat(a);$(i+" td.amount").eq(t).html((n*a).toFixed(2));$(i+" td.p_name input").eq(t+1).removeAttr("hidden")}else $(i+" td.amount").eq(t).html("");var s=0,c=0,o;for(var l=0;l<9;l++){o=$(i+" td.amount").eq(l).html();if(o){c+=parseFloat(o);s+=parseFloat($(i+" td.count").eq(l).html())}}var r=s.toFixed(3),u=c.toFixed(2);if(s==parseFloat(r))r=s;$(i+" td.count-sum").html(r);$(i+" td.amount-sum").html(u);if($(i+" select.settlement").val()==="x")$(i+" input.payamount").val(u);if(u!=0)$(i+" td.dx").html("合计："+e.DX(u));else $(i+" td.dx").html("合计：")};$(i+" td.count,"+i+" td.p_price").keyup(function(t){s(parseInt($(this).attr("data-index")))});$(i+" td.count,"+i+" td.p_price").blur(function(t){s(parseInt($(this).attr("data-index")))});$(i+" td.count,"+i+" td.p_price").keypress(function(t){var e=parseInt($(this).attr("data-index"));if(t.keyCode===13){if(e<9)$(i+" td.p_name input").eq(e+1).focus();if(window.event)window.event.returnValue=false;else t.preventDefault()}});$(i+" td.p_name input").autocomplete({minChars:0,width:"41.2%",lookup:t.aspect.atcp.product_auto(),onSelect:function(e){var n=parseInt($(this).attr("data-index"));var a=t.cache.get(e.data.id);$(i+" td.p_name input").eq(n).val(a.name).attr("data-id",e.data.id);$(i+" td.p_unit").eq(n).html(a.unit).removeAttr("contenteditable");$(i+" td.p_spec").eq(n).html(e.data.spec?e.data.spec:a.spec);$(i+" td.p_price").eq(n).html(e.data.price);$(i+" td.count").eq(n).focus()},onSearchComplete:function(t,e){var n=parseInt($(this).attr("data-index"));$(i+" td.p_name input").eq(n).removeAttr("data-id");$(i+" td.p_unit").eq(n).attr("contenteditable","true");if(!$(i+" td.p_name input").eq(n).val()){$(i+" td.p_spec").eq(n).html("");$(i+" td.p_unit").eq(n).html("");$(i+" td.count").eq(n).html("");$(i+" td.p_price").eq(n).html("");$(i+" td.amount").eq(n).html("");$(i+" td.remark").eq(n).html("")}}})},bill_bottom:function(){var e=t.frame.current_plugin,n="#layout div."+e;var i=' \t\t\t\t结算：<select class="settlement"><option value="q" >签单对账</option><option value="x" >现付全款</option></select> , \t\t\t\t本次付款：<input class="payamount" value="0.00" /> , \t\t\t\t账户：<select class="account"></select> , \t\t\t\t出纳员：<input class="clerk cashier" type="search" /> , \t\t\t\t摘要：<input class="pay-remark" type="text" />';$(n+" .bill-bottom").html(i);$(n+" select.settlement").change(function(){if($(this).val()==="q")$(n+" input.payamount").val("0.00");else $(n+" input.payamount").val($(n+" td.amount-sum").html())});if(e==="salebilling"){$(n+" input.customer").autocomplete({minChars:0,showNoSuggestionNotice:false,lookup:t.aspect.atcp.auto(null,"customer"),onSelect:function(e){$(this).val(t.cache.get(e.data.id).name);$(n+" input.customer").blur();$(n+" td.p_name input").eq(0).focus()}});$(n+" input.customer").blur(function(){t.aspect.atcp.product_auto(null,t.cache.name_cache["customer"][$(this).val().trim()])});$(n+" input.customer").keydown(function(t){if(t.keyCode===13&&$(n+" input.customer").val()&&!t.ctrlKey){$(n+" td.p_name input").eq(0).focus()}})}else if(e==="bringbilling"){$(n+" input.supplier").autocomplete({minChars:0,showNoSuggestionNotice:false,lookup:t.aspect.atcp.auto(null,"supplier"),onSelect:function(e){$(this).val(t.cache.get(e.data.id).name);$(n+" input.supplier").blur();$(n+" td.p_name input").eq(0).focus()}});$(n+" input.supplier").blur(function(){t.aspect.atcp.product_auto(null,t.cache.name_cache["supplier"][$(this).val().trim()])});$(n+" input.supplier").keydown(function(t){if(t.keyCode===13&&$(n+" input.supplier").val()&&!t.ctrlKey){$(n+" td.p_name input").eq(0).focus()}})}},bill_sub:function(){var e=t.frame.current_plugin,i="#layout div."+e;var s=' \t\t\t\t<button class="submit">提交</button> \t\t\t\t<button class="print-now">打印</button> \t\t\t\t<button class="print-set">打印设置</button> \t\t\t\t<button class="refresh">刷新</button>';$(i+" .bill-sub").html(s);$(i+" button.submit").click(function(){if(!n.billing.check_bill())return;n.billing.create_bill(function(s){t.dao.addOne(s,function(c,o){if(o){a[t.frame.current_plugin]=s;if(e==="salebilling"){t.aspect.noty.message("新增销售单成功!")}if(e==="bringbilling"){t.aspect.noty.message("新增采购单成功!")}$(i+" button.submit").html("成功").attr("disabled","disabled");$(i+" button.print-now").removeAttr("disabled").focus();setTimeout(function(){n.billing.save_setting(s,function(){n.billing.save_moneyflow(s,function(){t.syn.upl(function(){n.billing.save_quotation(s)})})})},500)}else t.aspect.noty.message("新增销售单失败!")},3)})});$(i+" button.print-now").click(function(){n.print.prepare(a[t.frame.current_plugin]);n.print.ad();if(n.print.act())$(i+" button.print-now").attr("disabled","disabled");$(i+" button.refresh").focus()});$(i+" button.print-set").click(function(){n.print.prepare(null,"[test]");var e=t.frame.current_plugin,i,a,s,c,o,l;$.facebox($("#print").html());if(e==="salebilling"){a="salebill-print";i=t.cache.setup(a);$("#facebox div.title").html('<a href="#/sale/salebilling">销售开单</a> > 打印设置（鼠标点击文字即可修改设置）')}else if(e==="bringbilling"){a="bringbill-print";i=t.cache.setup(a);$("#facebox div.title").html('<a href="#/sale/bringbilling">采购开单</a> > 打印设置（鼠标点击文字即可修改设置）')}$("#facebox div.footer").html('<button class="save">保存设置</button><button onclick="kaidanbao.aspect.print.facebox(1);">打印样单</button>');$("#facebox .print").css("width","203mm");$("#facebox .print td,#facebox .print th").css("border","1px solid #000");$("#facebox button.save").click(function(){s=$("#facebox .print .tit").html();c=$("#facebox .print .tips").html();o=$("#facebox .print .notice").html();l=$("#facebox .print .color").html();var e={tn:"setup",type:a},n;if(i){if(i.title!==s){e.title=s;n=true}if(i.tips!==c){e.tips=c;n=true}if(i.notice!==o){e.notice=o;n=true}if(i.color!==l){e.color=l;n=true}if(n){e._id=i._id;t.dao.updOne(e,function(e,n){if(n){t.aspect.noty.message("打印设置保存成功！")}})}}else{e.title=s;e.tips=c;e.notice=o;e.color=l;t.dao.addOne(e,function(e,n){if(n){t.aspect.noty.message("打印设置保存成功！")}})}$.facebox.close()})});$(i+" button.refresh").click(function(){$(i+" input.customer").val("");$(i+" input.supplier").val("");a[t.frame.current_plugin]=null;t.aspect.atcp.product_auto();n.billing.clear_table();t.aspect.manage.selectAccountRefresh($(i+" select.account"));$(i+" td.p_name input").eq(0).removeAttr("hidden");$(i+" input.payamount").val("0.00");var s={salebilling:"XS-",bringbilling:"CG-"};$(i+" input.number").val(s[e]+t.aspect.manage.get_number());$(i+" button.submit").removeAttr("disabled").html("提交");$(i+" button.print-now").removeAttr("disabled");$(i+" button.print-now").attr("disabled","disabled");$(i+" select.settlement").val("q");$(i+" input.pay-remark").val("");n.billing.set_default()})},check_bill:function(){var n=t.frame.current_plugin,i="#layout div."+n;if(n==="salebilling"){if(!$(i+" input.customer").val().trim()){t.aspect.noty.message("客户不能为空!");$(i+" input.customer").focus();return false}if(!$(i+" input.saler").val().trim()){t.aspect.noty.message("销售员不能为空!");$(i+" input.saler").focus();return false}}else if(n==="bringbilling"){if(!$(i+" input.supplier").val().trim()){t.aspect.noty.message("供应商不能为空!");$(i+" input.supplier").focus();return false}if(!$(i+" input.buyer").val().trim()){t.aspect.noty.message("采购员不能为空!");$(i+" input.buyer").focus();return false}}if(!e.is_float($(i+" input.payamount").val().trim())){t.aspect.noty.message("付款金额必须为数值!");$(i+" input.payamount").focus();return false}if(parseFloat($(i+" input.payamount").val())!=0&&!$(i+" input.cashier").val().trim()){t.aspect.noty.message("出纳员不能为空!");$(i+" input.cashier").focus();return false}for(var a=0;a<9;a++){if($(i+" td.p_name input").eq(a).val()){if(!$(i+" td.amount").eq(a).html()){t.aspect.noty.message("商品详情无效!");return false}}else{if($(i+" td.amount").eq(a).html()){t.aspect.noty.message("商品详情无效!");return false}else break}}if(a==0){t.aspect.noty.message("商品详情无效!");return false}else return true},create_bill:function(e){var n=t.frame.current_plugin,i="#layout div."+n;var a={detail:[]},s;a.number=$(i+" input.number").val();a.count=parseFloat($(i+" td.count-sum").html());a.amount=parseFloat($(i+" td.amount-sum").html());a.settlement=$(i+" select.settlement").val();var c=$(i+" input.order").val().trim(),o=$(i+" input.cashier").val().trim(),l,r,u,d;a.payamount=parseFloat($(i+" input.payamount").val().trim());if(a.payamount!=0){a.account_id=parseInt($(i+" select.account").val())}else delete a.payamount;if(n==="salebilling"){a.tn="salebill";u=$(i+" input.customer").val().trim();r=$(i+" input.saler").val().trim()}else if(n==="bringbilling"){a.tn="bringbill";d=$(i+" input.supplier").val().trim();l=$(i+" input.buyer").val().trim()}var p=[];if(c)p.push({tn:"clerk",name:c});if(o)p.push({tn:"clerk",name:o});if(l)p.push({tn:"clerk",name:l});if(r)p.push({tn:"clerk",name:r});if(u)p.push({tn:"customer",name:u});if(d)p.push({tn:"supplier",name:d});t.aspect.auto_insert(p,function(n){if(n){if(n["clerk"+c])a.order_id=n["clerk"+c];if(n["clerk"+o])a.cashier_id=n["clerk"+o];if(n["clerk"+l])a.buyer_id=n["clerk"+l];if(n["clerk"+r])a.saler_id=n["clerk"+r];if(n["customer"+u])a.customer_id=n["customer"+u];if(n["supplier"+d])a.supplier_id=n["supplier"+d]}var p=[],f;for(var h=0;h<9;h++){s=[];f=$(i+" td.p_name input").eq(h).val().trim();s[4]=$(i+" td.amount").eq(h).html();if(s[4]&&f){s[0]=parseInt($(i+" td.p_name input").eq(h).attr("data-id"));s[1]=$(i+" td.p_spec").eq(h).html();s[2]=parseFloat($(i+" td.count").eq(h).html());s[3]=parseFloat($(i+" td.p_price").eq(h).html());s[4]=parseFloat(s[4]);s[5]=$(i+" td.remark").eq(h).html();a.detail.push(s);if(!s[0]){p.push({name:f,unit:$(i+" td.p_unit").eq(h).html(),spec:s[1],price:s[3],tmp_td_id:h})}}}if(p.length>0){t.aspect.auto_insert_p(p,function(t){for(var n=0;n<9;n++){if(a.detail[n]&&!a.detail[n][0]&&t[n]){a.detail[n][0]=t[n]}}e(a)})}else e(a)})},save_moneyflow:function(e,n){var i={tn:"moneyflow"};if(e.payamount){var a=t.frame.current_plugin,s="#layout div."+a;if(a==="salebilling"){i.type="xs";i.aper_id=e.customer_id;i.account_r=e.account_id}if(a==="bringbilling"){i.type="cg";i.arer_id=e.supplier_id;i.account_p=e.account_id}i.number="CN"+e.number.substring(2);i.flag=e.settlement==="x"?"d":"a";i.amount=e.payamount;i.cashier_id=e.cashier_id;i.bill_number=e.number;t.dao.addOne(i,function(t,e){n()},3)}else n()},save_setting:function(e,n){var a=t.frame.current_plugin,s="#layout div."+a;var c=t.cache.setup(a);var o=c._id,l={tn:"setup"},r=0;var u=$(s+" input.buyer").val(),d;if(u){d=t.cache.name_cache["clerk"][u.trim()];if(c["buyer"+i]!==d){r++;l["buyer"+i]=d}}var p=$(s+" input.saler").val(),f;if(p){f=t.cache.name_cache["clerk"][p.trim()];if(c["saler"+i]!==f){r++;l["saler"+i]=f}}var h=$(s+" input.order").val().trim(),g;if(h){g=t.cache.name_cache["clerk"][h];if(c["order"+i]!==g){r++;l["order"+i]=g}}var m=$(s+" input.cashier").val().trim(),b;if(m){b=t.cache.name_cache["clerk"][m];if(c["cashier"+i]!==b){r++;l["cashier"+i]=b}}var v=$(s+" select.account").val();if(c["account"+i]!==parseInt(v)){r++;l["account"+i]=parseInt(v)}if(r>0){if(o){l._id=o;t.dao.updOne(l,n,3)}else{l["type"]=a;t.dao.addOne(l,n,3)}}else n()},save_quotation:function(e){var n=t.frame.current_plugin,i="#layout div."+n,a;if(n==="salebilling")a=t.cache.get(e.customer_id);if(n==="bringbilling")a=t.cache.get(e.supplier_id);var s={_id:a._id,tn:a.tn};if(e.settlement==="q"){s["s"+t.cache.dates.mt[0]]=a["s"+t.cache.dates.mt[0]]||{};s["s"+t.cache.dates.mt[0]]["i"+e._id]=[e.number,e.amount,e.payamount]}s.quotation=a.quotation||{};for(var c in e.detail){if(e.detail[c][3]!=0){s.quotation["i"+e.detail[c][0]]=[e.detail[c][3],e.detail[c][1]]}}t.dao.updOne(s,null,3)},clear_table:function(){var e=t.frame.current_plugin,n="#layout div."+e;$(n+" td.p_name input").val("").attr("hidden","hidden").removeAttr("data-id");$(n+" td.p_spec").html("");$(n+" td.remark").html("");$(n+" td.count").html("");$(n+" td.p_price").html("");$(n+" td.amount").html("");$(n+" td.p_unit").html("").attr("contenteditable","true");$(n+" td.dx").html("合计：");$(n+" td.count-sum").html("0");$(n+" td.amount-sum").html("0.00");$(n+" td.p_name input").eq(0).removeAttr("hidden");$(n+" input.pay-remark").val("")},set_default:function(){var e=t.frame.current_plugin,n="#layout div."+e;var a=t.cache.setup(e);if(a["buyer"+i])$(n+" input.buyer").val(t.cache.get(a["buyer"+i]).name);if(a["saler"+i])$(n+" input.saler").val(t.cache.get(a["saler"+i]).name);if(a["order"+i])$(n+" input.order").val(t.cache.get(a["order"+i]).name);if(a["cashier"+i])$(n+" input.cashier").val(t.cache.get(a["cashier"+i]).name);if(a["account"+i])$(n+" select.account").val(a["account"+i])}};t.aspect.bill={view:function(e,n){t.dao.get(n,e,function(i){if(!i)return;t.aspect.print.prepare(i);$.facebox($("#print").html());$("#facebox div.title").html("查看订单详情");$("#facebox .print").css("width","203mm");$("#facebox .print td,#facebox .print th").css("border","1px solid #000");$("#facebox .print th").css("background-color","#fff");$("#facebox div.footer").html('<button onclick="kaidanbao.aspect.print.facebox();">打印</button><button class="del" style="color:#f08;">删除</button>');$("#facebox button.del").click(function(){t.aspect.noty.confirm("<br /><h1>确定删除订单？</h1>",function(){t.dao.del(n,e,function(){t.aspect.noty.message("删除成功！");var e=t.cache.get(i.customer_id||i.supplier_id),a={_id:e._id,tn:e.tn};var s=i.number.split("-")[2],c="s"+s.substr(2,4);if(i.settlement==="q"&&e[c]!=="x"){a[c]=e[c];a[c]["i"+i._id][3]="x";t.dao.updOne(a,null,1)}$.facebox.close();t.aspect.noty.confirm_close();$("#layout div."+n+" div.kc-manage-box button").click()})})})})},init:function(){var n=t.frame.current_plugin,i="#layout div."+n;t.aspect.manage.init({search:function(a){if(n==="salebill"){$(i+" input").attr("placeholder","搜索单号、客户、销售员、商品")}else if(n==="bringbill"){$(i+" input").attr("placeholder","搜索单号、供应商、采购员、商品")}var s=$(i+" input").val().trim(),c,o,l=0;if(s){c=s.toLowerCase().split(" ");o=c.length}$(i+" table.kc-manage-list tr.list").remove();var r=0,u=0,d=0;var p=$(i+" select.s1").val(),f=$(i+" select.s2").val();t.dao.queryDynamicByMonth(n,f,function(a){if(a){var s=t.cache.dynamic[n][f],h;var g=$(i+" th.sort.asc").attr("data-sort");var m=$(i+" th.sort.desc").attr("data-sort");if(g){s.sort(function(t,e){if(t[g]&&e[g])return t[g]<e[g]?1:-1;else if(e[g])return 1;else return-1})}else if(m){s.sort(function(t,e){if(t[m]&&e[m])return t[m]>e[m]?1:-1;else if(t[m])return 1;else return-1})}var b,v,y;for(var x in s){h=e.extend({},s[x]);h.product=[];y=0;if(h.st!=="d"&&p==="del"||h.st==="d"&&p!=="del")continue;for(v in h.detail){if(p!=="tt"||h.detail[v][4]<0){h.product[v]=(t.cache.get(h.detail[v][0]).number||"")+" "+t.cache.get(h.detail[v][0]).name;y++}}if(y>0){h.supplier=t.cache.get(h.supplier_id).name;h.customer=t.cache.get(h.customer_id).name;h.saler=t.cache.get(h.saler_id).name||"";h.buyer=t.cache.get(h.buyer_id).name||"";if(c){l=0;for(var _ in c){if(h.number.toLowerCase().indexOf(c[_])>=0){h.number=h.number.replace(new RegExp("("+c[_]+")","gi"),"<b>$1</b>");l++}if(n==="salebill"){if(h.customer.toLowerCase().indexOf(c[_])>=0){h.customer=h.customer.replace(new RegExp("("+c[_]+")","gi"),"<b>$1</b>");l++}if(h.saler.toLowerCase().indexOf(c[_])>=0){h.saler=h.saler.replace(new RegExp("("+c[_]+")","gi"),"<b>$1</b>");l++}}else if(n==="bringbill"){if(h.supplier.toLowerCase().indexOf(c[_])>=0){h.supplier=h.supplier.replace(new RegExp("("+c[_]+")","gi"),"<b>$1</b>");l++}if(h.buyer.toLowerCase().indexOf(c[_])>=0){h.buyer=h.buyer.replace(new RegExp("("+c[_]+")","gi"),"<b>$1</b>");l++}}for(v in h.detail){if(h.product[v].toLowerCase().indexOf(c[_])>=0){h.product[v]=h.product[v].replace(new RegExp("("+c[_]+")","gi"),"<b>$1</b>");l++;break}}}if(l<o)continue}if(n==="salebill"){b='</td><td rowspan="'+y+'"><span title="查看" onclick="kaidanbao.aspect.bill.view('+h._id+",'"+n+"')\">"+h.number+'</span></td><td style="text-align:left;white-space:normal;width:8%;" rowspan="'+y+'">'+h.customer+'</td><td style="text-align:left;" rowspan="'+y+'">'+h.saler+'</td><td rowspan="'+y+'">'+h.amount+'</td><td rowspan="'+y+'">'+(h.payamount||0)}else if(n==="bringbill"){b='</td><td rowspan="'+y+'"><span title="查看" onclick="kaidanbao.aspect.bill.view('+h._id+",'"+n+"')\">"+h.number+'</span></td><td style="text-align:left;white-space:normal;width:8%;" rowspan="'+y+'">'+h.supplier+'</td><td style="text-align:left;" rowspan="'+y+'">'+h.buyer+'</td><td rowspan="'+y+'">'+h.amount+'</td><td rowspan="'+y+'">'+(h.payamount||0)}u++;for(v in h.detail){if(h.product[v]){r+=h.detail[v][4];$(i+" table.kc-manage-list").append('<tr class="list '+(u%2===0?"opp":"")+'"><td class="num">'+ ++d+b+'</td><td style="text-align:left;">'+h.product[v]+"</td><td>"+(h.detail[v][1]||"")+"</td><td>"+(h.detail[v][2]||"")+"</td><td>"+(h.detail[v][3]||"")+"/"+(t.cache.get(h.detail[v][0]).unit||"")+'</td><td class="remark">'+(h.detail[v][5]||"")+"</td></tr>");b=""}}}}$(i+" section.summary-box").html("总计："+d+" 条，"+r.toFixed(2)+" 元")}})},select:function(){if(n==="salebill"){$(i+" select.s1").append('<option value="dt"><销售单></option>')}else if(n==="bringbill"){$(i+" select.s1").append('<option value="dt"><采购单></option>')}$(i+" select.s1").append('<option value="tt"><退货单></option><option value="del"><已删除></option>');for(var e in t.cache.dates.m_t){if(e<=t.cache.sign.month_length)$(i+" select.s2").append("<option>"+t.cache.dates.m_t[e]+"</option>")}},create:"noop",classify:"noop"})}}})(window.kaidanbao);(function(t){var e=t.utils;t.aspect.manage={sort:function(t,e){if($(t).hasClass("asc")){$(t).removeClass("asc");$(t).addClass("desc")}else{$(t).parent().children(".sort").removeClass("asc").removeClass("desc");$(t).addClass("asc")}$("div."+e+" .kc-manage-box button.s-btn").click()},th_fill:function(e,n){var i;for(var a in t.conf.table[n]["cols"]){if(t.conf.table[n]["sort"]&&t.conf.table[n]["sort"][a]){i=t.conf.table[n]["sort"][a];e.before('<th data-sort="'+a+'" onclick="kaidanbao.aspect.manage.sort(this,\''+n+'\')" class="norm sort '+(i||"")+'">'+t.conf.table[n]["cols"][a]+"</th>")}else{e.before('<th class="norm">'+t.conf.table[n]["cols"][a]+"</th>")}}},search_enter:function(t){if(t.keyCode=="13"||!$(t.target).val()){$(t.target.nextSibling.nextSibling.nextSibling).click()}},get_number:function(){return t.cache.sign.staff_id+"-"+e.date.getTimeFormat(0,"dt").replace(/-/g,"").replace(/:/g,"").replace(/ /g,"-")},selectAccountRefresh:function(e,n){e.html("");if(n==="a"){e.append('<option value="a"><所有账户></option>')}var i,a,s={};for(i in t.cache.fixed_by_table["account"]){if(!s["i"+t.cache.fixed_by_table["account"][i]]){s["i"+t.cache.fixed_by_table["account"][i]]=1;a=t.cache.get(t.cache.fixed_by_table["account"][i]);e.append('<option value="'+a._id+'">'+a.name+"</option>")}}},selectClassifyRefresh:function(e,n,i){e.html("");var a=t.cache.setup(n+"_classify").value,s={a:"类型",b:"类别"};if(i[1]==="a")e.append('<option value="a"><所有'+s[i[0]]+"></option>");if(i[2]==="n")e.append('<option value="n"><无'+s[i[0]]+"></option>");if(a){for(var c in a){if(c[0]==i[0]&&a[c].v)e.append('<option value="'+c+'">'+a[c].v+"</option>")}}},search:function(n){var i=$(n.box+" .kc-manage-box input").val().trim(),a,s,c=0;if(i){a=i.toLowerCase().split(" ");s=a.length}var o=$(n.box+" .kc-manage-box select.s1").val(),l=1,r;var u=$(n.box+" .kc-manage-box select.s2").val();$(n.box+" table.kc-manage-list tr.list").remove();var d=t.cache.fixed_page[n.table],p,f={};var h=$(n.box+" th.sort.asc").attr("data-sort");var g=$(n.box+" th.sort.desc").attr("data-sort");if(h){d.sort(function(e,n,i,a){i=t.cache.get(e)[h];a=t.cache.get(n)[h];if(i&&a)return i<a?1:-1;else if(a)return 1;else return-1})}else if(g){d.sort(function(e,n,i,a){i=t.cache.get(e)[g];a=t.cache.get(n)[g];if(i&&a)return i>a?1:-1;else if(i)return 1;else return-1})}var m=t.cache.setup(n.table+"_classify")||{value:""};for(var b in d){p=e.extend({},t.cache.get(d[b]));if(f["i"+d[b]]){continue}else{f["i"+d[b]]=1}if(o==="n"&&p.mold&&m.value[p.mold]&&m.value[p.mold].v)continue;if(o!=="n"&&o!=="a"&&p.mold!==o)continue;if(u==="n"&&p.classify&&m.value[p.classify]&&m.value[p.classify].v)continue;if(u!=="n"&&u!=="a"&&p.classify!==u)continue;p.number=p.number||"";if(a){c=0;for(var v in a){if(p.number&&p.number.toLowerCase().indexOf(a[v])>=0){p.number=p.number.replace(new RegExp("("+a[v]+")","gi"),"<b>$1</b>");c++}if(p.name.toLowerCase().indexOf(a[v])>=0){p.name=p.name.replace(new RegExp("("+a[v]+")","gi"),"<b>$1</b>");c++}}if(c<s)continue}if(n.count)n.count(p);if(p.mold&&m.value[p.mold]&&m.value[p.mold].v)p.mold=m.value[p.mold].v;else p.mold="<无类型>";if(p.classify&&m.value[p.classify]&&m.value[p.classify].v)p.classify=m.value[p.classify].v;else p.classify="<无类别>";p.ct=e.date.getTimeFormat(p.ct,"d");p.lm=e.date.getTimeFormat(p.lm,"d");var y="";for(var x in t.conf.table[n.table]["cols"]){if(x==="name")y+='<td style="text-align:left;"><span title="查看" onclick="kaidanbao.aspect.manage.modify('+p._id+')">'+p.name+"</span></td>";else y+="<td>"+(p[x]||"")+"</td>"}$(n.box+" table.kc-manage-list").append('<tr class="list '+(l%2===0?"opp":"")+'"><td class="num">'+l++ +"</td>"+y+'<td class="remark">'+(p.remark||"")+"</td></tr>")}if(n.notice)n.notice()},insert:function(e){var n={tn:e},i,a;for(i in t.conf.table[e]["cols"]){if(t.conf.table[e]["cols"][i]){if(i=="classify"||i==="mold"){a=$("#facebox select."+i).val();if(a!=="n")n[i]=a}else if(i!="ct"&&i!="lm"){a=$("#facebox input."+i).val().trim();if(a)n[i]=a}}}if(n["name"]){if(t.cache.name_cache[e][n["name"]]){t.aspect.noty.message(t.conf.table[e]["cn"]+"名称不能重复!");return}}else{t.aspect.noty.message(t.conf.table[e]["cn"]+"名称不能为空!");return}if(t.conf.table[e].py)n["name_py"]=$("#facebox input.pinyin").val().trim();var s=$("#facebox textarea.remark").val();if(s)n["remark"]=s;t.dao.addOne(n,function(n,i){if(n){}else{$.facebox.close();t.aspect.noty.message(t.conf.table[e]["cn"]+"信息新增成功!");t.aspect.atcp.auto(i._id,e);setTimeout(function(){$("#layout div."+e+" div.kc-manage-box button").click()},1)}})},modify:function(n){var i=t.frame.current_plugin,a;var s="#layout div."+i,c=t.cache.get(n);var o="",a,l;for(a in t.conf.table[i]["cols"]){if(l=t.conf.table[i]["cols"][a]){if(a==="mold"||a==="classify"||a==="ct"||a==="lm")continue;if(t.conf.table[i].py&&a=="name"){o+='<div class="fb-input-wrapper"><label>'+l+'：</label> \t\t\t\t\t\t<input style="width:150px;" class="name" value="'+c.name+'" /><input value="'+(c.name_py||"")+'" class="pinyin" style="width:85px;margin-left:3px;" placeholder="简拼" /></div>'}else{o+='<div class="fb-input-wrapper"><label>'+l+'：</label> \t\t\t\t\t\t\t<input class="'+a+'" value="'+(c[a]||"")+'" /></div>'}}}$.facebox(o+' \t\t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t\t<label>分类：</label><select style="width:152px;" class="mold"></select><select style="width:152px;margin-left:3px;" class="classify"></select></div> \t\t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t\t<label>备注：</label> \t\t\t\t\t<textarea class="remark" maxlength="120">'+(c.remark||"")+'</textarea></div> \t\t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t\t<label>&nbsp;</label> \t\t\t\t\t<button onclick="kaidanbao.aspect.manage.update('+c._id+')">修改</button> \t\t\t</div>');
t.aspect.manage.selectClassifyRefresh($("#facebox select.mold"),i,"a0n");t.aspect.manage.selectClassifyRefresh($("#facebox select.classify"),i,"b0n");var r=t.cache.setup(i+"_classify")||{value:""};if(c.mold&&r.value[c.mold]&&r.value[c.mold].v)$("#facebox select.mold").val(c.mold);else $("#facebox select.mold").val("n");if(c.classify&&r.value[c.classify]&&r.value[c.classify].v)$("#facebox select.classify").val(c.classify);else $("#facebox select.classify").val("n");$("#facebox div.title").html("修改"+t.conf.table[i]["cn"]+"信息");if(t.conf.table[i].py){$("#facebox input.name").change(function(){$("#facebox input.pinyin").val(e.pinyin.getSZM($(this).val()))})}},update:function(e){var n=t.cache.get(e);var i=t.frame.current_plugin,a;var s={_id:e,tn:i},c,o=n.name;for(c in t.conf.table[i]["cols"]){if(t.conf.table[i]["cols"][c]){if(c=="mold"||c=="classify"){a=$("#facebox select."+c).val();if(a==="n"){if(n[c])s[c]=""}else{if(a!=n[c])s[c]=a}}else if(c!="ct"&&c!="lm"){a=$("#facebox input."+c).val().trim();if(n[c]){if(n[c]!==a)s[c]=a}else if(a)s[c]=a}}}if(s["name"]){if(t.cache.name_cache[i][s["name"]]&&t.cache.name_cache[i][s["name"]]!==e){t.aspect.noty.message(t.conf.table[i]["cn"]+"名称不能重复!");return}}else if(s["name"]===""){t.aspect.noty.message(t.conf.table[i]["cn"]+"名称不能为空!");return}if(t.conf.table[i].py)s["name_py"]=$("#facebox input.pinyin").val().trim();var l=$("#facebox textarea.remark").val();if(n["remark"]){if(n["remark"]!==l)s["remark"]=l}else if(l)s["remark"]=l;t.dao.updOne(s,function(e,n){if(e){}else{$.facebox.close();t.aspect.noty.message(t.conf.table[i]["cn"]+"信息修改成功!");if(s["name"])t.cache.name_cache[i][o]=0;t.aspect.atcp.auto(n._id,i);setTimeout(function(){$("#layout div."+i+" div.kc-manage-box button").click()},1)}})},create:function(n){var i="",a,s;for(a in t.conf.table[n]["cols"]){if(s=t.conf.table[n]["cols"][a]){if(a==="mold"||a==="classify"||a==="ct"||a==="lm")continue;if(t.conf.table[n].py&&a=="name"){i+='<div class="fb-input-wrapper"><label>'+s+'：</label> \t\t\t\t\t\t<input style="width:150px;" class="name" /><input class="pinyin" style="width:85px;margin-left:3px;" placeholder="简拼" /></div>'}else{i+='<div class="fb-input-wrapper"><label>'+s+'：</label> \t\t\t\t\t\t\t<input class="'+a+'" /></div>'}}}$.facebox(i+' \t\t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t\t<label>分类：</label><select style="width:154px;" class="mold"></select><select style="width:154px;margin-left:3px;" class="classify"></select></div> \t\t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t\t<label>备注：</label> \t\t\t\t\t<textarea class="remark" maxlength="120"></textarea></div> \t\t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t\t<label>&nbsp;</label> \t\t\t\t\t<button onclick="kaidanbao.aspect.manage.insert(\''+n+"')\">提交</button> \t\t\t</div>");t.aspect.manage.selectClassifyRefresh($("#facebox select.mold"),n,"a0n");t.aspect.manage.selectClassifyRefresh($("#facebox select.classify"),n,"b0n");$("#facebox div.title").html('<a href="#/'+t.conf.table[n]["nav"]+"/"+n+'">'+t.conf.table[n]["cn"]+"管理</a> > 新增"+t.conf.table[n]["cn"]+"信息");if(t.conf.table[n].py){$("#facebox input.name").change(function(){$("#facebox input.pinyin").val(e.pinyin.getSZM($(this).val()))})}},init:function(n){var i=t.frame.current_plugin,a;var s="#layout div."+i;$("#layout div.lay-main").append(' \t\t\t\t<div hidden class="'+i+'"> \t\t          <div class="kc-manage-box"> \t\t\t\t\t<input class="s-input" onkeyup="kaidanbao.aspect.manage.search_enter(event);" /><select class="s1"></select><select class="s2"></select><button class="s-btn">搜索</button> \t\t\t\t\t<div><section class="func-a"> \t\t\t\t\t\t<span class="create">新增</span> \t\t\t\t\t\t<span class="classify">分类</span> \t\t\t\t</section><section class="summary-box"></section></div> \t\t\t\t  </div> \t\t\t\t  <table class="kc-manage-list"> \t\t\t\t     <tr><th title="下载表格" class="num"><svg class="down" version="1.1" viewBox="0 -70 1034 1034"><path d="M512 384l256 256h-192v256h-128v-256h-192zM744.726 488.728l-71.74-71.742 260.080-96.986-421.066-157.018-421.066 157.018 260.080 96.986-71.742 71.742-279.272-104.728v-256l512-192 512 192v256z"></path></svg></th> \t\t\t\t         <th class="remark">备注</th></tr> \t\t\t\t  </table><br /> \t\t\t\t</div>');if(n.extra)n.extra();if(!n.table)n.table=i;t.aspect.manage.th_fill($(s+" table.kc-manage-list th.remark"),n.table);if(n.select){n.select()}else{t.aspect.manage.selectClassifyRefresh($(s+" select.s1"),n.table,"aan");t.aspect.manage.selectClassifyRefresh($(s+" select.s2"),n.table,"ban")}if(n.create==="noop"){$(s+" div.kc-manage-box section.func-a span.create").remove()}else{if(n.create){$(s+" div.kc-manage-box section.func-a span.create").click(n.create)}else{$(s+" div.kc-manage-box section.func-a span.create").click(function(){kaidanbao.aspect.manage.create(n.table)})}}if(n.classify==="noop"){$(s+" div.kc-manage-box section.func-a span.classify").remove()}else{if(n.classify){n.classify()}else{$(s+" div.kc-manage-box section.func-a span.classify").click(function(){var e,i=t.cache.setup(n.table+"_classify");$.facebox('<div class="classify"> \t\t\t\t\t\t\t<fieldset> \t\t\t\t              <legend>类型</legend> \t\t\t\t\t\t\t  <input /><input /><input /><input /> \t\t\t\t\t\t\t  <input /><input /><input /><input /> \t\t\t\t\t\t\t  <input /><input /><input /><input /> \t\t\t\t\t\t\t</fieldset> \t\t\t\t\t\t\t<fieldset style="margin-left:10px;"> \t\t\t\t              <legend>类别</legend> \t\t\t\t\t\t\t  <input /><input /><input /><input /> \t\t\t\t\t\t\t  <input /><input /><input /><input /> \t\t\t\t\t\t\t  <input /><input /><input /><input /> \t\t\t\t\t\t\t</fieldset></div>');$("#facebox div.title").html(t.conf.table[n.table]["cn"]+"分类管理");$("#facebox div.footer").html('<button class="ensure">保存分类</button>');if(i){for(e in i.value){$("#facebox div.classify fieldset:eq("+(e[0]=="a"?0:1)+") input").eq(e.substring(1)).val(i.value[e].v).attr("placeholder",i.value[e].old||"")}}$("#facebox div.footer .ensure").click(function(){var e=$("#facebox div.classify fieldset:eq(0) input");var a=$("#facebox div.classify fieldset:eq(1) input");var s=i.value||{};for(var c=0;c<12;c++){if(!s["a"+c])s["a"+c]={};s["a"+c].v=e.eq(c).val();if(e.eq(c).val())s["a"+c].old=e.eq(c).val();if(!s["b"+c])s["b"+c]={};s["b"+c].v=a.eq(c).val();if(a.eq(c).val())s["b"+c].old=a.eq(c).val()}if(i){t.dao.updOne({tn:"setup",_id:i._id,value:s})}else{t.dao.addOne({type:n.table+"_classify",tn:"setup",value:s})}})})}}var c=$(s+" div.kc-manage-box button.s-btn");var o=$(s+" div.kc-manage-box select.s1");var l=$(s+" div.kc-manage-box select.s2");var r=$(s+" .kc-manage-box input.s-input");$(s+" div.kc-manage-box button.s-btn").click(function(e){if(n.search){n.search()}else{t.aspect.manage.search({box:s,table:n.table,notice:n.notice,count:n.count,modify_name:n.modify_name})}});o.change(function(t){c.click()});l.change(function(t){c.click()});c.click();$(s+" svg.down").click(function(){e.file.tableToExcel("<table>"+$(s+" table.kc-manage-list").html()+"</table>",$("div.lay-left:not([hidden]) li.selected a").html()+"-"+$(s+" div.kc-manage-box select.s1 option:selected").html().replace("&lt;","[").replace("&gt;","]")+"-"+$(s+" div.kc-manage-box select.s2 option:selected").html().replace("&lt;","[").replace("&gt;","]")+(r.val()?"-"+r.val():""))})}}})(window.kaidanbao);(function(t){var e=t.utils;var n;var i=function(){$("#print td.color").html($("#print td.color").html()+"（开单宝：www.kaidan.me）")};var a=function(t){if(!n){if(window.getCLodop&&typeof window.getCLodop=="function"){n=window.getCLodop();n.SET_LICENSES("","BFEED6994BBE99CEEC3AEFCA727BD890","C94CEE276DB2187AE6B65D56B3FC2848","")}}if(n){n.PRINT_INIT("kdb2_print");n.SET_PRINT_PAGESIZE(1,2100,1400,"");n.ADD_PRINT_HTM("1mm","1mm","100%","100%",document.getElementById("print").innerHTML);if(t)n.PRINTA();else n.PRINT();return true}};var s=function(n,i){if(n&&n.payamount)i="定金："+n.payamount+" 元";var a=(n||{}).tn||t.frame.current_plugin,s="#layout div."+a;var c,o="开单宝有限公司销售单",l="主营：T5/T8日光灯外壳配件及支架、铝基板、成品。地址：古镇曹一乐昌西路18号。QQ：12345678901234567<br />电话：0760-23661072，18898484018。古镇农行账户：6228480108990910078 王伟",r="注：以上货物当面点清，签字即视为结算凭证；对质量有意见请在7天内提出书面异议，过期视为默认。",u="（白单存根，红单客户，蓝单回单，黄单结款）";if(n){c=t.cache.setup(n.tn+"-print")}else{if(a==="salebilling")c=t.cache.setup("salebill-print");else if(a==="bringbilling")c=t.cache.setup("bringbill-print")}if(c){o=c.title;l=c.tips;r=c.notice;u=c.color}var d=0,p='<div class="tit" contenteditable="true">'+o+'</div> \t\t<div style="text-align:left;" class="tips" spellcheck="false" contenteditable="true">'+l+'</div> \t\t<table><tr><td colspan="7" class="top">';if(a==="salebilling"||a==="salebill"){p+="<div>客户："+(n?t.cache.get(n.customer_id).name:$(s+" input.customer").val())+"</div> \t\t\t<div>销售员："+(n?t.cache.get(n.saler_id).name||"":$(s+" input.saler").val())+"</div>"}if(a==="bringbilling"||a==="bringbill"){p+="<div>供应商："+(n?t.cache.get(n.supplier_id).name:$(s+" input.supplier").val())+"</div> \t\t\t<div>采购员："+(n?t.cache.get(n.buyer_id).name||"":$(s+" input.buyer").val())+"</div>"}p+="<div>单号："+(n?n.number:$(s+" input.number").val())+"</div><tr><th>商品名称</th><th>规格</th><th>单位</th><th>数量</th><th>售价</th><th>金额</th><th>备注</th></tr>";for(d=0;d<9;d++){if(!n||n&&n.detail[d]){p+='<tr> \t\t\t\t\t<td class="name">'+(n?t.cache.get(n.detail[d][0]).name||t.cache.get(n.detail[d][0]).number:$(s+" td.p_name input").eq(d).val())+'</td> \t\t\t\t\t<td class="spec">'+(n?n.detail[d][1]:$(s+" td.p_spec").eq(d).html())+'</td> \t\t\t\t\t<td class="unit">'+(n?t.cache.get(n.detail[d][0]).unit||"":$(s+" td.p_unit").eq(d).html())+'</td> \t\t\t\t\t<td class="count">'+(n?n.detail[d][2]:$(s+" td.count").eq(d).html())+'</td> \t\t\t\t\t<td class="price">'+(n?n.detail[d][3]:$(s+" td.p_price").eq(d).html())+'</td> \t\t\t\t\t<td class="amount">'+(n?n.detail[d][4]:$(s+" td.amount").eq(d).html())+'</td> \t\t\t\t\t<td class="remark">'+(n?n.detail[d][5]:$(s+" td.remark").eq(d).html())+"</td></tr>"}else{p+='<tr><td class="name"></td><td class="spec"></td> \t\t\t\t\t<td class="unit"></td><td class="count"></td><td class="price"></td> \t\t\t\t\t<td class="amount"></td><td class="remark"></td></tr>'}}p+='<tr><td colspan="3" class="dx">'+(n?"合计："+e.DX(n.amount):$(s+" td.dx").html())+'</td> \t\t<td class="count-sum">'+(n?n.count:$(s+" td.count-sum").html())+'</td> \t\t<td></td><td class="amount-sum">'+(n?n.amount:$(s+" td.amount-sum").html())+'</td><td class="remark">'+(i||"")+'</td></tr> \t\t<tr><td colspan="7" class="notice" contenteditable="true">'+r+'</td></tr> \t\t<tr><td colspan="7" class="color" contenteditable="true">'+u+'</td></tr></table> \t\t<div style="text-align:left;" class="man"> \t\t<div>开单员：'+(n?t.cache.get(n.order_id).name||"":$(s+" input.order").val())+"</div> \t\t<div>出纳员："+(n?t.cache.get(n.cashier_id).name||"":$(s+" input.cashier").val())+"</div> \t\t<div>送货经手人：</div> \t\t<div>收货经手人：</div> \t\t</div>";$("#print div.print").html(p);var f="202mm",h="4mm";$("#print td,#print th").css("height","6mm").css("text-align","center").css("border","1px solid #000").css("padding","0.3mm 1mm");$("#print th").css("font-weight","normal");$("#print table").css("width",f).css("border-collapse","collapse");$("#print td.top div").css("width","33%").css("float","left");$("#print td.top,#print td.color,#print td.notice").css("text-align","left");$("#print .print").find("*").css("font-size",h).css("font-family","宋体").css("line-height","1");$("#print td.name").css("width","60mm").css("text-align","left");$("#print td.spec").css("width","15mm");$("#print td.unit").css("width","10mm");$("#print td.count").css("width","15mm");$("#print td.price").css("width","15mm");$("#print td.amount").css("width","20mm");$("#print td.remark").css("width","60mm").css("text-align","left");$("#print td.dx").css("text-align","left");$("#print .print > div").css("width",f).css("float","left");$("#print div.tit").css("margin-bottom","2mm").css("font-size","8mm").css("text-align","center").css("letter-spacing","1mm").css("font-family","Microsoft Yahei").css("font-weight","bold");$("#print div.tips").css("margin-bottom","2mm");$("#print div.man").css("margin-top","2mm");$("#print div.man div").css("width","23%").css("float","left")};t.aspect.print={ad:i,prepare:s,act:a,facebox:function(t){$.facebox.close();setTimeout(function(){i();a(t)},600)}}})(window.kaidanbao);(function(t){var e=t.utils;var n=t.plugin})(window.kaidanbao);(function(t){var e=t.utils;var n=t.plugin;n.statement={view_bill:function(e,n){t.dao.get(e||"salebill",n,function(e){if(!e)return;t.aspect.print.prepare(e);t.aspect.noty.confirm($("#print").html(),function(){t.aspect.noty.confirm_close()},true,0,"770px")})},view:function(n){var i=t.cache.get(n),a,s=0,c=0,o,l,r,u=[],d="a",p="s",f;var h=function(){s=0;c=0;var e='<tr><th class="chk" title="全选"><input data-bid="bid" type="checkbox" id="checkbox_a" hidden '+(p==="s"?"":'disabled="disabled"')+' class="chk_1 first" /><label for="checkbox_a"></label></th><th>订单号</th><th>总额</th><th>已付</th><th>状态</th></tr>';for(j in t.cache.dates.mt){r="s"+t.cache.dates.mt[j];if(d==="a"||d===r){if(i[r]&&i[r]!=="x"){for(var n in i[r]){a=i[r][n];if(a[3]!=="x"){e+="<tr"+(s%2?' class="opp"':"")+'><td class="chk"><input data-bid="'+n+'" type="checkbox" id="checkbox_a'+ ++s+'" hidden class="chk_1 list" /><label for="checkbox_a'+s+'"></label></td><td><span onclick="kaidanbao.plugin.statement.view_bill(null,'+n.substring(1)+')">'+a[0]+"</span></td><td>"+a[1]+"</td><td>"+(a[2]||0)+"</td><td>未结清</td></tr>";if(a[3]!=="d")c+=a[1];if(a[2])c-=a[2]}}u.push(r)}}}return e};$.facebox('<table class="list">'+h()+'</table><table class="fix"> \t\t\t\t\t<tr><td>选择订单：</td><td class="count">0 / '+s+'</td><td>收款金额：</td><td><input class="amount" placeholder="'+c.toFixed(2)+'" /></td><td>出纳员：</td><td><input class="cashier" type="search" /></td></tr> \t\t\t\t\t<tr><td>收款账户：</td><td><select class="account"></select></td><td>对账月份：</td><td><select class="month"><option value="a">所有月份</option></select></td> \t\t\t\t\t<td>操作类型：</td><td><select class="type"><option value="s">选择结清</option><option value="z">追加定金</option></select></td></tr><table>');$("#facebox div.title").html('客户对账单：<span style="color:#078;">'+i.name+" ￥"+c.toFixed(2)+"</span>");$("#facebox div.footer").html('<button class="ensure">确认收款</button>');$("#facebox div.footer .ensure").click(function(){var n=$("#facebox input.amount").val().trim();if(!e.is_float(n)){t.aspect.noty.message("收款金额格式错误！");return}n=parseFloat(n);if(n==0){t.aspect.noty.message("收款金额不能为零！");return}if(!$("#facebox input.cashier").attr("data-id")){t.aspect.noty.message("出纳员不能为空！");return}var a={},s=$("#facebox select.month").val();$("#facebox input.list").each(function(t){if($("#facebox input.list").eq(t).prop("checked")){a[$("#facebox input.list").eq(t).attr("data-bid")]=1}});if($("#facebox td.count").html()[0]=="0"){t.aspect.noty.message("未选择任何订单！");return}var c={tn:i.tn,_id:i._id},o={};for(var l=0;l<24;l++){r="s"+t.cache.dates.mt[24-l-1];o[r]={};if(i[r]&&i[r]!=="x"){if(s==="a"||s===r){if(p==="s"){o[r]["nonechecked"]=true;o[r]["allchecked"]=true;for(var u in i[r]){if(a[u]){if(o[r]["nonechecked"])c[r]=i[r];o[r]["nonechecked"]=false;c[r][u][3]="x"}else{if(i[r][u][3]!=="x")o[r]["allchecked"]=false}}if(o[r]["allchecked"]&&l<23){c[r]="x"}}else{for(var u in i[r]){if(a[u]){c[r]=i[r];c[r][u][2]=c[r][u][2]||0;c[r][u][2]+=parseFloat($("#facebox input.amount").val().trim());f=c[r][u][0];break}}}}}}t.dao.updOne(c,function(e,a){if(a){t.aspect.noty.message("收款成功！");$.facebox.close();$("#layout div.statement div.kc-manage-box button").click();var s={tn:"moneyflow"};s.amount=n;s.cashier_id=parseInt($("#facebox input.cashier").attr("data-id"));if(i.tn==="customer"){s.account_r=parseInt($("#facebox select.account").val());s.type="xs";s.aper_id=i._id}else{s.account_p=parseInt($("#facebox select.account").val());s.type="cg";s.arer_id=i._id}s.number="CN-"+t.aspect.manage.get_number();if(p==="z"){s.type="z";s.bill_number=f}t.dao.addOne(s)}})});t.aspect.manage.selectAccountRefresh($("#facebox select.account"));for(var s in u){$("#facebox select.month").append('<option value="'+u[s]+'">'+u[s].replace("s","20")+"</option>")}var g=function(){d=$("#facebox select.month").val();$("#facebox table.list").html(h());$("#facebox td.count").html("0 / "+s);$("#facebox input.amount").val("");$("#facebox input.first").change(function(){var t=$("#facebox input.first").prop("checked");if(t){$("#facebox input.first").next().css("background-color","#e7eff5");$("#facebox td.count").html(s+" / "+s);$("#facebox input.amount").val(c.toFixed(2))}else{$("#facebox input.first").next().css("background-color","#fff");$("#facebox td.count").html("0 / "+s);$("#facebox input.amount").val("")}$("#facebox input.list").prop("checked",t)});$("#facebox input.list").change(function(){if(p==="s"){o=0;l=0;$("#facebox input.list").each(function(t){if($("#facebox input.list").eq(t).prop("checked")){o++;var e=$("#facebox table.list tr:eq("+(t+1)+") td:eq(2)").html();var n=$("#facebox table.list tr:eq("+(t+1)+") td:eq(3)").html();l+=parseFloat(e)-parseFloat(n)}});if($("#facebox input.first").prop("checked")&&o!==s){$("#facebox input.first").next().css("background-color","#fff")}$("#facebox td.count").html(o+" / "+s);$("#facebox input.amount").val(l?l.toFixed(2):"")}else{$("#facebox input.list").each(function(t){$("#facebox input.list").eq(t).prop("checked",false)});$(this).prop("checked",true);$("#facebox td.count").html("1 / "+s)}})};$("#facebox input.cashier").autocomplete({minChars:0,lookup:t.aspect.atcp.auto(null,"clerk"),onSelect:function(e){$(this).val(t.cache.get(e.data.id).name);$(this).attr("data-id",e.data.id)},onSearchComplete:function(t,e){$(this).removeAttr("data-id")}});$("#facebox select.month").change(g);$("#facebox select.type").change(function(){p=$(this).val();if(p==="s"){$("#facebox th.chk input").removeAttr("disabled")}else{$("#facebox input.first").prop("checked",false).attr("disabled","disabled");$("#facebox input.first").next().css("background-color","#fff");$("#facebox td.count").html("0 / "+s);$("#facebox input.amount").val(0);$("#facebox input.list").each(function(t){$("#facebox input.list").eq(t).prop("checked",false)})}});g()},release:function(){$("#layout div.statement table.kc-manage-list tr.list").remove()},reload:function(){$("#layout div.statement button.s-btn").click()},init:function(){var n=0,i="#layout div.statement";t.aspect.manage.init({create:"noop",classify:"noop",search:function(){$(i+" table.kc-manage-list tr.list").remove();var n,a,s,c,o,l={},r,u={},d={},p,f=0,h=0,g,m,b=0,v=0,y={};var x=$(i+" select.s1").val();for(n in t.cache.fixed_page[x]){c=0;r=0;p=0;if(y["i"+t.cache.fixed_page[x][n]])continue;else y["i"+t.cache.fixed_page[x][n]]=1;o=t.cache.get(t.cache.fixed_page[x][n]);l["i"+o._id]={},d["i"+o._id]={},u["i"+o._id]={};for(a in t.cache.dates.mt){g="s"+t.cache.dates.mt[a];if(o[g]&&o[g]!=="x"){l["i"+o._id][g]=0,d["i"+o._id][g]=0,u["i"+o._id][g]=0;for(m in o[g]){if(o[g][m][3]!=="x"){r+=parseFloat(o[g][m][1])-parseFloat(o[g][m][2]||0);p+=1;l["i"+o._id][g]+=parseFloat(o[g][m][1]);d["i"+o._id][g]+=parseFloat(o[g][m][2]||0);u["i"+o._id][g]+=1}}if(u["i"+o._id][g]>0)c++}}o.len=c;o.count=p;o.amount=r}y={};var _=$(i+" th.sort.asc").attr("data-sort");var k=$(i+" th.sort.desc").attr("data-sort");if(_){t.cache.fixed_page[x].sort(function(e,n){return t.cache.get(e)[_]<t.cache.get(n)[_]?1:-1})}else if(k){t.cache.fixed_page[x].sort(function(e,n){return t.cache.get(e)[k]>t.cache.get(n)[k]?1:-1})}for(n in t.cache.fixed_page[x]){if(y["i"+t.cache.fixed_page[x][n]])continue;else y["i"+t.cache.fixed_page[x][n]]=1;o=t.cache.get(t.cache.fixed_page[x][n]);if(o.len==0)continue;b++;f+=o.count;h+=o.amount;s='</td><td rowspan="'+o.len+'"><span title="查看" onclick="kaidanbao.plugin.statement.view('+o._id+')">'+t.cache.get(o._id).name+'</span></td><td rowspan="'+o.len+'">'+o.count+'</td><td rowspan="'+o.len+'">'+o.amount.toFixed(2)+'</td><td rowspan="'+o.len+'">'+e.date.getTimeFormat(o.lm,"d");for(a in t.cache.dates.mt){g="s"+t.cache.dates.mt[a];if(o[g]&&o[g]!=="x"&&u["i"+o._id][g]>0){$(i+" table.kc-manage-list").append('<tr class="list '+(b%2===0?"opp":"")+'"><td>'+ ++v+s+"</td><td>"+t.cache.dates.m_t[a]+"</td><td>"+u["i"+o._id][g]+"</td><td>"+l["i"+o._id][g].toFixed(2)+"</td><td>"+d["i"+o._id][g].toFixed(2)+'</td><td class="remark"></td></tr>');s="";op=""}}}$(i+" section.summary-box").html("总计："+f+" 单，"+h.toFixed(2)+" 元")},select:function(){$(i+" select.s1").append('<option value="customer">客户对账</option><option value="supplier">供应商对账</option>');$(i+" select.s2").append("<option>所有月份</option>");$(i+" input").attr("placeholder","按客户名称搜索")}})}};n.moneyflow={insert:function(){var e=$("#facebox select.account-p").val(),n=$("#facebox select.account-r").val(),i=$("#facebox textarea.remark").val(),a=$("#facebox select.type").val(),s={tn:"moneyflow",number:$("#facebox input.number").val(),amount:$("#facebox input.amount").val(),cashier_id:$("#facebox input.cashier").attr("data-id"),type:a};if(i)s.remark=i;if(s.amount)s.amount=parseFloat(s.amount);if(a==="os"){s.account_r=n}else if(a==="gz"||a==="fz"||a==="sf"||a==="oz"){s.account_p=e}else if(a==="zz"){s.account_r=n;s.account_p=e}t.dao.addOne(s,function(){$.facebox.close();$("#layout div.moneyflow div.kc-manage-box button").click()})},create:function(){$.facebox(' \t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t<label>流水号：</label><input disabled="disabled" class="number" /></div> \t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t<label>类型：</label><select class="type"><option value="os">其他收入</option><option value="oz">其他支出</option><option value="zz">内部转账</option></select></div> \t\t\t\t<div class="fb-input-wrapper hide account-p" hidden> \t\t\t\t<label>付款账户：</label><select class="account-p account" /></div> \t\t\t\t<div class="fb-input-wrapper hide account-r"> \t\t\t\t<label>收款账户：</label><select class="account-r account" /></div> \t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t<label>金额：</label><input placeholder="必填" class="amount" /></div> \t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t<label>出纳员：</label><input type="search" placeholder="必填" class="cashier" /></div> \t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t<label>摘要：</label><textarea class="remark" maxlength="120"></textarea></div> \t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t<label>&nbsp;</label> \t\t\t\t<button onclick="kaidanbao.plugin.moneyflow.insert()">提交</button> \t\t\t</div>');$("#facebox div.title").html('<a href="#/fi/moneyflow">出纳流水</a> > 新增出纳信息');$("#facebox input.number").val("CN-"+t.aspect.manage.get_number());var e,n,i;$("#facebox select.type").change(function(t){e=$("#facebox select.type").val();$("#facebox div.hide").attr("hidden","hidden");if(e==="os"){$("#facebox div.account-r").removeAttr("hidden")}else if(e==="oz"){$("#facebox div.account-p").removeAttr("hidden")}else if(e==="zz"){$("#facebox div.account-p").removeAttr("hidden");$("#facebox div.account-r").removeAttr("hidden")}});$("#facebox input.cashier").autocomplete({minChars:0,lookup:t.aspect.atcp.auto(null,"clerk"),onSelect:function(e){$(this).val(t.cache.get(e.data.id).name);$(this).attr("data-id",e.data.id)},onSearchComplete:function(t,e){$(this).removeAttr("data-id")}});t.aspect.manage.selectAccountRefresh($("#facebox select.account"))},release:function(){$("#layout div.moneyflow table.kc-manage-list tr.list").remove()},reload:function(){$("#layout div.moneyflow button.s-btn").click()},init:function(){var e=0,n="#layout div.moneyflow";t.aspect.manage.init({create:kaidanbao.plugin.moneyflow.create,classify:"noop",search:function(){e=0;$(n+" table.kc-manage-list tr.list").remove();$(n+" table.kc-manage-list th.remark").html("摘要");$(n+" input").attr("placeholder","搜索流水号、收款方、付款方、出纳员");var i=$(n+" select.s1").val(),a=0,s=0;var c=$(n+" select.s2").val();t.dao.queryDynamicByMonth("moneyflow",c,function(e){if(e){var i=t.cache.dynamic["moneyflow"][c],o;for(var l in i){o=i[l];s+=o.amount;$(n+" table.kc-manage-list").append('<tr class="list '+(++a%2===0?"opp":"")+'"><td>'+a+"</td><td>"+o.number+"</td><td>"+(o.aper_id?t.cache.get(o.aper_id).name:o.type!=="xs"&&o.type!=="os"||o.type==="zz"?"[ "+(o.account_p?t.cache.get(o.account_p).name:"")+" ]":"")+"</td><td>"+(o.arer_id?t.cache.get(o.arer_id).name:o.type==="xs"||o.type==="os"||o.type==="zz"?"[ "+(o.account_r?t.cache.get(o.account_r).name:"")+" ]":"")+"</td><td>"+t.cache.get(o.cashier_id).name+"</td><td>"+o.amount+"</td><td>"+o.type+'</td><td class="remark">'+(o.remark||"")+"</td></tr>")}$(n+" section.summary-box").html("总计 "+a+" 条流水，总金额 "+s.toFixed(2)+" 元")}})},select:function(){$(n+" select.s1").append('<option value="a"><所有类型></option>');for(var e in t.cache.dates.m_t){if(e<=t.cache.sign.month_length)$(n+" select.s2").append("<option>"+t.cache.dates.m_t[e]+"</option>")}}})}}})(window.kaidanbao);(function(t){var e=t.utils;var n=t.plugin;var i=false;n.welcome={init:function(){var e="#layout div.lay-main .welcome";$("#layout div.lay-main").append(' \t\t\t\t<div hidden class="welcome"> \t\t\t\t\t<div class="pan-box chart-box"> \t\t\t\t\t\t<div class="title">欢迎使用开单宝！惜时光，演绎精彩生活。</div> \t\t\t\t\t\t<div class="content"> \t\t\t\t\t\t</div> \t\t\t\t\t</div> \t\t\t\t\t<div class="pan-box list-box"> \t\t\t\t\t\t<div class="title">在线用户</div> \t\t\t\t\t\t<div class="content"> \t\t\t\t\t<table><th class="printer" title="打印机"> \t\t\t\t\t<svg version="1.1" viewBox="0 -70 1034 1034"><path d="M256 896h512v-128h-512v128zM960 704h-896c-35.2 0-64-28.8-64-64v-320c0-35.2 28.794-64 64-64h192v-256h512v256h192c35.2 0 64 28.8 64 64v320c0 35.2-28.8 64-64 64zM128 512c-35.346 0-64 28.654-64 64s28.654 64 64 64 64-28.654 64-64-28.652-64-64-64zM704 64h-384v320h384v-320z"></path></svg> \t\t\t\t\t</th><th>用户</th></tr> \t\t\t\t\t<tr><td><input name="Fruit" type="radio" value="" /></td><td>lulu</td></tr> \t\t\t\t\t<tr><td><input name="Fruit" type="radio" value="" /></td><td>jinhui-fingal</td></tr> \t\t\t\t\t<tr><td><input name="Fruit" type="radio" value="" /></td><td>jinhui-kaidanbao</td></tr> \t\t\t\t\t</table>\t\t\t\t\t\t</div> \t\t\t\t\t</div> \t\t\t\t\t<div class="pan-box note-box"> \t\t\t\t\t\t<div class="title">登录信息</div> \t\t\t\t\t\t<div class="content"> \t\t\t\t\t\t</div> \t\t\t\t\t</div> \t\t\t\t\t<div class="pan-box note-box"> \t\t\t\t\t\t<div class="title">服务信息</div> \t\t\t\t\t\t<div class="content"> \t\t\t\t\t\t</div> \t\t\t\t\t</div> \t\t\t\t\t<div class="pan-box note-box"> \t\t\t\t\t\t<div class="title">全屏</div> \t\t\t\t\t\t<svg class="full" version="1.1" viewBox="0 -70 1034 1034"><path d="M1024 960h-416l160-160-192-192 96-96 192 192 160-160zM1024-64v416l-160-160-192 192-96-96 192-192-160-160zM0-64h416l-160 160 192 192-96 96-192-192-160 160zM0 960v-416l160 160 192-192 96 96-192 192 160 160z"></path></svg> \t\t\t\t\t\t<svg hidden class="small" version="1.1" viewBox="0 -70 1034 1034"><path d="M576 512h416l-160 160 192 192-96 96-192-192-160 160zM576 384v-416l160 160 192-192 96 96-192 192 160 160zM448 384.004h-416l160-160-192-192 96-96 192 192 160-160zM448 512v416l-160-160-192 192-96-96 192-192-160-160z"></path></svg> \t\t\t\t\t</div> \t\t\t\t\t<div class="pan-box note-box"> \t\t\t\t\t\t<div class="title">安全退出</div> \t\t\t\t\t\t<svg class="exit" version="1.1" viewBox="0 -70 1034 1034"><path d="M640 813.412v-135.958c36.206-15.804 69.5-38.408 98.274-67.18 60.442-60.44 93.726-140.8 93.726-226.274s-33.286-165.834-93.726-226.274c-60.44-60.44-140.798-93.726-226.274-93.726s-165.834 33.286-226.274 93.726c-60.44 60.44-93.726 140.8-93.726 226.274s33.286 165.834 93.726 226.274c28.774 28.774 62.068 51.378 98.274 67.182v135.956c-185.048-55.080-320-226.472-320-429.412 0-247.424 200.578-448 448-448 247.424 0 448 200.576 448 448 0 202.94-134.95 374.332-320 429.412zM448 960h128v-512h-128z"></path></svg> \t\t\t\t\t</div> \t\t\t\t\t<div class="pan-box note-box"> \t\t\t\t\t\t<div class="title">微信号</div> \t\t\t\t\t\t<img src="/image/vx.jpg" title="公众号：kaidanme"> \t\t\t\t\t</div> \t\t\t\t\t<div hidden class="pan-box note-box"> \t\t\t\t\t\t<div class="title">通知公告</div> \t\t\t\t\t</div> \t\t\t\t</div>');$(e+" svg.full").click(function(){var t=document.documentElement;if(t.requestFullscreen){t.requestFullscreen()}else if(t.mozRequestFullScreen){t.mozRequestFullScreen()}else if(t.webkitRequestFullScreen){t.webkitRequestFullScreen()}else if(elem.msRequestFullscreen){elem.msRequestFullscreen()}$(this).attr("hidden","hidden");$(e+" svg.small").removeAttr("hidden")});$(e+" svg.small").click(function(){if(document.exitFullscreen){document.exitFullscreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.webkitCancelFullScreen){document.webkitCancelFullScreen()}else if(document.msExitFullscreen){document.msExitFullscreen()}$(this).attr("hidden","hidden");$(e+" svg.full").removeAttr("hidden")});$(e+" svg.exit").click(function(){t.aspect.noty.confirm("<br /><h1>确定退出？</h1>",function(){window.location.href="./"})});$(e+" .note-box:eq(0) .content").html(navigator.userAgent)}};n.usercenter={roll:{upset:function(e){var n="",i=0,a=0;var s=t.conf.frame;var c=s["p"],o,l,r,u,d,p,f;for(r=1;r<c.length;r++){if(c[r]["sol"].length===0)continue;p=c[r]["en"];f=c[r]["cn"];n+="<tr"+(i++%2?"":' class="opp"')+'><td class="grey" rowspan="'+c[r]["sol"].length+'">'+f+'</td><td class="grey">'+c[r]["sol"][0]["cn"]+"</td>";o=c[r]["sol"];for(u=0;u<o.length;u++){if(u>0)n+="<tr"+(i++%2?"":' class="opp"')+'><td class="grey">'+c[r]["sol"][u]["cn"]+"</td>";l=o[u]["plug"];for(d=0;d<l.length;d++){n+='<td><input data-pn="'+l[d]["en"]+'" type="checkbox" id="checkbox_a'+ ++a+'" hidden class="chk_1 '+l[d]["en"]+'" /><label for="checkbox_a'+a+'"></label>'+l[d]["cn"]+"</td>"}n+="</tr>"}}$.facebox('名称：<input class="name" style="width:100px;" />，说明：<input class="remark" style="width:200px;" /><br /><br /><table class="frame">'+n+"</table>");$("#facebox div.footer").html('<button class="ensure">确定</button>');var h=t.cache.setup("roll"),g=h.value;if(e){$("#facebox div.title").html("修改角色");var m=h["r"+e].plugin;$("#facebox input.chk_1").each(function(t){if(m[$("#facebox input.chk_1").eq(t).attr("data-pn")])$("#facebox input.chk_1").eq(t).prop("checked","checked")});$("#facebox input.name").val(h["r"+e].name);$("#facebox input.remark").val(h["r"+e].remark)}else{$("#facebox div.title").html("新增角色");g+=1;e=h.value}$("#facebox div.footer .ensure").click(function(){var n={};var i=$("#facebox input.name").val().trim();if(!i){t.aspect.noty.message("角色名称不能为空");return}$("#facebox input.chk_1").each(function(t){if($("#facebox input.chk_1").eq(t).prop("checked")){n[$("#facebox input.chk_1").eq(t).attr("data-pn")]=1}});var a={_id:h._id,value:g,tn:"setup"};a["r"+e]={name:$("#facebox input.name").val(),remark:$("#facebox input.remark").val(),plugin:n};t.dao.updOne(a,function(){$.facebox.close();window.kaidanbao.plugin.usercenter.roll.load()})})},load:function(){var e="#layout div.usercenter";var n=t.cache.setup("roll");$(e+" .roll-box .content").html("<table><tr><th>名称</th><th>说明</th></tr></table>");for(var i=0;i<n.value;i++){var a=n["r"+i].name;if(!n["r"+i].f){a='<span onclick="kaidanbao.plugin.usercenter.roll.upset('+i+');">'+a+"</span>"}$(e+" .roll-box table").append("<tr><td>"+a+"</td><td>"+n["r"+i].remark+"</td></tr>")}}},inc:{load:function(){var n=t.cache.sign.user;$("#layout div.usercenter .inc-info .content").html("<span onclick=\"kaidanbao.plugin.usercenter.inc.change('inc');\">公司简称</span>："+n.inc+"<br />"+"<span onclick=\"kaidanbao.plugin.usercenter.inc.change('mobile');\">安全电话</span>："+(n.safe_mobile||"")+"<br />"+"注册日期："+e.date.getTimeFormat(n.ct,"d")+"<br />")},update:function(n){var a=t.cache.sign.user;var s={_id:a._id};if(n=="inc"){var c=$("#facebox input.inc").val().trim();if(!e.valid_hanname(c))return;s.inc=c}else if(n=="mobile"){var o=$("#facebox input.mobile").val().trim();var l=$("#facebox input.code").val().trim();var r=$("#facebox input.password").val();var u=t.safe.local_pwd(r);var d=t.cache.local()["lp"+a["staff"+t.cache.sign.staff_id].loginname];if(!e.valid_mobile(o))return;if(u!=d){t.aspect.noty.message("密码错误！");return}if(i&&!l){t.aspect.noty.message("验证码不能为空！");return}s.safe_mobile=o;s.code=parseInt(l);
}t.net.api("/manage/upduser",s,function(e,n){if(n){if(n.obj.mobile){i=true;t.aspect.noty.message("已发短信至:"+n.obj.mobile);$("#facebox button.send-msg").html("已发送").attr("disabled","disabled")}else{if(c)window.kaidanbao.plugin.loading.change_inc(c);a.safe_mobile=o;window.kaidanbao.plugin.usercenter.inc.load();t.aspect.noty.message("操作成功！");$.facebox.close()}}})},change:function(e){var n=t.cache.sign.user;$.facebox('<br /><div class="fb-input-wrapper inc" hidden> \t\t\t\t\t\t<label>公司简称：</label> \t\t\t\t\t\t<input class="inc" maxlength="8" value="'+(n.inc||"")+'" /></div> \t\t\t\t\t\t<div class="fb-input-wrapper mobile" hidden> \t\t\t\t\t\t<label>旧手机号码：</label> \t\t\t\t\t\t<input disabled="disabled" maxlength="11" value="'+(n.safe_mobile||"(无)")+'" /></div> \t\t\t\t\t\t<div class="fb-input-wrapper mobile" hidden> \t\t\t\t\t\t<label>新手机号码：</label> \t\t\t\t\t\t<input class="mobile" maxlength="11" /></div> \t\t\t\t\t\t<div class="fb-input-wrapper mobile" hidden> \t\t\t\t\t\t<label>短信验证码：</label> \t\t\t\t\t\t<input class="code" maxlength="4" style="width:120px;" /><button style="padding:5px;margin-left:2px;" onclick="kaidanbao.plugin.usercenter.inc.update(\''+e+'\');" class="send-msg">发短信</button></div> \t\t\t\t\t\t<div class="fb-input-wrapper mobile" hidden> \t\t\t\t\t\t<label>登录密码：</label> \t\t\t\t\t\t<input class="password" type="password" /></div> \t\t\t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t\t\t<label>&nbsp;</label> \t\t\t\t\t\t<button onclick="kaidanbao.plugin.usercenter.inc.update(\''+e+"');\">提交</button> \t\t\t\t\t\t</div>");$("#facebox div."+e).removeAttr("hidden");if(e=="inc"){$("#facebox div.title").html("修改公司名称")}else if(e=="mobile"){$("#facebox div.title").html("修改手机号码")}}},staff:{load:function(){var e=t.cache.sign.user["staff"+t.cache.sign.staff_id];var n=t.cache.setup("roll");$("#layout div.usercenter .staff-info .content").html("<span onclick=\"kaidanbao.plugin.usercenter.staff.change('loginname');\">登录账号</span>："+e.loginname+"<br />"+"<span onclick=\"kaidanbao.plugin.usercenter.staff.change('login-pwd');\">登录密码</span>：******<br />"+'<span class="setnick" onclick="kaidanbao.plugin.usercenter.staff.change(\'nick\');">用户昵称</span>：'+(e.nick||"")+"<br />"+"用户角色："+n[""+(e.roll||"r0")].name+"<br />"+"用户状态：正常<br />"+"到期日期："+e.due+"<br />");if(!e.nick){$("#layout div.usercenter .staff-info span.setnick").click()}},renewpay:function(){var e=t.cache.sign.user,n=e["staff"+t.cache.sign.staff_id];t.aspect.pay({url:"/manage/renewal",param:{loginname:n.loginname}},function(e){t.aspect.noty.confirm_close();t.aspect.noty.message("续期成功！");n.due=e.obj.due;$.facebox.close();window.kaidanbao.plugin.usercenter.staff.load();window.kaidanbao.plugin.usercenter.stafflist.load()})},renewal:function(){var n=t.cache.sign.user,i=n["staff"+t.cache.sign.staff_id];$.facebox('<br /><div class="fb-input-wrapper"> \t\t\t\t\t\t<label>用户名称：</label> \t\t\t\t\t\t<input class="inc" disabled="disabled" value="'+(i.nick||i.loginname)+'" /></div> \t\t\t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t\t\t<label>当前有效期至：</label> \t\t\t\t\t\t<input class="inc" disabled="disabled" value="'+i.due+'" /></div> \t\t\t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t\t\t<label>续后有效期至：</label> \t\t\t\t\t\t<input class="inc" disabled="disabled" value="'+e.date.getDay(366,i.due)+'" /></div> \t\t\t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t\t\t<label>&nbsp;</label> \t\t\t\t\t\t<button onclick="kaidanbao.plugin.usercenter.staff.renewpay();">付款</button> \t\t\t\t\t\t</div>');$("#facebox div.title").html("用户续费")},update:function(n){var i=t.cache.sign.user["staff"+t.cache.sign.staff_id];var a={_id:i._id};if(n=="loginname"){a.loginname=$("#facebox input.loginname").val().trim();if(!e.valid_loginname(a.loginname))return;if(a.loginname==i.loginname)return}else if(n=="login-pwd"){var s=$("#facebox input.oldpwd").val();var c=$("#facebox input.newpwd").val();var o=$("#facebox input.newpwd1").val();var l=t.safe.local_pwd(s);var r=t.safe.local_pwd(c);var u=t.cache.local();if(l!=u["lp"+u.ln]){t.aspect.noty.message("旧密码错误！");return}if(c!=o){t.aspect.noty.message("新密码不一致！");return}a.password=t.safe.up_pwd(r,c);a.old_pwd=t.safe.up_pwd(l,s)}else if(n=="nick"){a.nick=$("#facebox input.nick").val().trim();if(!e.valid_hanname(a.nick))return;if(a.nick==i.nick)return}if(a.nick){var d=e.pinyin.getSZM(a.nick);var p=t.cache.name_cache.clerk[a.nick];if(p){if(p==i.bind_clerk){$.facebox.close()}else{a.bind_clerk=p;t.net.api("/manage/updstaff",a,function(n,s){if(s){e.extend(i,a,true);window.kaidanbao.plugin.usercenter.staff.load();window.kaidanbao.plugin.usercenter.stafflist.load();$.facebox.close();t.dao.updOne({_id:p,tn:"clerk",number:t.cache.sign.staff_id,bind_si:t.cache.sign.staff_id})}})}}else{if(i.bind_clerk){t.net.api("/manage/updstaff",a,function(n,s){if(s){e.extend(i,a,true);window.kaidanbao.plugin.usercenter.staff.load();window.kaidanbao.plugin.usercenter.stafflist.load();$.facebox.close();t.dao.updOne({tn:"clerk",number:t.cache.sign.staff_id,_id:i.bind_clerk,name:a.nick,name_py:d})}})}else{t.dao.addOne({tn:"clerk",number:t.cache.sign.staff_id,bind_si:t.cache.sign.staff_id,name:a.nick,name_py:d},function(n,s){a.bind_clerk=s._id;t.net.api("/manage/updstaff",a,function(t,n){if(n){e.extend(i,a,true);window.kaidanbao.plugin.usercenter.staff.load();window.kaidanbao.plugin.usercenter.stafflist.load();$.facebox.close()}})})}}}else{t.net.api("/manage/updstaff",a,function(n,s){if(s){e.extend(i,a,true);var c=t.cache.local();if(a.loginname&&a.loginname!=c.ln){c["ll"+a.loginname]=c["ll"+c.ln];c["lp"+a.loginname]=c["lp"+c.ln];c["ui"+a.loginname]=c["ui"+c.ln];c["si"+a.loginname]=c["si"+c.ln];c["bi"+a.loginname]=c["bi"+c.ln];delete c["ll"+c.ln];delete c["lp"+c.ln];delete c["ui"+c.ln];delete c["si"+c.ln];delete c["bi"+c.ln];c.ln=a.loginname}if(a.password){c["lp"+c.ln]=r}t.cache.local(c);window.kaidanbao.plugin.usercenter.staff.load();$.facebox.close()}})}},change:function(e){var n=t.cache.sign.user["staff"+t.cache.sign.staff_id];$.facebox('<br /><div hidden class="fb-input-wrapper loginname"> \t\t\t\t\t\t<label>登录账号：</label> \t\t\t\t\t\t<input class="loginname" value="'+n.loginname+'" /></div> \t\t\t\t\t\t<div hidden class="fb-input-wrapper login-pwd"> \t\t\t\t\t\t<label>旧密码：</label> \t\t\t\t\t\t<input type="password" class="oldpwd" /></div> \t\t\t\t\t\t<div hidden class="fb-input-wrapper login-pwd"> \t\t\t\t\t\t<label>新密码：</label> \t\t\t\t\t\t<input type="password" class="newpwd" /></div> \t\t\t\t\t\t<div hidden class="fb-input-wrapper login-pwd"> \t\t\t\t\t\t<label>确认密码：</label> \t\t\t\t\t\t<input type="password" class="newpwd1" /></div> \t\t\t\t\t\t<div hidden class="fb-input-wrapper nick"> \t\t\t\t\t\t<label>用户昵称：</label> \t\t\t\t\t\t<input class="nick" value="'+(n.nick||"")+'" /></div> \t\t\t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t\t\t<label>&nbsp;</label> \t\t\t\t\t\t<button onclick="kaidanbao.plugin.usercenter.staff.update(\''+e+"');\">提交</button> \t\t\t\t\t\t</div>");$("#facebox div."+e).removeAttr("hidden");if(e=="loginname"){$("#facebox div.title").html("修改登录账号")}else if(e=="login-pwd"){$("#facebox div.title").html("修改登录密码")}else if(e=="nick"){$("#facebox div.title").html("修改用户昵称")}}},stafflist:{load:function(){var e=t.cache.sign.user,n=e.staff1;$("#layout div.usercenter .staff-list .content").html("<table><tr><th>序</th><th>用户</th><th>角色</th><th>状态</th></tr></table>");var i=t.cache.setup("roll");$("#layout div.usercenter .staff-list table").append("<tr><td>1</td><td>"+(n.nick||n.loginname)+"</td><td>"+i["r0"].name+"</td><td>正常</td></tr>");for(var a=2;a<=e.staff_len;a++){n=e["staff"+a];$("#layout div.usercenter .staff-list table").append("<tr><td>"+a+"</td><td><span>"+(n.nick||n.loginname)+"<span></td><td>"+i[n.roll||"r0"].name+"</td><td>正常</td></tr>")}},addpay:function(){var n=$("#facebox input.loginname").val().trim();var i=$("#facebox input.password").val().trim();var a=$("#facebox select.nick").val();if(!e.valid_loginname(n))return;if(!e.valid_password(i))return;t.net.api("/sign/checkloginname",{loginname:n},function(e,s){if(s){if(s&&s.obj.used){t.aspect.noty.message("用户名重复！");return}var c=t.safe.local_pwd(i);t.aspect.pay({url:"/manage/addstaff",param:{ui:t.cache.sign.user._id,loginname:n,password:t.safe.up_pwd(c,i),roll:a}},function(e){t.aspect.noty.confirm_close();t.aspect.noty.message("新增成功！");var n=e.obj;t.cache.sign.user["staff"+n.si]=n;t.cache.sign.user.staff_len=n.si;t.dao.put("sys",{id:"user",value:t.cache.sign.user});window.kaidanbao.plugin.usercenter.stafflist.load();$.facebox.close()})}},true)},addstaff:function(){$.facebox('<br /><div class="fb-input-wrapper"> \t\t\t\t\t\t<label>登录名称：</label> \t\t\t\t\t\t<input class="loginname" /></div> \t\t\t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t\t\t<label>登录密码：</label> \t\t\t\t\t\t<input class="password" type="password" /></div> \t\t\t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t\t\t<label>用户角色：</label> \t\t\t\t\t\t<select class="roll" ><option value="r1">总经理</option></select></div> \t\t\t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t\t\t<label>&nbsp;</label> \t\t\t\t\t\t<button onclick="kaidanbao.plugin.usercenter.stafflist.addpay();">确定</button> \t\t\t\t\t\t</div>');$("#facebox div.title").html("新增用户")}},init:function(){var t="#layout div.usercenter";$("#layout div.lay-main").append(' \t\t\t\t\t<div hidden class="usercenter"> \t\t\t\t\t<div class="pan-box user-box inc-info"> \t\t\t\t\t\t<div class="title">公司信息</div> \t\t\t\t\t\t<div class="content"></div> \t\t\t\t\t</div> \t\t\t\t\t<div class="pan-box user-box staff-info"> \t\t\t\t\t\t<div class="title">当前用户 - <span onclick="kaidanbao.plugin.usercenter.staff.renewal();">续期</span></div> \t\t\t\t\t\t<div class="content"></div> \t\t\t\t\t</div> \t\t\t\t\t<div class="pan-box user-box staff-list"> \t\t\t\t\t\t<div class="title">用户列表 - <span onclick="kaidanbao.plugin.usercenter.stafflist.addstaff();">新增</span></div> \t\t\t\t\t\t<div class="content"></div> \t\t\t\t\t</div> \t\t\t\t\t<div class="pan-box user-box roll-box"> \t\t\t\t\t\t<div class="title">角色设置 - <span onclick="kaidanbao.plugin.usercenter.roll.upset();">新增</span></div> \t\t\t\t\t\t<div class="content"></div> \t\t\t\t\t</div> \t\t\t\t\t<div class="pan-box user-box"> \t\t\t\t\t\t<div class="title">默认设置</div> \t\t\t\t\t</div> \t\t\t\t\t<div class="pan-box user-box"> \t\t\t\t\t\t<div class="title">操作日志</div> \t\t\t\t\t</div> \t\t\t</div>');n.usercenter.inc.load();n.usercenter.staff.load();n.usercenter.stafflist.load();n.usercenter.roll.load()}}})(window.kaidanbao);(function(t){var e=t.utils;var n=t.plugin;var i=function(t){t()};n.loading={change_inc:function(e){if(e)t.cache.sign.user.inc=e;else e=t.cache.sign.user.inc;$("#layout div.lay-top li.home a").html(e);$(document).attr("title",e+" - kaidan.me")},init:function(){if(t.cache.sign.user_id){t.dao.init(function(){t.syn.init(function(){t.cache.init(function(){i(function(){window.kaidanbao.plugin.loading.change_inc();window.location.hash="#/home/welcome";t.cache.sign.loaded=true;t.aspect.noty.close_progress()})})})})}else{window.location.href="./"}}};var a,s,c,o,l,r,u;var d={},p={},f={},h={},g={},m={};var b=function(e,n){var i=t.cache.dates.mi[0];m1=t.cache.dates.mi[1];m2=t.cache.dates.mi[2];m3=t.cache.dates.mi[3];var o="s"+t.cache.dates.mt[e],p="sr"+t.cache.dates.mt[e],m=t.cache.dates.mi[e];t.dao.queryDynamicByMonth("salebill",t.cache.dates.m_t[e],function(b,v){if(b){n()}else{c=v.customer_id;if(!d["i"+c]){d["i"+c]={_id:c}}if(v.settlement==="q"){if(!d["i"+c][o]){d["i"+c][o]={}}if(!d["i"+c][o]["i"+v._id]){d["i"+c][o]["i"+v._id]=[]}d["i"+c][o]["i"+v._id][0]=v.number;d["i"+c][o]["i"+v._id][1]=v.amount;d["i"+c][o]["i"+v._id][2]=v.payamount;d["i"+c][o]["i"+v._id][3]=v.st}l=v.account_id;if(l){if(!f["i"+l]){f["i"+l]={_id:l}}if(!f["i"+l][o])f["i"+l][o]=[0,0,0,0,0,0,0,0];if(v.payamount){f["i"+l][o][0]+=v.payamount}}r=v.repository_id;if(!h["i"+r])h["i"+r]={_id:r};for(a in v.detail){s=v.detail[a],u=s[0];if(!h["i"+r]["p"+u]){h["i"+r]["p"+u]=t.cache.get(r)["p"+u]||[0,0,0,0,0,0,0,0,0,0,0,0];h["i"+r]["p"+u][m2]=0;h["i"+r]["p"+u][m1]=0;h["i"+r]["p"+u][i]=0}h["i"+r]["p"+u][m]-=s[2];if(!g["i"+u]){g["i"+u]={_id:u}}if(!g["i"+u][o])g["i"+u][o]={};if(!g["i"+u][o]["i"+c])g["i"+u][o]["i"+c]=0;g["i"+u][o]["i"+c]+=s[4];if(s[4]<0){if(!g["i"+u][p])g["i"+u][p]={};if(!g["i"+u][p]["i"+c])g["i"+u][p]["i"+c]=0;g["i"+u][p]["i"+c]+=s[4]}else if(s[3]!=0&&e<2){if(!d["i"+c]["quotation"]){d["i"+c]["quotation"]={}}d["i"+c]["quotation"]["i"+u]=[s[3],s[1]]}}}},"next")};var v=function(e,n){var i=t.cache.dates.mi[0];m1=t.cache.dates.mi[1];m2=t.cache.dates.mi[2];m3=t.cache.dates.mi[3];var c="s"+t.cache.dates.mt[e],d="br"+t.cache.dates.mt[e],m="b"+t.cache.dates.mt[e],b=t.cache.dates.mi[e];t.dao.queryDynamicByMonth("bringbill",t.cache.dates.m_t[e],function(v,y){if(v){n()}else{o=y.supplier_id;if(!p["i"+o]){p["i"+o]={_id:o}}if(y.settlement==="q"){if(!p["i"+o][c]){p["i"+o][c]={}}if(!p["i"+o][c]["i"+y._id]){p["i"+o][c]["i"+y._id]=[]}p["i"+o][c]["i"+y._id][0]=y.number;p["i"+o][c]["i"+y._id][1]=y.amount;p["i"+o][c]["i"+y._id][2]=y.payamount;p["i"+o][c]["i"+y._id][3]=y.st}l=y.account_id;if(l){if(!f["i"+l]){f["i"+l]={_id:l}}if(!f["i"+l][c])f["i"+l][c]=[0,0,0,0,0,0,0,0];if(y.payamount){f["i"+l][c][2]-=y.payamount}}r=y.repository_id;if(!h["i"+r])h["i"+r]={_id:r};for(a in y.detail){s=y.detail[a],u=s[0];if(!h["i"+r]["p"+u]){h["i"+r]["p"+u]=t.cache.get(r)["p"+u]||[0,0,0,0,0,0,0,0,0,0,0,0];h["i"+r]["p"+u][m2]=0;h["i"+r]["p"+u][m1]=0;h["i"+r]["p"+u][i]=0}h["i"+r]["p"+u][b]+=s[2];if(!g["i"+u]){g["i"+u]={_id:u};g["i"+u][c]={}}if(!g["i"+u][m])g["i"+u][m]={};if(!g["i"+u][m]["i"+o])g["i"+u][m]["i"+o]=0;g["i"+u][m]["i"+o]+=s[4];if(s[4]<0){if(!g["i"+u][d])g["i"+u][d]={};if(!g["i"+u][d]["i"+o])g["i"+u][d]["i"+o]=0;g["i"+u][d]["i"+o]+=s[4]}else if(s[3]!=0&&e<2){if(!p["i"+o]["quotation"]){p["i"+o]["quotation"]={}}p["i"+o]["quotation"]["i"+u]=[s[3],s[1]]}}}},"next")};var y=function(e,n){var i=t.cache.dates.mi[0];m1=t.cache.dates.mi[1];m2=t.cache.dates.mi[2];m3=t.cache.dates.mi[3];var a="s"+t.cache.dates.mt[e],s=t.cache.dates.mi[e];t.dao.queryDynamicByMonth("allotbill",t.cache.dates.m_t[e],function(e,a){if(e){n()}else{var c=a.callout_id;var o=a.callin_id;if(!h["i"+c])h["i"+c]={_id:c};if(!h["i"+o])h["i"+o]={_id:o};for(var l in a.detail){var r=a.detail[l],u=r[0];if(!h["i"+c]["p"+u]){h["i"+c]["p"+u]=t.cache.get(c)["p"+u]||[0,0,0,0,0,0,0,0,0,0,0,0];h["i"+rcoidid]["p"+u][m2]=0;h["i"+c]["p"+u][m1]=0;h["i"+c]["p"+u][i]=0}h["i"+c]["p"+u][s]-=r[1];if(!h["i"+o]["p"+u]){h["i"+o]["p"+u]=t.cache.get(o)["p"+u]||[0,0,0,0,0,0,0,0,0,0,0,0];h["i"+o]["p"+u][m2]=0;h["i"+o]["p"+u][m1]=0;h["i"+o]["p"+u][i]=0}h["i"+o]["p"+u][s]+=r[1]}}})};var x=function(e,n){var i=t.cache.dates.mi[0];m1=t.cache.dates.mi[1];m2=t.cache.dates.mi[2];m3=t.cache.dates.mi[3];var a="s"+t.cache.dates.mt[e],s=t.cache.dates.mi[e];t.dao.queryDynamicByMonth("checkbill",t.cache.dates.m_t[e],function(e,a){if(e){n()}else{var c=a.repository_id;if(!h["i"+c])h["i"+c]={_id:c};for(var o in a.detail){var l=a.detail[o],r=l[0];if(!h["i"+c]["p"+r]){h["i"+c]["p"+r]=t.cache.get(c)["p"+r]||[0,0,0,0,0,0,0,0,0,0,0,0];h["i"+c]["p"+r][m2]=0;h["i"+c]["p"+r][m1]=0;h["i"+c]["p"+r][i]=0}h["i"+c]["p"+r][s]+=l[2]-l[1]}}})};var _=function(e,n){var i="s"+t.cache.dates.mt[e],a=t.cache.dates.mi[e],s,c;var o={xs:0,os:1,cg:2,gz:3,fz:4,sf:5,oz:6,zz:7};t.dao.queryDynamicByMonth("moneyflow",t.cache.dates.m_t[e],function(t,e){if(t){n()}else{s=e.account_p;c=e.account_r;if(s){if(!f["i"+s]){f["i"+s]={_id:s}}if(!f["i"+s][i]){f["i"+s][i]=[0,0,0,0,0,0,0,0]}if(!e.flag)f["i"+s][i][o[e.type]]-=e.amount}if(c){if(!f["i"+c]){f["i"+c]={_id:c}}if(!f["i"+c][i]){f["i"+c][i]=[0,0,0,0,0,0,0,0]}if(!e.flag)f["i"+c][i][o[e.type]]+=e.amount}}})};var k=function(e){var n,i,a,s,c,o,l,r;var u=e==="customer"?d:p;for(var f=0;f<3;f++){c="s"+t.cache.dates.mt[f];for(a in u){n=t.cache.fixed[a];i=u[a];if(!n)continue;r={tn:e,_id:n._id};r[c]=n[c]||{};o=false;if(r[c]!=="x"){for(s in i[c]){if(r[c][s]){if(r[c][s][3]!=="x"&&i[c][s][3]==="d"){o=true;r[c][s][3]="x"}}else{if(i[c][s][3]!=="d"){o=true;r[c][s]=i[c][s]}}}}if(o)t.dao.updOne(r,null,3);if(f==0&&i["quotation"]){n["quotation"]=n["quotation"]||{};l=false;for(var h in i["quotation"]){if(!n["quotation"][h]||n["quotation"][h][0]!=i["quotation"][h][0]||n["quotation"][h][1]!=i["quotation"][h][1]){n["quotation"][h]=i["quotation"][h];l=true}}if(l)t.dao.updOne({tn:e,_id:n._id,quotation:n.quotation},null,3)}}}};var w=function(){k("customer");k("supplier");var e=t.cache.dates.mi[0];m1=t.cache.dates.mi[1];m2=t.cache.dates.mi[2];m3=t.cache.dates.mi[3];var n="s"+t.cache.dates.mt[0],i="s"+t.cache.dates.mt[1],a="s"+t.cache.dates.mt[2];var s,c,o;for(o in f){s=t.cache.fixed[o];c={tn:"account",amount:s.amount||[0,0,0,0,0,0,0,0,0,0,0,0],_id:s._id};c[a]=f[o][a]||[0,0,0,0,0,0,0,0];c[i]=f[o][i]||[0,0,0,0,0,0,0,0];c[n]=f[o][n]||[0,0,0,0,0,0,0,0];c.amount[m2]=c.amount[m3]+c[a][0]+c[a][1]+c[a][2]+c[a][3]+c[a][4]+c[a][5]+c[a][6]+c[a][7];c.amount[m1]=c.amount[m2]+c[i][0]+c[i][1]+c[i][2]+c[i][3]+c[i][4]+c[i][5]+c[i][6]+c[i][7];c.amount[e]=c.amount[m1]+c[n][0]+c[n][1]+c[n][2]+c[n][3]+c[n][4]+c[n][5]+c[n][6]+c[n][7];if(s.amount.toString()!==c.amount.toString())t.dao.updOne(c,null,3)}};i=function(t){v(2,function(){v(1,function(){v(0,function(){b(2,function(){b(1,function(){b(0,function(){_(2,function(){_(1,function(){_(0,function(){w();t()})})})})})})})})})}})(window.kaidanbao);(function(t){var e=t.utils;var n=t.plugin;n.customer={release:function(){$("#layout div.repository table.kc-manage-list tr.list").remove()},reload:function(){$("#layout div.repository button.s-btn").click()},init:function(){var e=0,n="#layout div.customer";t.aspect.manage.init({count:function(t){e++},notice:function(){$(n+" input").attr("placeholder","搜索 "+e+" 位客户");e=0}})}};n.supplier={release:function(){$("#layout div.supplier table.kc-manage-list tr.list").remove()},reload:function(){$("#layout div.supplier button.s-btn").click()},init:function(){var e=0,n="#layout div.supplier";t.aspect.manage.init({count:function(t){e++},notice:function(){$(n+" input").attr("placeholder","搜索 "+e+" 位供应商");e=0}})}};n.clerk={release:function(){$("#layout div.clerk table.kc-manage-list tr.list").remove()},reload:function(){$("#layout div.clerk button.s-btn").click()},init:function(){var e=0,n="#layout div.clerk";t.aspect.manage.init({count:function(t){e++},notice:function(){$(n+" input").attr("placeholder","搜索 "+e+" 位员工");e=0}})}};n.account={init:function(){var e=0,n="#layout div.account";t.aspect.manage.init({count:function(t){e++},notice:function(){$(n+" input").attr("placeholder","搜索 "+e+" 个账户");e=0}})}};n.product={release:function(){$("#layout div.product table.kc-manage-list tr.list").remove()},reload:function(){$("#layout div.product button.s-btn").click()},init:function(){var e=0,n="#layout div.product";t.aspect.manage.init({count:function(t){e++},notice:function(){$(n+" input").attr("placeholder","搜索 "+e+" 个商品");e=0}})}};n.salebilling={init:function(){t.aspect.billing.init()}};n.salebill={release:function(){$("#layout div.salebill table.kc-manage-list tr.list").remove()},reload:function(){$("#layout div.salebill button.s-btn").click()},init:function(){t.aspect.bill.init()}};n.bringbilling={init:function(){t.aspect.billing.init()}};n.bringbill={release:function(){$("#layout div.bringbill table.kc-manage-list tr.list").remove()},reload:function(){$("#layout div.bringbill button.s-btn").click()},init:function(){t.aspect.bill.init()}}})(window.kaidanbao);(function(t){var e=t.utils;var n=t.plugin;var i=t.cache.local();var a=function(){if(document.getElementById("sign"))return;$("body").append(' \t\t\t<div id="sign"> \t\t\t<div class="sign-main"> \t\t\t\t<div class="sign-logo-wrapper"> \t\t\t\t\t<span class="icon-logo"><a href="/"> \t\t\t\t\t\t<svg class="logo" version="1.1" viewBox="0 -70 1034 1034"><path d="M928 544c-28.428 0-53.958-12.366-71.536-32h-189.956l134.318 134.318c26.312-1.456 53.11 7.854 73.21 27.956 37.49 37.49 37.49 98.274 0 135.764s-98.274 37.49-135.766 0c-20.102-20.102-29.41-46.898-27.956-73.21l-134.314-134.318v189.954c19.634 17.578 32 43.108 32 71.536 0 53.020-42.98 96-96 96s-96-42.98-96-96c0-28.428 12.366-53.958 32-71.536v-189.954l-134.318 134.318c1.454 26.312-7.856 53.11-27.958 73.21-37.49 37.49-98.274 37.49-135.764 0-37.49-37.492-37.49-98.274 0-135.764 20.102-20.102 46.898-29.412 73.212-27.956l134.32-134.318h-189.956c-17.578 19.634-43.108 32-71.536 32-53.020 0-96-42.98-96-96s42.98-96 96-96c28.428 0 53.958 12.366 71.536 32h189.956l-134.318-134.318c-26.314 1.456-53.11-7.854-73.212-27.956-37.49-37.492-37.49-98.276 0-135.766 37.492-37.49 98.274-37.49 135.764 0 20.102 20.102 29.412 46.898 27.958 73.21l134.316 134.32v-189.956c-19.634-17.576-32-43.108-32-71.536 0-53.020 42.98-96 96-96s96 42.98 96 96c0 28.428-12.366 53.958-32 71.536v189.956l134.318-134.318c-1.456-26.312 7.854-53.11 27.956-73.21 37.492-37.49 98.276-37.49 135.766 0s37.49 98.274 0 135.766c-20.102 20.102-46.898 29.41-73.21 27.956l-134.32 134.316h189.956c17.576-19.634 43.108-32 71.536-32 53.020 0 96 42.98 96 96s-42.982 96-96.002 96z"></path></svg> \t\t\t\t\t</a></span> \t\t\t\t</div> \t\t\t\t<div class="sign-title" style="margin-top:15px;">欢迎使用开单宝！</div> \t\t\t\t<div class="sign-input-wrapper sign-input-loginname"> \t\t\t\t\t<input type="text" class="loginname" spellcheck="false" placeholder="用户名" /> \t\t\t\t</div> \t\t\t\t<div class="sign-input-wrapper sign-input-password"> \t\t\t\t\t<input type="password" class="password" spellcheck="false" placeholder="密码" /> \t\t\t\t</div> \t\t\t\t<div hidden class="sign-input-wrapper sign-input-inc"> \t\t\t\t\t<input type="text" class="inc" maxlength="8" spellcheck="false" placeholder="公司简称" /> \t\t\t\t</div> \t\t\t\t<div hidden class="sign-input-wrapper sign-input-captcha"> \t\t\t\t\t<input type="text" maxlength="4" class="captcha" placeholder="短信验证码" /><button class="captcha-button">发短信</button> \t\t\t\t</div> \t\t\t\t<div class="sign-button-wrapper sign-button-login"> \t\t\t\t\t<button class="login">登录</button> \t\t\t\t</div> \t\t\t\t<div hidden class="sign-button-wrapper sign-button-register"> \t\t\t\t\t<button class="register">注册</button> \t\t\t\t</div> \t\t\t\t<div hidden class="sign-button-wrapper sign-button-forget" > \t\t\t\t\t<button class="forget">重置密码</button> \t\t\t\t</div> \t\t\t\t<div class="sign-a-wrapper"> \t\t\t\t\t<div hidden class="login"><a href="#/sign/login">立即登陆</a></div> \t\t\t\t\t<div class="register"><a href="#/sign/register">注册账号</a></div> \t\t\t\t\t<div class="forget"><a href="#/sign/forget">忘记密码?</a></div> \t\t\t\t</div> \t\t\t</div> \t\t\t<div hidden class="sign-loading"> \t\t\t\t<p class="progress_msg">正在加载，请稍候...</p> \t\t\t  \t<progress value="0" max="100" ></progress> \t\t\t</div> \t\t</div>');document.onkeydown=function(e){if(e.keyCode===13){if(e.ctrlKey){$("#layout div."+t.frame.current_plugin+" button.submit").click()}else{if(window.location.hash==="#/sign/login")$("#sign .sign-button-login button").click()}}}};n.forget={init:function(){a();$("#sign button.captcha-button").click(function(){var n=$("#sign input.loginname").val().trim();if(!e.valid_loginname(n))return;t.net.api("/sign/forget",{loginname:n},function(e,n){if(n){t.aspect.noty.message("已发短信至:"+n.obj.mobile);$("#sign button.captcha-button").html("已发送").attr("disabled","disabled").css("background-color","#555")}},true)});$("#sign button.forget").click(function(){var n=$("#sign input.loginname").val().trim();if(!e.valid_loginname(n))return;var i=$("#sign input.password").val();if(!e.valid_password(i))return;var a=t.safe.local_pwd(i);var s=$("#sign input.captcha").val();if(!s)return;t.net.api("/sign/forget",{loginname:n,password:t.safe.up_pwd(a,i),code:parseInt(s)},function(e,n){if(n){t.aspect.noty.message("密码修改成功，请登录");window.location.hash="#/sign/login"}},true)})}};n.register={init:function(){a();$("#sign input.loginname").val("");$("#sign .sign-button-register button").click(function(){var n=$("#sign input.loginname").val().trim();var i=$("#sign input.password").val();var a=$("#sign input.inc").val().trim();if(!e.valid_loginname(n))return;if(!e.valid_password(i))return;if(!e.valid_hanname(a))return;t.net.api("/sign/checkloginname",{loginname:n},function(e,s){if(e){t.aspect.noty.message("网络异常！");return}else if(s.obj&&s.obj.used){t.aspect.noty.message("用户名已被使用，请更换");return}var c=t.safe.local_pwd(i);t.aspect.pay({url:"/sign/register",no_session:true,param:{loginname:n,password:t.safe.up_pwd(c,i),inc:a}},function(){t.aspect.noty.confirm_close();window.location.hash="#/sign/login";$("#sign button.login").click()})},true)})}};n.login={init:function(){a();if(i["ln"]){$("#sign input.loginname").val(i["ln"]);$("#sign input.password").focus()}else{$("#sign input.loginname").focus()}$("#sign .sign-button-login button").click(function(){var n=$("#sign input.loginname").val();var a=$("#sign input.password").val();if(!e.valid_loginname(n))return;if(!e.valid_password(a))return;var s=t.safe.local_pwd(a);t.aspect.noty.progress("登录中。。。");t.net.api("/sign/login",{loginname:n,password:t.safe.up_pwd(s,a),box_id:i["bi"+n]||0},function(e,c){if(e){if(e.code){t.aspect.noty.close_progress();t.aspect.noty.message("登录失败！")}else{if(t.safe.local_pwd(a)===i["lp"+n]){t.cache.sign.user_id=i["ui"+n];t.cache.sign.staff_id=i["si"+n];t.cache.sign.box_id=i["bi"+n];location.hash="#/sign/loading"}else{t.aspect.noty.close_progress();t.aspect.noty.message("用户名或密码错误！")}}}else{if(i["bi"+n]!=c.obj.box_id){t.cache.sign.need_create_db=true}i["ln"]=n;i["ll"+n]=(new Date).getTime();i["lp"+n]=s;i["ui"+n]=c.obj.user._id;i["si"+n]=c.obj.staff_id;i["bi"+n]=c.obj.box_id;t.cache.local(i);t.cache.sign.user=c.obj.user;t.cache.sign.user_id=c.obj.user._id;t.cache.sign.staff_id=c.obj.staff_id;t.cache.sign.box_id=c.obj.box_id;t.cache.sign.session={token:c.obj.token,usb:c.obj.user._id+"-"+c.obj.staff_id+"-"+c.obj.box_id};location.hash="#/sign/loading"}},true)})}}})(window.kaidanbao);(function(t){var e=t.utils;var n=t.plugin;n.store={export_check:function(){var n=$("#facebox select.repository").val(),i=$("#facebox input.checker").val();var a,s,c,o={},l="#export",r=$("#facebox input.checker").attr("data-id");if(r){$(l).html("<table><th>系统编号</th><th>产品</th><th>规格</th><th>单位</th><th>系统库存</th><th>盘点后库存</th></table>");for(a in t.cache.fixed_by_table["product"]){s=t.cache.fixed_by_table["product"][a];if(!o["i"+s]){o["i"+s]=1;c=t.cache.get(s);$(l+" table").append("<tr><td>p"+c._id+"</td><td>"+(c.number+" "+(c.name||"-"))+"</td><td>"+(c.spec||"-")+"</td><td>"+(c.unit||"-")+"</td><td>"+c.count+'</td><td style="background-color:#f5f5f5;">-</td></tr>')}}e.file.tableToExcel($("#export").html(),t.cache.get(n).name+"-盘点表-"+i)}else t.aspect.noty.message("盘点员不能为空!")},import_check:function(n){t.aspect.noty.progress("正在导入，请稍后...");e.file.excelToTable(n,function(n){if(n){$("#export").html(n);var i=[],a,s,c;for(a=0;a<$("#export table tr").length;a++){s=$("#export table tr:eq("+a+") td:eq(0)").html();c=$("#export table tr:eq("+a+") td:eq(5)").html();if(s&&s[0]==="p"&&c&&e.is_float(c.trim())){i.push({_id:parseInt(s.substring(1)),count:parseFloat(c.trim())})}}if(i.length>0){}else t.aspect.noty.message("产品库存无更新!")}setTimeout(function(){t.aspect.noty.close_progress()},1e3)})},check:function(){$.facebox(' \t\t\t\t\t<div class="fb-input-wrapper"><label>盘点员：</label><input class="checker" type="search" /></div> \t\t\t\t\t<div class="fb-input-wrapper"><label>仓库：</label><select class="repository"></select></div> \t\t\t\t\t<div class="fb-input-wrapper"><label>盘点步骤：</label> \t\t\t\t\t\t<textarea class="remark" disabled="disabled" style="color:#078;width:390px;height:60px;">第一步：选择仓库，导出盘点表。 \t\t\t\t\t\t\t第二步：打开盘点表，填写【盘点后库存】。 \t\t\t\t\t\t\t第三步：导入填写后的盘点表，完成盘点。 \t\t\t\t\t\t</textarea></div> \t\t\t\t\t<div class="fb-input-wrapper"><label>注意事项：</label> \t\t\t\t\t\t<textarea class="remark" disabled="disabled" style="color:#f08;width:390px;height:60px;">1：请勿修改盘点表的其他字段，勿修改文件名。 \t\t\t\t\t\t\t2，填表期间，可以关闭本页面，可以部分盘点。 \t\t\t\t\t\t\t3，导入盘点表前请仔细检查，导入后不支持撤销。 \t\t\t\t\t\t</textarea></div> \t\t\t\t\t<div class="fb-input-wrapper"> \t\t\t\t\t<label>&nbsp;</label> \t\t\t\t\t<button onclick="kaidanbao.plugin.store.export_check();">导出盘点表</button> \t\t\t\t\t<button onclick="$(\'#importfile\').click();">导入盘点表</button> \t\t\t\t</div>');$("#facebox div.title").html("库存盘点");$("#facebox input.checker").autocomplete({minChars:0,newButton:"<div class=\"autocomplete-new\"><span onclick=\"kaidanbao.aspect.manage.create('clerk');$('.autocomplete-suggestions').css('display','none');\">新增职员</span></div>",lookup:t.aspect.atcp.auto(null,"clerk"),onSelect:function(e){$(this).val(t.cache.get(e.data.id).name);$(this).attr("data-id",e.data.id)},onSearchComplete:function(t,e){$(this).removeAttr("data-id")}});t.aspect.manage.selectRepositoryRefresh($("#facebox select.repository"))},init:function(){var e=0,n="#layout div.store",i={};t.aspect.manage.init({search:function(e){$(n+" table.kc-manage-list tr.list").remove();var a=$(n+" input").val().trim(),s,c,o=0;if(a){s=a.toLowerCase().split(" ");c=s.length}var l=0,r,u,d,p=0,f;i={};for(u in t.cache.fixed_by_table["product"]){d=t.cache.fixed_by_table["product"][u];if(!i["i"+d]){i["i"+d]=1;r=t.cache.get(d);f=r.name+" "+(r.number||"");if(s){o=0;for(var h in s){if(f.toLowerCase().indexOf(s[h])>=0){f=f.replace(new RegExp("("+s[h]+")","gi"),"<b>$1</b>");o++}}if(o<c)continue}$(n+" table.kc-manage-list").append('<tr class="list '+(++p%2===0?"opp":"")+'"><td>'+p+'</td><td style="text-align:left;">'+f+"</td><td>"+(r.spec||"")+"</td><td>"+(r.unit||"")+"</td><td>"+(r.cost||"")+"</td><td>"+(r.amount||"")+"</td><td>"+(r.count||"")+'</td><td class="remark">'+(r.stock_remark||"")+"</td></tr>")}}$(n+" section.summary-box").html("总："+p+" 条，"+l.toFixed(2)+" 元")},select:function(){$(n+" section.func-a").html('<span onclick="kaidanbao.plugin.store.check();" class="check">盘点</span>');$(n+" input").attr("placeholder","搜索商品名称");$(n+" select.s1").append('<option value="all"><所有类型></option>');for(var e in t.conf.table.product.type_define){$(n+" select.s1").append('<option value="'+e+'">'+t.conf.table.product.type_define[e]+"</option>")}},create:"noop",classify:"noop"})}}})(window.kaidanbao);